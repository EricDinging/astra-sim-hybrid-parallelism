id,require_grads,x1,x2,op_type,op_attr,x1_shape,x1_hidden,x2_shape,x2_hidden,grad_of,extra_attr
transformer.0.input_norm.x@0,N,in_emb.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.0.input_norm.y@0,N,transformer.0.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.0.input_norm.dy@0,N,transformer.0.mha.dx@0,transformer.0.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.0.input_norm.y@0,
transformer.0.input_norm.dx@0,N,transformer.0.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.0.input_norm.x@0,
transformer.0.mha.x@0,N,transformer.0.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.0.mha.wqkv@0,N,transformer.0._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.0.mha.qkv@0,N,transformer.0.mha.x@0,transformer.0.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.0.mha.q@0,N,transformer.0.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.0.mha.k@0,N,transformer.0.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.0.mha.v@0,N,transformer.0.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.0.mha.attn@0,N,transformer.0.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.0.mha.wo@0,N,transformer.0._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.0.mha.o1@0,N,transformer.0.mha.attn@0,transformer.0.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.0.mha.o@0,N,transformer.0.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.0.mha.do@0,N,transformer.0.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.0.mha.o@0,
transformer.0.mha.do1@0,N,transformer.0.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.0.mha.o1@0,
transformer.0.mha.dattn@0,N,transformer.0.mha.do1@0,transformer.0._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.0.mha.dwo@0,N,transformer.0.mha.do1@0,transformer.0.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.0.mha.wo@0,
transformer.0.mha.dv@0,N,transformer.0.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.0.mha.v@0,
transformer.0.mha.dk@0,N,transformer.0.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.0.mha.k@0,
transformer.0.mha.dq@0,N,transformer.0.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.0.mha.q@0,
transformer.0.mha.dkv@0,N,transformer.0.mha.dv@0,transformer.0.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.0.mha.dqkv@0,N,transformer.0.mha.dkv@0,transformer.0.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.0.mha.qkv@0,
transformer.0.mha.dwqkv@0,N,transformer.0.mha.dqkv@0,transformer.0.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.0.mha.wqkv@0,
transformer.0.mha.dx1@0,N,transformer.0.mha.dqkv@0,transformer.0._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.0.mha.dx@0,N,transformer.0.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.0.mha.attn_kernel.q@0,N,transformer.0.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.0.mha.attn_kernel.k@0,N,transformer.0.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.0.mha.attn_kernel.v@0,N,transformer.0.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.0.mha.attn_kernel.k1@0,N,transformer.0.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.0.mha.attn_kernel.v1@0,N,transformer.0.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.0.mha.attn_kernel.qkv@0,N,transformer.0.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.0.mha.attn_kernel.k1@0"", ""transformer.0.mha.attn_kernel.v1@0""]}"
transformer.0.mha.attn_kernel.dqkv@0,N,transformer.0.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.0.mha.attn_kernel.qkv@0,
transformer.0.mha.attn_kernel.dq@0,N,transformer.0.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.0.mha.attn_kernel.q@0,
transformer.0.mha.attn_kernel.dk@0,N,transformer.0.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.0.mha.attn_kernel.dv@0,N,transformer.0.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.0.mha_res.x1@0,N,transformer.0.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.0.mha_res.x2@0,N,transformer.0.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.0.mha_res.y@0,N,transformer.0.mha_res.x1@0,transformer.0.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.0.mha_res.dy@0,N,transformer.0.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.0.mha_res.y@0,
transformer.0.mha_res.dx1@0,N,transformer.0.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.0.mha_res.x1@0,
transformer.0.mha_res.dx2@0,N,transformer.0.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.0.mha_res.x2@0,
transformer.0.post_attn_norm.x@0,N,transformer.0.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.0.post_attn_norm.y@0,N,transformer.0.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.0.post_attn_norm.dy@0,N,transformer.0.ffn.dx0@0,transformer.0.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.0.post_attn_norm.y@0,
transformer.0.post_attn_norm.dx@0,N,transformer.0.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.0.post_attn_norm.x@0,
transformer.0.ffn.x0@0,N,transformer.0.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.0.ffn.wgate@0,N,transformer.0._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.0.ffn.wdown@0,N,transformer.0._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.0.ffn.x00@0,N,transformer.0.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.0.ffn.xgate@0,N,transformer.0.ffn.x00@0,transformer.0.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.0.ffn.xdown1@0,N,transformer.0.ffn.xgate@0,transformer.0.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.0.ffn.xdown@0,N,transformer.0.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.0.ffn.dxdown@0,N,transformer.0.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.0.ffn.xdown@0,
transformer.0.ffn.dxdown2@0,N,transformer.0.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.0.ffn.dwdown@0,N,transformer.0.ffn.dxdown2@0,transformer.0.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.0.ffn.wdown@0,
transformer.0.ffn.dxgate@0,N,transformer.0.ffn.dxdown2@0,transformer.0._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.0.ffn.xgate@0,
transformer.0.ffn.x01@0,N,transformer.0.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.0.ffn.dwgate@0,N,transformer.0.ffn.dxgate@0,transformer.0.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.0.ffn.wgate@0,
transformer.0.ffn.dx000@0,N,transformer.0.ffn.dxgate@0,transformer.0._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.0.ffn.dx0@0,N,transformer.0.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.0.ffn_res.x1@0,N,transformer.0.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.0.ffn_res.x2@0,N,transformer.0.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.0.ffn_res.y@0,N,transformer.0.ffn_res.x1@0,transformer.0.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.0.ffn_res.dy@0,N,transformer.1.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.0.ffn_res.y@0,
transformer.0.ffn_res.dx1@0,N,transformer.0.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.0.ffn_res.x1@0,
transformer.0.ffn_res.dx2@0,N,transformer.0.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.0.ffn_res.x2@0,
transformer.0._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.0._assembled_weight@0,N,transformer.0._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.0._sharded_grad@0,N,transformer.0._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.0._sharded_weight@0,
transformer.0._assembled_grad@0,N,transformer.0.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.0.mha.dwo@0"", ""transformer.0.ffn.dwgate@0"", ""transformer.0.ffn.dwdown@0""]}"
transformer.0._mha.wqkv_backward@0,N,transformer.0._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.0._mha.wo_backward@0,N,transformer.0._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.0._ffn.wgate_backward@0,N,transformer.0._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.0._ffn.wdown_backward@0,N,transformer.0._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.0._assembled_weight_backward@0,N,transformer.0._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.1.input_norm.x@0,N,transformer.0.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.1.input_norm.y@0,N,transformer.1.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.1.input_norm.dy@0,N,transformer.1.mha.dx@0,transformer.1.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.1.input_norm.y@0,
transformer.1.input_norm.dx@0,N,transformer.1.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.1.input_norm.x@0,
transformer.1.mha.x@0,N,transformer.1.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.1.mha.wqkv@0,N,transformer.1._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.1.mha.qkv@0,N,transformer.1.mha.x@0,transformer.1.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.1.mha.q@0,N,transformer.1.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.1.mha.k@0,N,transformer.1.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.1.mha.v@0,N,transformer.1.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.1.mha.attn@0,N,transformer.1.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.1.mha.wo@0,N,transformer.1._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.1.mha.o1@0,N,transformer.1.mha.attn@0,transformer.1.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.1.mha.o@0,N,transformer.1.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.1.mha.do@0,N,transformer.1.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.1.mha.o@0,
transformer.1.mha.do1@0,N,transformer.1.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.1.mha.o1@0,
transformer.1.mha.dattn@0,N,transformer.1.mha.do1@0,transformer.1._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.1.mha.dwo@0,N,transformer.1.mha.do1@0,transformer.1.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.1.mha.wo@0,
transformer.1.mha.dv@0,N,transformer.1.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.1.mha.v@0,
transformer.1.mha.dk@0,N,transformer.1.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.1.mha.k@0,
transformer.1.mha.dq@0,N,transformer.1.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.1.mha.q@0,
transformer.1.mha.dkv@0,N,transformer.1.mha.dv@0,transformer.1.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.1.mha.dqkv@0,N,transformer.1.mha.dkv@0,transformer.1.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.1.mha.qkv@0,
transformer.1.mha.dwqkv@0,N,transformer.1.mha.dqkv@0,transformer.1.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.1.mha.wqkv@0,
transformer.1.mha.dx1@0,N,transformer.1.mha.dqkv@0,transformer.1._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.1.mha.dx@0,N,transformer.1.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.1.mha.attn_kernel.q@0,N,transformer.1.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.1.mha.attn_kernel.k@0,N,transformer.1.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.1.mha.attn_kernel.v@0,N,transformer.1.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.1.mha.attn_kernel.k1@0,N,transformer.1.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.1.mha.attn_kernel.v1@0,N,transformer.1.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.1.mha.attn_kernel.qkv@0,N,transformer.1.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.1.mha.attn_kernel.k1@0"", ""transformer.1.mha.attn_kernel.v1@0""]}"
transformer.1.mha.attn_kernel.dqkv@0,N,transformer.1.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.1.mha.attn_kernel.qkv@0,
transformer.1.mha.attn_kernel.dq@0,N,transformer.1.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.1.mha.attn_kernel.q@0,
transformer.1.mha.attn_kernel.dk@0,N,transformer.1.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.1.mha.attn_kernel.dv@0,N,transformer.1.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.1.mha_res.x1@0,N,transformer.1.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.1.mha_res.x2@0,N,transformer.1.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.1.mha_res.y@0,N,transformer.1.mha_res.x1@0,transformer.1.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.1.mha_res.dy@0,N,transformer.1.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.1.mha_res.y@0,
transformer.1.mha_res.dx1@0,N,transformer.1.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.1.mha_res.x1@0,
transformer.1.mha_res.dx2@0,N,transformer.1.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.1.mha_res.x2@0,
transformer.1.post_attn_norm.x@0,N,transformer.1.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.1.post_attn_norm.y@0,N,transformer.1.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.1.post_attn_norm.dy@0,N,transformer.1.ffn.dx0@0,transformer.1.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.1.post_attn_norm.y@0,
transformer.1.post_attn_norm.dx@0,N,transformer.1.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.1.post_attn_norm.x@0,
transformer.1.ffn.x0@0,N,transformer.1.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.1.ffn.wgate@0,N,transformer.1._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.1.ffn.wdown@0,N,transformer.1._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.1.ffn.x00@0,N,transformer.1.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.1.ffn.xgate@0,N,transformer.1.ffn.x00@0,transformer.1.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.1.ffn.xdown1@0,N,transformer.1.ffn.xgate@0,transformer.1.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.1.ffn.xdown@0,N,transformer.1.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.1.ffn.dxdown@0,N,transformer.1.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.1.ffn.xdown@0,
transformer.1.ffn.dxdown2@0,N,transformer.1.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.1.ffn.dwdown@0,N,transformer.1.ffn.dxdown2@0,transformer.1.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.1.ffn.wdown@0,
transformer.1.ffn.dxgate@0,N,transformer.1.ffn.dxdown2@0,transformer.1._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.1.ffn.xgate@0,
transformer.1.ffn.x01@0,N,transformer.1.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.1.ffn.dwgate@0,N,transformer.1.ffn.dxgate@0,transformer.1.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.1.ffn.wgate@0,
transformer.1.ffn.dx000@0,N,transformer.1.ffn.dxgate@0,transformer.1._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.1.ffn.dx0@0,N,transformer.1.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.1.ffn_res.x1@0,N,transformer.1.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.1.ffn_res.x2@0,N,transformer.1.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.1.ffn_res.y@0,N,transformer.1.ffn_res.x1@0,transformer.1.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.1.ffn_res.dy@0,N,transformer.2.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.1.ffn_res.y@0,
transformer.1.ffn_res.dx1@0,N,transformer.1.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.1.ffn_res.x1@0,
transformer.1.ffn_res.dx2@0,N,transformer.1.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.1.ffn_res.x2@0,
transformer.1._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.1._assembled_weight@0,N,transformer.1._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.1._sharded_grad@0,N,transformer.1._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.1._sharded_weight@0,
transformer.1._assembled_grad@0,N,transformer.1.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.1.mha.dwo@0"", ""transformer.1.ffn.dwgate@0"", ""transformer.1.ffn.dwdown@0""]}"
transformer.1._mha.wqkv_backward@0,N,transformer.1._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.1._mha.wo_backward@0,N,transformer.1._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.1._ffn.wgate_backward@0,N,transformer.1._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.1._ffn.wdown_backward@0,N,transformer.1._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.1._assembled_weight_backward@0,N,transformer.1._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.2.input_norm.x@0,N,transformer.1.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.2.input_norm.y@0,N,transformer.2.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.2.input_norm.dy@0,N,transformer.2.mha.dx@0,transformer.2.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.2.input_norm.y@0,
transformer.2.input_norm.dx@0,N,transformer.2.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.2.input_norm.x@0,
transformer.2.mha.x@0,N,transformer.2.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.2.mha.wqkv@0,N,transformer.2._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.2.mha.qkv@0,N,transformer.2.mha.x@0,transformer.2.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.2.mha.q@0,N,transformer.2.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.2.mha.k@0,N,transformer.2.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.2.mha.v@0,N,transformer.2.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.2.mha.attn@0,N,transformer.2.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.2.mha.wo@0,N,transformer.2._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.2.mha.o1@0,N,transformer.2.mha.attn@0,transformer.2.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.2.mha.o@0,N,transformer.2.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.2.mha.do@0,N,transformer.2.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.2.mha.o@0,
transformer.2.mha.do1@0,N,transformer.2.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.2.mha.o1@0,
transformer.2.mha.dattn@0,N,transformer.2.mha.do1@0,transformer.2._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.2.mha.dwo@0,N,transformer.2.mha.do1@0,transformer.2.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.2.mha.wo@0,
transformer.2.mha.dv@0,N,transformer.2.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.2.mha.v@0,
transformer.2.mha.dk@0,N,transformer.2.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.2.mha.k@0,
transformer.2.mha.dq@0,N,transformer.2.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.2.mha.q@0,
transformer.2.mha.dkv@0,N,transformer.2.mha.dv@0,transformer.2.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.2.mha.dqkv@0,N,transformer.2.mha.dkv@0,transformer.2.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.2.mha.qkv@0,
transformer.2.mha.dwqkv@0,N,transformer.2.mha.dqkv@0,transformer.2.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.2.mha.wqkv@0,
transformer.2.mha.dx1@0,N,transformer.2.mha.dqkv@0,transformer.2._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.2.mha.dx@0,N,transformer.2.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.2.mha.attn_kernel.q@0,N,transformer.2.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.2.mha.attn_kernel.k@0,N,transformer.2.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.2.mha.attn_kernel.v@0,N,transformer.2.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.2.mha.attn_kernel.k1@0,N,transformer.2.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.2.mha.attn_kernel.v1@0,N,transformer.2.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.2.mha.attn_kernel.qkv@0,N,transformer.2.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.2.mha.attn_kernel.k1@0"", ""transformer.2.mha.attn_kernel.v1@0""]}"
transformer.2.mha.attn_kernel.dqkv@0,N,transformer.2.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.2.mha.attn_kernel.qkv@0,
transformer.2.mha.attn_kernel.dq@0,N,transformer.2.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.2.mha.attn_kernel.q@0,
transformer.2.mha.attn_kernel.dk@0,N,transformer.2.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.2.mha.attn_kernel.dv@0,N,transformer.2.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.2.mha_res.x1@0,N,transformer.2.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.2.mha_res.x2@0,N,transformer.2.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.2.mha_res.y@0,N,transformer.2.mha_res.x1@0,transformer.2.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.2.mha_res.dy@0,N,transformer.2.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.2.mha_res.y@0,
transformer.2.mha_res.dx1@0,N,transformer.2.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.2.mha_res.x1@0,
transformer.2.mha_res.dx2@0,N,transformer.2.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.2.mha_res.x2@0,
transformer.2.post_attn_norm.x@0,N,transformer.2.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.2.post_attn_norm.y@0,N,transformer.2.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.2.post_attn_norm.dy@0,N,transformer.2.ffn.dx0@0,transformer.2.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.2.post_attn_norm.y@0,
transformer.2.post_attn_norm.dx@0,N,transformer.2.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.2.post_attn_norm.x@0,
transformer.2.ffn.x0@0,N,transformer.2.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.2.ffn.wgate@0,N,transformer.2._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.2.ffn.wdown@0,N,transformer.2._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.2.ffn.x00@0,N,transformer.2.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.2.ffn.xgate@0,N,transformer.2.ffn.x00@0,transformer.2.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.2.ffn.xdown1@0,N,transformer.2.ffn.xgate@0,transformer.2.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.2.ffn.xdown@0,N,transformer.2.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.2.ffn.dxdown@0,N,transformer.2.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.2.ffn.xdown@0,
transformer.2.ffn.dxdown2@0,N,transformer.2.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.2.ffn.dwdown@0,N,transformer.2.ffn.dxdown2@0,transformer.2.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.2.ffn.wdown@0,
transformer.2.ffn.dxgate@0,N,transformer.2.ffn.dxdown2@0,transformer.2._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.2.ffn.xgate@0,
transformer.2.ffn.x01@0,N,transformer.2.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.2.ffn.dwgate@0,N,transformer.2.ffn.dxgate@0,transformer.2.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.2.ffn.wgate@0,
transformer.2.ffn.dx000@0,N,transformer.2.ffn.dxgate@0,transformer.2._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.2.ffn.dx0@0,N,transformer.2.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.2.ffn_res.x1@0,N,transformer.2.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.2.ffn_res.x2@0,N,transformer.2.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.2.ffn_res.y@0,N,transformer.2.ffn_res.x1@0,transformer.2.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.2.ffn_res.dy@0,N,transformer.3.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.2.ffn_res.y@0,
transformer.2.ffn_res.dx1@0,N,transformer.2.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.2.ffn_res.x1@0,
transformer.2.ffn_res.dx2@0,N,transformer.2.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.2.ffn_res.x2@0,
transformer.2._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.2._assembled_weight@0,N,transformer.2._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.2._sharded_grad@0,N,transformer.2._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.2._sharded_weight@0,
transformer.2._assembled_grad@0,N,transformer.2.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.2.mha.dwo@0"", ""transformer.2.ffn.dwgate@0"", ""transformer.2.ffn.dwdown@0""]}"
transformer.2._mha.wqkv_backward@0,N,transformer.2._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.2._mha.wo_backward@0,N,transformer.2._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.2._ffn.wgate_backward@0,N,transformer.2._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.2._ffn.wdown_backward@0,N,transformer.2._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.2._assembled_weight_backward@0,N,transformer.2._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.3.input_norm.x@0,N,transformer.2.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.3.input_norm.y@0,N,transformer.3.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.3.input_norm.dy@0,N,transformer.3.mha.dx@0,transformer.3.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.3.input_norm.y@0,
transformer.3.input_norm.dx@0,N,transformer.3.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.3.input_norm.x@0,
transformer.3.mha.x@0,N,transformer.3.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.3.mha.wqkv@0,N,transformer.3._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.3.mha.qkv@0,N,transformer.3.mha.x@0,transformer.3.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.3.mha.q@0,N,transformer.3.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.3.mha.k@0,N,transformer.3.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.3.mha.v@0,N,transformer.3.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.3.mha.attn@0,N,transformer.3.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.3.mha.wo@0,N,transformer.3._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.3.mha.o1@0,N,transformer.3.mha.attn@0,transformer.3.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.3.mha.o@0,N,transformer.3.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.3.mha.do@0,N,transformer.3.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.3.mha.o@0,
transformer.3.mha.do1@0,N,transformer.3.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.3.mha.o1@0,
transformer.3.mha.dattn@0,N,transformer.3.mha.do1@0,transformer.3._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.3.mha.dwo@0,N,transformer.3.mha.do1@0,transformer.3.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.3.mha.wo@0,
transformer.3.mha.dv@0,N,transformer.3.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.3.mha.v@0,
transformer.3.mha.dk@0,N,transformer.3.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.3.mha.k@0,
transformer.3.mha.dq@0,N,transformer.3.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.3.mha.q@0,
transformer.3.mha.dkv@0,N,transformer.3.mha.dv@0,transformer.3.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.3.mha.dqkv@0,N,transformer.3.mha.dkv@0,transformer.3.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.3.mha.qkv@0,
transformer.3.mha.dwqkv@0,N,transformer.3.mha.dqkv@0,transformer.3.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.3.mha.wqkv@0,
transformer.3.mha.dx1@0,N,transformer.3.mha.dqkv@0,transformer.3._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.3.mha.dx@0,N,transformer.3.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.3.mha.attn_kernel.q@0,N,transformer.3.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.3.mha.attn_kernel.k@0,N,transformer.3.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.3.mha.attn_kernel.v@0,N,transformer.3.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.3.mha.attn_kernel.k1@0,N,transformer.3.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.3.mha.attn_kernel.v1@0,N,transformer.3.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.3.mha.attn_kernel.qkv@0,N,transformer.3.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.3.mha.attn_kernel.k1@0"", ""transformer.3.mha.attn_kernel.v1@0""]}"
transformer.3.mha.attn_kernel.dqkv@0,N,transformer.3.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.3.mha.attn_kernel.qkv@0,
transformer.3.mha.attn_kernel.dq@0,N,transformer.3.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.3.mha.attn_kernel.q@0,
transformer.3.mha.attn_kernel.dk@0,N,transformer.3.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.3.mha.attn_kernel.dv@0,N,transformer.3.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.3.mha_res.x1@0,N,transformer.3.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.3.mha_res.x2@0,N,transformer.3.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.3.mha_res.y@0,N,transformer.3.mha_res.x1@0,transformer.3.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.3.mha_res.dy@0,N,transformer.3.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.3.mha_res.y@0,
transformer.3.mha_res.dx1@0,N,transformer.3.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.3.mha_res.x1@0,
transformer.3.mha_res.dx2@0,N,transformer.3.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.3.mha_res.x2@0,
transformer.3.post_attn_norm.x@0,N,transformer.3.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.3.post_attn_norm.y@0,N,transformer.3.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.3.post_attn_norm.dy@0,N,transformer.3.ffn.dx0@0,transformer.3.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.3.post_attn_norm.y@0,
transformer.3.post_attn_norm.dx@0,N,transformer.3.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.3.post_attn_norm.x@0,
transformer.3.ffn.x0@0,N,transformer.3.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.3.ffn.wgate@0,N,transformer.3._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.3.ffn.wdown@0,N,transformer.3._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.3.ffn.x00@0,N,transformer.3.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.3.ffn.xgate@0,N,transformer.3.ffn.x00@0,transformer.3.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.3.ffn.xdown1@0,N,transformer.3.ffn.xgate@0,transformer.3.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.3.ffn.xdown@0,N,transformer.3.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.3.ffn.dxdown@0,N,transformer.3.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.3.ffn.xdown@0,
transformer.3.ffn.dxdown2@0,N,transformer.3.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.3.ffn.dwdown@0,N,transformer.3.ffn.dxdown2@0,transformer.3.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.3.ffn.wdown@0,
transformer.3.ffn.dxgate@0,N,transformer.3.ffn.dxdown2@0,transformer.3._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.3.ffn.xgate@0,
transformer.3.ffn.x01@0,N,transformer.3.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.3.ffn.dwgate@0,N,transformer.3.ffn.dxgate@0,transformer.3.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.3.ffn.wgate@0,
transformer.3.ffn.dx000@0,N,transformer.3.ffn.dxgate@0,transformer.3._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.3.ffn.dx0@0,N,transformer.3.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.3.ffn_res.x1@0,N,transformer.3.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.3.ffn_res.x2@0,N,transformer.3.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.3.ffn_res.y@0,N,transformer.3.ffn_res.x1@0,transformer.3.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.3.ffn_res.dy@0,N,transformer.4.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.3.ffn_res.y@0,
transformer.3.ffn_res.dx1@0,N,transformer.3.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.3.ffn_res.x1@0,
transformer.3.ffn_res.dx2@0,N,transformer.3.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.3.ffn_res.x2@0,
transformer.3._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.3._assembled_weight@0,N,transformer.3._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.3._sharded_grad@0,N,transformer.3._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.3._sharded_weight@0,
transformer.3._assembled_grad@0,N,transformer.3.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.3.mha.dwo@0"", ""transformer.3.ffn.dwgate@0"", ""transformer.3.ffn.dwdown@0""]}"
transformer.3._mha.wqkv_backward@0,N,transformer.3._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.3._mha.wo_backward@0,N,transformer.3._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.3._ffn.wgate_backward@0,N,transformer.3._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.3._ffn.wdown_backward@0,N,transformer.3._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.3._assembled_weight_backward@0,N,transformer.3._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.4.input_norm.x@0,N,transformer.3.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.4.input_norm.y@0,N,transformer.4.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.4.input_norm.dy@0,N,transformer.4.mha.dx@0,transformer.4.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.4.input_norm.y@0,
transformer.4.input_norm.dx@0,N,transformer.4.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.4.input_norm.x@0,
transformer.4.mha.x@0,N,transformer.4.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.4.mha.wqkv@0,N,transformer.4._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.4.mha.qkv@0,N,transformer.4.mha.x@0,transformer.4.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.4.mha.q@0,N,transformer.4.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.4.mha.k@0,N,transformer.4.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.4.mha.v@0,N,transformer.4.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.4.mha.attn@0,N,transformer.4.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.4.mha.wo@0,N,transformer.4._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.4.mha.o1@0,N,transformer.4.mha.attn@0,transformer.4.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.4.mha.o@0,N,transformer.4.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.4.mha.do@0,N,transformer.4.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.4.mha.o@0,
transformer.4.mha.do1@0,N,transformer.4.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.4.mha.o1@0,
transformer.4.mha.dattn@0,N,transformer.4.mha.do1@0,transformer.4._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.4.mha.dwo@0,N,transformer.4.mha.do1@0,transformer.4.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.4.mha.wo@0,
transformer.4.mha.dv@0,N,transformer.4.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.4.mha.v@0,
transformer.4.mha.dk@0,N,transformer.4.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.4.mha.k@0,
transformer.4.mha.dq@0,N,transformer.4.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.4.mha.q@0,
transformer.4.mha.dkv@0,N,transformer.4.mha.dv@0,transformer.4.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.4.mha.dqkv@0,N,transformer.4.mha.dkv@0,transformer.4.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.4.mha.qkv@0,
transformer.4.mha.dwqkv@0,N,transformer.4.mha.dqkv@0,transformer.4.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.4.mha.wqkv@0,
transformer.4.mha.dx1@0,N,transformer.4.mha.dqkv@0,transformer.4._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.4.mha.dx@0,N,transformer.4.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.4.mha.attn_kernel.q@0,N,transformer.4.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.4.mha.attn_kernel.k@0,N,transformer.4.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.4.mha.attn_kernel.v@0,N,transformer.4.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.4.mha.attn_kernel.k1@0,N,transformer.4.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.4.mha.attn_kernel.v1@0,N,transformer.4.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.4.mha.attn_kernel.qkv@0,N,transformer.4.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.4.mha.attn_kernel.k1@0"", ""transformer.4.mha.attn_kernel.v1@0""]}"
transformer.4.mha.attn_kernel.dqkv@0,N,transformer.4.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.4.mha.attn_kernel.qkv@0,
transformer.4.mha.attn_kernel.dq@0,N,transformer.4.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.4.mha.attn_kernel.q@0,
transformer.4.mha.attn_kernel.dk@0,N,transformer.4.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.4.mha.attn_kernel.dv@0,N,transformer.4.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.4.mha_res.x1@0,N,transformer.4.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.4.mha_res.x2@0,N,transformer.4.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.4.mha_res.y@0,N,transformer.4.mha_res.x1@0,transformer.4.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.4.mha_res.dy@0,N,transformer.4.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.4.mha_res.y@0,
transformer.4.mha_res.dx1@0,N,transformer.4.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.4.mha_res.x1@0,
transformer.4.mha_res.dx2@0,N,transformer.4.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.4.mha_res.x2@0,
transformer.4.post_attn_norm.x@0,N,transformer.4.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.4.post_attn_norm.y@0,N,transformer.4.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.4.post_attn_norm.dy@0,N,transformer.4.ffn.dx0@0,transformer.4.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.4.post_attn_norm.y@0,
transformer.4.post_attn_norm.dx@0,N,transformer.4.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.4.post_attn_norm.x@0,
transformer.4.ffn.x0@0,N,transformer.4.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.4.ffn.wgate@0,N,transformer.4._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.4.ffn.wdown@0,N,transformer.4._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.4.ffn.x00@0,N,transformer.4.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.4.ffn.xgate@0,N,transformer.4.ffn.x00@0,transformer.4.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.4.ffn.xdown1@0,N,transformer.4.ffn.xgate@0,transformer.4.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.4.ffn.xdown@0,N,transformer.4.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.4.ffn.dxdown@0,N,transformer.4.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.4.ffn.xdown@0,
transformer.4.ffn.dxdown2@0,N,transformer.4.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.4.ffn.dwdown@0,N,transformer.4.ffn.dxdown2@0,transformer.4.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.4.ffn.wdown@0,
transformer.4.ffn.dxgate@0,N,transformer.4.ffn.dxdown2@0,transformer.4._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.4.ffn.xgate@0,
transformer.4.ffn.x01@0,N,transformer.4.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.4.ffn.dwgate@0,N,transformer.4.ffn.dxgate@0,transformer.4.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.4.ffn.wgate@0,
transformer.4.ffn.dx000@0,N,transformer.4.ffn.dxgate@0,transformer.4._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.4.ffn.dx0@0,N,transformer.4.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.4.ffn_res.x1@0,N,transformer.4.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.4.ffn_res.x2@0,N,transformer.4.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.4.ffn_res.y@0,N,transformer.4.ffn_res.x1@0,transformer.4.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.4.ffn_res.dy@0,N,transformer.5.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.4.ffn_res.y@0,
transformer.4.ffn_res.dx1@0,N,transformer.4.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.4.ffn_res.x1@0,
transformer.4.ffn_res.dx2@0,N,transformer.4.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.4.ffn_res.x2@0,
transformer.4._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.4._assembled_weight@0,N,transformer.4._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.4._sharded_grad@0,N,transformer.4._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.4._sharded_weight@0,
transformer.4._assembled_grad@0,N,transformer.4.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.4.mha.dwo@0"", ""transformer.4.ffn.dwgate@0"", ""transformer.4.ffn.dwdown@0""]}"
transformer.4._mha.wqkv_backward@0,N,transformer.4._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.4._mha.wo_backward@0,N,transformer.4._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.4._ffn.wgate_backward@0,N,transformer.4._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.4._ffn.wdown_backward@0,N,transformer.4._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.4._assembled_weight_backward@0,N,transformer.4._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.5.input_norm.x@0,N,transformer.4.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.5.input_norm.y@0,N,transformer.5.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.5.input_norm.dy@0,N,transformer.5.mha.dx@0,transformer.5.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.5.input_norm.y@0,
transformer.5.input_norm.dx@0,N,transformer.5.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.5.input_norm.x@0,
transformer.5.mha.x@0,N,transformer.5.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.5.mha.wqkv@0,N,transformer.5._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.5.mha.qkv@0,N,transformer.5.mha.x@0,transformer.5.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.5.mha.q@0,N,transformer.5.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.5.mha.k@0,N,transformer.5.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.5.mha.v@0,N,transformer.5.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.5.mha.attn@0,N,transformer.5.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.5.mha.wo@0,N,transformer.5._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.5.mha.o1@0,N,transformer.5.mha.attn@0,transformer.5.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.5.mha.o@0,N,transformer.5.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.5.mha.do@0,N,transformer.5.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.5.mha.o@0,
transformer.5.mha.do1@0,N,transformer.5.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.5.mha.o1@0,
transformer.5.mha.dattn@0,N,transformer.5.mha.do1@0,transformer.5._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.5.mha.dwo@0,N,transformer.5.mha.do1@0,transformer.5.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.5.mha.wo@0,
transformer.5.mha.dv@0,N,transformer.5.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.5.mha.v@0,
transformer.5.mha.dk@0,N,transformer.5.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.5.mha.k@0,
transformer.5.mha.dq@0,N,transformer.5.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.5.mha.q@0,
transformer.5.mha.dkv@0,N,transformer.5.mha.dv@0,transformer.5.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.5.mha.dqkv@0,N,transformer.5.mha.dkv@0,transformer.5.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.5.mha.qkv@0,
transformer.5.mha.dwqkv@0,N,transformer.5.mha.dqkv@0,transformer.5.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.5.mha.wqkv@0,
transformer.5.mha.dx1@0,N,transformer.5.mha.dqkv@0,transformer.5._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.5.mha.dx@0,N,transformer.5.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.5.mha.attn_kernel.q@0,N,transformer.5.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.5.mha.attn_kernel.k@0,N,transformer.5.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.5.mha.attn_kernel.v@0,N,transformer.5.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.5.mha.attn_kernel.k1@0,N,transformer.5.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.5.mha.attn_kernel.v1@0,N,transformer.5.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.5.mha.attn_kernel.qkv@0,N,transformer.5.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.5.mha.attn_kernel.k1@0"", ""transformer.5.mha.attn_kernel.v1@0""]}"
transformer.5.mha.attn_kernel.dqkv@0,N,transformer.5.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.5.mha.attn_kernel.qkv@0,
transformer.5.mha.attn_kernel.dq@0,N,transformer.5.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.5.mha.attn_kernel.q@0,
transformer.5.mha.attn_kernel.dk@0,N,transformer.5.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.5.mha.attn_kernel.dv@0,N,transformer.5.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.5.mha_res.x1@0,N,transformer.5.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.5.mha_res.x2@0,N,transformer.5.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.5.mha_res.y@0,N,transformer.5.mha_res.x1@0,transformer.5.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.5.mha_res.dy@0,N,transformer.5.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.5.mha_res.y@0,
transformer.5.mha_res.dx1@0,N,transformer.5.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.5.mha_res.x1@0,
transformer.5.mha_res.dx2@0,N,transformer.5.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.5.mha_res.x2@0,
transformer.5.post_attn_norm.x@0,N,transformer.5.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.5.post_attn_norm.y@0,N,transformer.5.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.5.post_attn_norm.dy@0,N,transformer.5.ffn.dx0@0,transformer.5.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.5.post_attn_norm.y@0,
transformer.5.post_attn_norm.dx@0,N,transformer.5.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.5.post_attn_norm.x@0,
transformer.5.ffn.x0@0,N,transformer.5.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.5.ffn.wgate@0,N,transformer.5._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.5.ffn.wdown@0,N,transformer.5._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.5.ffn.x00@0,N,transformer.5.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.5.ffn.xgate@0,N,transformer.5.ffn.x00@0,transformer.5.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.5.ffn.xdown1@0,N,transformer.5.ffn.xgate@0,transformer.5.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.5.ffn.xdown@0,N,transformer.5.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.5.ffn.dxdown@0,N,transformer.5.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.5.ffn.xdown@0,
transformer.5.ffn.dxdown2@0,N,transformer.5.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.5.ffn.dwdown@0,N,transformer.5.ffn.dxdown2@0,transformer.5.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.5.ffn.wdown@0,
transformer.5.ffn.dxgate@0,N,transformer.5.ffn.dxdown2@0,transformer.5._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.5.ffn.xgate@0,
transformer.5.ffn.x01@0,N,transformer.5.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.5.ffn.dwgate@0,N,transformer.5.ffn.dxgate@0,transformer.5.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.5.ffn.wgate@0,
transformer.5.ffn.dx000@0,N,transformer.5.ffn.dxgate@0,transformer.5._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.5.ffn.dx0@0,N,transformer.5.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.5.ffn_res.x1@0,N,transformer.5.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.5.ffn_res.x2@0,N,transformer.5.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.5.ffn_res.y@0,N,transformer.5.ffn_res.x1@0,transformer.5.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.5.ffn_res.dy@0,N,transformer.6.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.5.ffn_res.y@0,
transformer.5.ffn_res.dx1@0,N,transformer.5.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.5.ffn_res.x1@0,
transformer.5.ffn_res.dx2@0,N,transformer.5.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.5.ffn_res.x2@0,
transformer.5._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.5._assembled_weight@0,N,transformer.5._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.5._sharded_grad@0,N,transformer.5._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.5._sharded_weight@0,
transformer.5._assembled_grad@0,N,transformer.5.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.5.mha.dwo@0"", ""transformer.5.ffn.dwgate@0"", ""transformer.5.ffn.dwdown@0""]}"
transformer.5._mha.wqkv_backward@0,N,transformer.5._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.5._mha.wo_backward@0,N,transformer.5._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.5._ffn.wgate_backward@0,N,transformer.5._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.5._ffn.wdown_backward@0,N,transformer.5._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.5._assembled_weight_backward@0,N,transformer.5._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.6.input_norm.x@0,N,transformer.5.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.6.input_norm.y@0,N,transformer.6.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.6.input_norm.dy@0,N,transformer.6.mha.dx@0,transformer.6.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.6.input_norm.y@0,
transformer.6.input_norm.dx@0,N,transformer.6.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.6.input_norm.x@0,
transformer.6.mha.x@0,N,transformer.6.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.6.mha.wqkv@0,N,transformer.6._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.6.mha.qkv@0,N,transformer.6.mha.x@0,transformer.6.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.6.mha.q@0,N,transformer.6.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.6.mha.k@0,N,transformer.6.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.6.mha.v@0,N,transformer.6.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.6.mha.attn@0,N,transformer.6.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.6.mha.wo@0,N,transformer.6._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.6.mha.o1@0,N,transformer.6.mha.attn@0,transformer.6.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.6.mha.o@0,N,transformer.6.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.6.mha.do@0,N,transformer.6.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.6.mha.o@0,
transformer.6.mha.do1@0,N,transformer.6.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.6.mha.o1@0,
transformer.6.mha.dattn@0,N,transformer.6.mha.do1@0,transformer.6._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.6.mha.dwo@0,N,transformer.6.mha.do1@0,transformer.6.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.6.mha.wo@0,
transformer.6.mha.dv@0,N,transformer.6.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.6.mha.v@0,
transformer.6.mha.dk@0,N,transformer.6.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.6.mha.k@0,
transformer.6.mha.dq@0,N,transformer.6.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.6.mha.q@0,
transformer.6.mha.dkv@0,N,transformer.6.mha.dv@0,transformer.6.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.6.mha.dqkv@0,N,transformer.6.mha.dkv@0,transformer.6.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.6.mha.qkv@0,
transformer.6.mha.dwqkv@0,N,transformer.6.mha.dqkv@0,transformer.6.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.6.mha.wqkv@0,
transformer.6.mha.dx1@0,N,transformer.6.mha.dqkv@0,transformer.6._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.6.mha.dx@0,N,transformer.6.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.6.mha.attn_kernel.q@0,N,transformer.6.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.6.mha.attn_kernel.k@0,N,transformer.6.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.6.mha.attn_kernel.v@0,N,transformer.6.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.6.mha.attn_kernel.k1@0,N,transformer.6.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.6.mha.attn_kernel.v1@0,N,transformer.6.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.6.mha.attn_kernel.qkv@0,N,transformer.6.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.6.mha.attn_kernel.k1@0"", ""transformer.6.mha.attn_kernel.v1@0""]}"
transformer.6.mha.attn_kernel.dqkv@0,N,transformer.6.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.6.mha.attn_kernel.qkv@0,
transformer.6.mha.attn_kernel.dq@0,N,transformer.6.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.6.mha.attn_kernel.q@0,
transformer.6.mha.attn_kernel.dk@0,N,transformer.6.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.6.mha.attn_kernel.dv@0,N,transformer.6.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.6.mha_res.x1@0,N,transformer.6.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.6.mha_res.x2@0,N,transformer.6.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.6.mha_res.y@0,N,transformer.6.mha_res.x1@0,transformer.6.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.6.mha_res.dy@0,N,transformer.6.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.6.mha_res.y@0,
transformer.6.mha_res.dx1@0,N,transformer.6.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.6.mha_res.x1@0,
transformer.6.mha_res.dx2@0,N,transformer.6.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.6.mha_res.x2@0,
transformer.6.post_attn_norm.x@0,N,transformer.6.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.6.post_attn_norm.y@0,N,transformer.6.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.6.post_attn_norm.dy@0,N,transformer.6.ffn.dx0@0,transformer.6.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.6.post_attn_norm.y@0,
transformer.6.post_attn_norm.dx@0,N,transformer.6.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.6.post_attn_norm.x@0,
transformer.6.ffn.x0@0,N,transformer.6.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.6.ffn.wgate@0,N,transformer.6._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.6.ffn.wdown@0,N,transformer.6._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.6.ffn.x00@0,N,transformer.6.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.6.ffn.xgate@0,N,transformer.6.ffn.x00@0,transformer.6.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.6.ffn.xdown1@0,N,transformer.6.ffn.xgate@0,transformer.6.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.6.ffn.xdown@0,N,transformer.6.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.6.ffn.dxdown@0,N,transformer.6.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.6.ffn.xdown@0,
transformer.6.ffn.dxdown2@0,N,transformer.6.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.6.ffn.dwdown@0,N,transformer.6.ffn.dxdown2@0,transformer.6.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.6.ffn.wdown@0,
transformer.6.ffn.dxgate@0,N,transformer.6.ffn.dxdown2@0,transformer.6._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.6.ffn.xgate@0,
transformer.6.ffn.x01@0,N,transformer.6.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.6.ffn.dwgate@0,N,transformer.6.ffn.dxgate@0,transformer.6.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.6.ffn.wgate@0,
transformer.6.ffn.dx000@0,N,transformer.6.ffn.dxgate@0,transformer.6._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.6.ffn.dx0@0,N,transformer.6.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.6.ffn_res.x1@0,N,transformer.6.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.6.ffn_res.x2@0,N,transformer.6.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.6.ffn_res.y@0,N,transformer.6.ffn_res.x1@0,transformer.6.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.6.ffn_res.dy@0,N,transformer.7.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.6.ffn_res.y@0,
transformer.6.ffn_res.dx1@0,N,transformer.6.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.6.ffn_res.x1@0,
transformer.6.ffn_res.dx2@0,N,transformer.6.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.6.ffn_res.x2@0,
transformer.6._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.6._assembled_weight@0,N,transformer.6._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.6._sharded_grad@0,N,transformer.6._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.6._sharded_weight@0,
transformer.6._assembled_grad@0,N,transformer.6.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.6.mha.dwo@0"", ""transformer.6.ffn.dwgate@0"", ""transformer.6.ffn.dwdown@0""]}"
transformer.6._mha.wqkv_backward@0,N,transformer.6._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.6._mha.wo_backward@0,N,transformer.6._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.6._ffn.wgate_backward@0,N,transformer.6._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.6._ffn.wdown_backward@0,N,transformer.6._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.6._assembled_weight_backward@0,N,transformer.6._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.7.input_norm.x@0,N,transformer.6.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.7.input_norm.y@0,N,transformer.7.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.7.input_norm.dy@0,N,transformer.7.mha.dx@0,transformer.7.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.7.input_norm.y@0,
transformer.7.input_norm.dx@0,N,transformer.7.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.7.input_norm.x@0,
transformer.7.mha.x@0,N,transformer.7.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.7.mha.wqkv@0,N,transformer.7._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.7.mha.qkv@0,N,transformer.7.mha.x@0,transformer.7.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.7.mha.q@0,N,transformer.7.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.7.mha.k@0,N,transformer.7.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.7.mha.v@0,N,transformer.7.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.7.mha.attn@0,N,transformer.7.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.7.mha.wo@0,N,transformer.7._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.7.mha.o1@0,N,transformer.7.mha.attn@0,transformer.7.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.7.mha.o@0,N,transformer.7.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.7.mha.do@0,N,transformer.7.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.7.mha.o@0,
transformer.7.mha.do1@0,N,transformer.7.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.7.mha.o1@0,
transformer.7.mha.dattn@0,N,transformer.7.mha.do1@0,transformer.7._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.7.mha.dwo@0,N,transformer.7.mha.do1@0,transformer.7.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.7.mha.wo@0,
transformer.7.mha.dv@0,N,transformer.7.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.7.mha.v@0,
transformer.7.mha.dk@0,N,transformer.7.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.7.mha.k@0,
transformer.7.mha.dq@0,N,transformer.7.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.7.mha.q@0,
transformer.7.mha.dkv@0,N,transformer.7.mha.dv@0,transformer.7.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.7.mha.dqkv@0,N,transformer.7.mha.dkv@0,transformer.7.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.7.mha.qkv@0,
transformer.7.mha.dwqkv@0,N,transformer.7.mha.dqkv@0,transformer.7.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.7.mha.wqkv@0,
transformer.7.mha.dx1@0,N,transformer.7.mha.dqkv@0,transformer.7._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.7.mha.dx@0,N,transformer.7.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.7.mha.attn_kernel.q@0,N,transformer.7.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.7.mha.attn_kernel.k@0,N,transformer.7.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.7.mha.attn_kernel.v@0,N,transformer.7.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.7.mha.attn_kernel.k1@0,N,transformer.7.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.7.mha.attn_kernel.v1@0,N,transformer.7.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.7.mha.attn_kernel.qkv@0,N,transformer.7.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.7.mha.attn_kernel.k1@0"", ""transformer.7.mha.attn_kernel.v1@0""]}"
transformer.7.mha.attn_kernel.dqkv@0,N,transformer.7.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.7.mha.attn_kernel.qkv@0,
transformer.7.mha.attn_kernel.dq@0,N,transformer.7.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.7.mha.attn_kernel.q@0,
transformer.7.mha.attn_kernel.dk@0,N,transformer.7.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.7.mha.attn_kernel.dv@0,N,transformer.7.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.7.mha_res.x1@0,N,transformer.7.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.7.mha_res.x2@0,N,transformer.7.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.7.mha_res.y@0,N,transformer.7.mha_res.x1@0,transformer.7.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.7.mha_res.dy@0,N,transformer.7.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.7.mha_res.y@0,
transformer.7.mha_res.dx1@0,N,transformer.7.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.7.mha_res.x1@0,
transformer.7.mha_res.dx2@0,N,transformer.7.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.7.mha_res.x2@0,
transformer.7.post_attn_norm.x@0,N,transformer.7.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.7.post_attn_norm.y@0,N,transformer.7.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.7.post_attn_norm.dy@0,N,transformer.7.ffn.dx0@0,transformer.7.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.7.post_attn_norm.y@0,
transformer.7.post_attn_norm.dx@0,N,transformer.7.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.7.post_attn_norm.x@0,
transformer.7.ffn.x0@0,N,transformer.7.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.7.ffn.wgate@0,N,transformer.7._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.7.ffn.wdown@0,N,transformer.7._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.7.ffn.x00@0,N,transformer.7.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.7.ffn.xgate@0,N,transformer.7.ffn.x00@0,transformer.7.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.7.ffn.xdown1@0,N,transformer.7.ffn.xgate@0,transformer.7.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.7.ffn.xdown@0,N,transformer.7.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.7.ffn.dxdown@0,N,transformer.7.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.7.ffn.xdown@0,
transformer.7.ffn.dxdown2@0,N,transformer.7.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.7.ffn.dwdown@0,N,transformer.7.ffn.dxdown2@0,transformer.7.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.7.ffn.wdown@0,
transformer.7.ffn.dxgate@0,N,transformer.7.ffn.dxdown2@0,transformer.7._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.7.ffn.xgate@0,
transformer.7.ffn.x01@0,N,transformer.7.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.7.ffn.dwgate@0,N,transformer.7.ffn.dxgate@0,transformer.7.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.7.ffn.wgate@0,
transformer.7.ffn.dx000@0,N,transformer.7.ffn.dxgate@0,transformer.7._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.7.ffn.dx0@0,N,transformer.7.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.7.ffn_res.x1@0,N,transformer.7.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.7.ffn_res.x2@0,N,transformer.7.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.7.ffn_res.y@0,N,transformer.7.ffn_res.x1@0,transformer.7.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.7.ffn_res.dy@0,N,transformer.8.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.7.ffn_res.y@0,
transformer.7.ffn_res.dx1@0,N,transformer.7.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.7.ffn_res.x1@0,
transformer.7.ffn_res.dx2@0,N,transformer.7.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.7.ffn_res.x2@0,
transformer.7._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.7._assembled_weight@0,N,transformer.7._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.7._sharded_grad@0,N,transformer.7._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.7._sharded_weight@0,
transformer.7._assembled_grad@0,N,transformer.7.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.7.mha.dwo@0"", ""transformer.7.ffn.dwgate@0"", ""transformer.7.ffn.dwdown@0""]}"
transformer.7._mha.wqkv_backward@0,N,transformer.7._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.7._mha.wo_backward@0,N,transformer.7._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.7._ffn.wgate_backward@0,N,transformer.7._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.7._ffn.wdown_backward@0,N,transformer.7._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.7._assembled_weight_backward@0,N,transformer.7._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.8.input_norm.x@0,N,transformer.7.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.8.input_norm.y@0,N,transformer.8.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.8.input_norm.dy@0,N,transformer.8.mha.dx@0,transformer.8.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.8.input_norm.y@0,
transformer.8.input_norm.dx@0,N,transformer.8.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.8.input_norm.x@0,
transformer.8.mha.x@0,N,transformer.8.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.8.mha.wqkv@0,N,transformer.8._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.8.mha.qkv@0,N,transformer.8.mha.x@0,transformer.8.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.8.mha.q@0,N,transformer.8.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.8.mha.k@0,N,transformer.8.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.8.mha.v@0,N,transformer.8.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.8.mha.attn@0,N,transformer.8.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.8.mha.wo@0,N,transformer.8._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.8.mha.o1@0,N,transformer.8.mha.attn@0,transformer.8.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.8.mha.o@0,N,transformer.8.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.8.mha.do@0,N,transformer.8.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.8.mha.o@0,
transformer.8.mha.do1@0,N,transformer.8.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.8.mha.o1@0,
transformer.8.mha.dattn@0,N,transformer.8.mha.do1@0,transformer.8._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.8.mha.dwo@0,N,transformer.8.mha.do1@0,transformer.8.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.8.mha.wo@0,
transformer.8.mha.dv@0,N,transformer.8.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.8.mha.v@0,
transformer.8.mha.dk@0,N,transformer.8.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.8.mha.k@0,
transformer.8.mha.dq@0,N,transformer.8.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.8.mha.q@0,
transformer.8.mha.dkv@0,N,transformer.8.mha.dv@0,transformer.8.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.8.mha.dqkv@0,N,transformer.8.mha.dkv@0,transformer.8.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.8.mha.qkv@0,
transformer.8.mha.dwqkv@0,N,transformer.8.mha.dqkv@0,transformer.8.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.8.mha.wqkv@0,
transformer.8.mha.dx1@0,N,transformer.8.mha.dqkv@0,transformer.8._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.8.mha.dx@0,N,transformer.8.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.8.mha.attn_kernel.q@0,N,transformer.8.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.8.mha.attn_kernel.k@0,N,transformer.8.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.8.mha.attn_kernel.v@0,N,transformer.8.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.8.mha.attn_kernel.k1@0,N,transformer.8.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.8.mha.attn_kernel.v1@0,N,transformer.8.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.8.mha.attn_kernel.qkv@0,N,transformer.8.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.8.mha.attn_kernel.k1@0"", ""transformer.8.mha.attn_kernel.v1@0""]}"
transformer.8.mha.attn_kernel.dqkv@0,N,transformer.8.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.8.mha.attn_kernel.qkv@0,
transformer.8.mha.attn_kernel.dq@0,N,transformer.8.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.8.mha.attn_kernel.q@0,
transformer.8.mha.attn_kernel.dk@0,N,transformer.8.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.8.mha.attn_kernel.dv@0,N,transformer.8.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.8.mha_res.x1@0,N,transformer.8.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.8.mha_res.x2@0,N,transformer.8.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.8.mha_res.y@0,N,transformer.8.mha_res.x1@0,transformer.8.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.8.mha_res.dy@0,N,transformer.8.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.8.mha_res.y@0,
transformer.8.mha_res.dx1@0,N,transformer.8.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.8.mha_res.x1@0,
transformer.8.mha_res.dx2@0,N,transformer.8.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.8.mha_res.x2@0,
transformer.8.post_attn_norm.x@0,N,transformer.8.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.8.post_attn_norm.y@0,N,transformer.8.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.8.post_attn_norm.dy@0,N,transformer.8.ffn.dx0@0,transformer.8.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.8.post_attn_norm.y@0,
transformer.8.post_attn_norm.dx@0,N,transformer.8.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.8.post_attn_norm.x@0,
transformer.8.ffn.x0@0,N,transformer.8.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.8.ffn.wgate@0,N,transformer.8._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.8.ffn.wdown@0,N,transformer.8._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.8.ffn.x00@0,N,transformer.8.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.8.ffn.xgate@0,N,transformer.8.ffn.x00@0,transformer.8.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.8.ffn.xdown1@0,N,transformer.8.ffn.xgate@0,transformer.8.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.8.ffn.xdown@0,N,transformer.8.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.8.ffn.dxdown@0,N,transformer.8.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.8.ffn.xdown@0,
transformer.8.ffn.dxdown2@0,N,transformer.8.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.8.ffn.dwdown@0,N,transformer.8.ffn.dxdown2@0,transformer.8.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.8.ffn.wdown@0,
transformer.8.ffn.dxgate@0,N,transformer.8.ffn.dxdown2@0,transformer.8._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.8.ffn.xgate@0,
transformer.8.ffn.x01@0,N,transformer.8.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.8.ffn.dwgate@0,N,transformer.8.ffn.dxgate@0,transformer.8.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.8.ffn.wgate@0,
transformer.8.ffn.dx000@0,N,transformer.8.ffn.dxgate@0,transformer.8._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.8.ffn.dx0@0,N,transformer.8.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.8.ffn_res.x1@0,N,transformer.8.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.8.ffn_res.x2@0,N,transformer.8.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.8.ffn_res.y@0,N,transformer.8.ffn_res.x1@0,transformer.8.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.8.ffn_res.dy@0,N,transformer.9.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.8.ffn_res.y@0,
transformer.8.ffn_res.dx1@0,N,transformer.8.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.8.ffn_res.x1@0,
transformer.8.ffn_res.dx2@0,N,transformer.8.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.8.ffn_res.x2@0,
transformer.8._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.8._assembled_weight@0,N,transformer.8._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.8._sharded_grad@0,N,transformer.8._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.8._sharded_weight@0,
transformer.8._assembled_grad@0,N,transformer.8.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.8.mha.dwo@0"", ""transformer.8.ffn.dwgate@0"", ""transformer.8.ffn.dwdown@0""]}"
transformer.8._mha.wqkv_backward@0,N,transformer.8._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.8._mha.wo_backward@0,N,transformer.8._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.8._ffn.wgate_backward@0,N,transformer.8._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.8._ffn.wdown_backward@0,N,transformer.8._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.8._assembled_weight_backward@0,N,transformer.8._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.9.input_norm.x@0,N,transformer.8.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.9.input_norm.y@0,N,transformer.9.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.9.input_norm.dy@0,N,transformer.9.mha.dx@0,transformer.9.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.9.input_norm.y@0,
transformer.9.input_norm.dx@0,N,transformer.9.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.9.input_norm.x@0,
transformer.9.mha.x@0,N,transformer.9.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.9.mha.wqkv@0,N,transformer.9._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.9.mha.qkv@0,N,transformer.9.mha.x@0,transformer.9.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.9.mha.q@0,N,transformer.9.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.9.mha.k@0,N,transformer.9.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.9.mha.v@0,N,transformer.9.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.9.mha.attn@0,N,transformer.9.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.9.mha.wo@0,N,transformer.9._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.9.mha.o1@0,N,transformer.9.mha.attn@0,transformer.9.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.9.mha.o@0,N,transformer.9.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.9.mha.do@0,N,transformer.9.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.9.mha.o@0,
transformer.9.mha.do1@0,N,transformer.9.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.9.mha.o1@0,
transformer.9.mha.dattn@0,N,transformer.9.mha.do1@0,transformer.9._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.9.mha.dwo@0,N,transformer.9.mha.do1@0,transformer.9.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.9.mha.wo@0,
transformer.9.mha.dv@0,N,transformer.9.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.9.mha.v@0,
transformer.9.mha.dk@0,N,transformer.9.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.9.mha.k@0,
transformer.9.mha.dq@0,N,transformer.9.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.9.mha.q@0,
transformer.9.mha.dkv@0,N,transformer.9.mha.dv@0,transformer.9.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.9.mha.dqkv@0,N,transformer.9.mha.dkv@0,transformer.9.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.9.mha.qkv@0,
transformer.9.mha.dwqkv@0,N,transformer.9.mha.dqkv@0,transformer.9.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.9.mha.wqkv@0,
transformer.9.mha.dx1@0,N,transformer.9.mha.dqkv@0,transformer.9._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.9.mha.dx@0,N,transformer.9.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.9.mha.attn_kernel.q@0,N,transformer.9.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.9.mha.attn_kernel.k@0,N,transformer.9.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.9.mha.attn_kernel.v@0,N,transformer.9.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.9.mha.attn_kernel.k1@0,N,transformer.9.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.9.mha.attn_kernel.v1@0,N,transformer.9.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.9.mha.attn_kernel.qkv@0,N,transformer.9.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.9.mha.attn_kernel.k1@0"", ""transformer.9.mha.attn_kernel.v1@0""]}"
transformer.9.mha.attn_kernel.dqkv@0,N,transformer.9.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.9.mha.attn_kernel.qkv@0,
transformer.9.mha.attn_kernel.dq@0,N,transformer.9.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.9.mha.attn_kernel.q@0,
transformer.9.mha.attn_kernel.dk@0,N,transformer.9.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.9.mha.attn_kernel.dv@0,N,transformer.9.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.9.mha_res.x1@0,N,transformer.9.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.9.mha_res.x2@0,N,transformer.9.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.9.mha_res.y@0,N,transformer.9.mha_res.x1@0,transformer.9.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.9.mha_res.dy@0,N,transformer.9.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.9.mha_res.y@0,
transformer.9.mha_res.dx1@0,N,transformer.9.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.9.mha_res.x1@0,
transformer.9.mha_res.dx2@0,N,transformer.9.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.9.mha_res.x2@0,
transformer.9.post_attn_norm.x@0,N,transformer.9.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.9.post_attn_norm.y@0,N,transformer.9.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.9.post_attn_norm.dy@0,N,transformer.9.ffn.dx0@0,transformer.9.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.9.post_attn_norm.y@0,
transformer.9.post_attn_norm.dx@0,N,transformer.9.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.9.post_attn_norm.x@0,
transformer.9.ffn.x0@0,N,transformer.9.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.9.ffn.wgate@0,N,transformer.9._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.9.ffn.wdown@0,N,transformer.9._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.9.ffn.x00@0,N,transformer.9.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.9.ffn.xgate@0,N,transformer.9.ffn.x00@0,transformer.9.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.9.ffn.xdown1@0,N,transformer.9.ffn.xgate@0,transformer.9.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.9.ffn.xdown@0,N,transformer.9.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.9.ffn.dxdown@0,N,transformer.9.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.9.ffn.xdown@0,
transformer.9.ffn.dxdown2@0,N,transformer.9.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.9.ffn.dwdown@0,N,transformer.9.ffn.dxdown2@0,transformer.9.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.9.ffn.wdown@0,
transformer.9.ffn.dxgate@0,N,transformer.9.ffn.dxdown2@0,transformer.9._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.9.ffn.xgate@0,
transformer.9.ffn.x01@0,N,transformer.9.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.9.ffn.dwgate@0,N,transformer.9.ffn.dxgate@0,transformer.9.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.9.ffn.wgate@0,
transformer.9.ffn.dx000@0,N,transformer.9.ffn.dxgate@0,transformer.9._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.9.ffn.dx0@0,N,transformer.9.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.9.ffn_res.x1@0,N,transformer.9.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.9.ffn_res.x2@0,N,transformer.9.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.9.ffn_res.y@0,N,transformer.9.ffn_res.x1@0,transformer.9.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.9.ffn_res.dy@0,N,transformer.10.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.9.ffn_res.y@0,
transformer.9.ffn_res.dx1@0,N,transformer.9.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.9.ffn_res.x1@0,
transformer.9.ffn_res.dx2@0,N,transformer.9.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.9.ffn_res.x2@0,
transformer.9._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.9._assembled_weight@0,N,transformer.9._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.9._sharded_grad@0,N,transformer.9._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.9._sharded_weight@0,
transformer.9._assembled_grad@0,N,transformer.9.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.9.mha.dwo@0"", ""transformer.9.ffn.dwgate@0"", ""transformer.9.ffn.dwdown@0""]}"
transformer.9._mha.wqkv_backward@0,N,transformer.9._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.9._mha.wo_backward@0,N,transformer.9._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.9._ffn.wgate_backward@0,N,transformer.9._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.9._ffn.wdown_backward@0,N,transformer.9._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.9._assembled_weight_backward@0,N,transformer.9._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.10.input_norm.x@0,N,transformer.9.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.10.input_norm.y@0,N,transformer.10.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.10.input_norm.dy@0,N,transformer.10.mha.dx@0,transformer.10.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.10.input_norm.y@0,
transformer.10.input_norm.dx@0,N,transformer.10.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.10.input_norm.x@0,
transformer.10.mha.x@0,N,transformer.10.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.10.mha.wqkv@0,N,transformer.10._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.10.mha.qkv@0,N,transformer.10.mha.x@0,transformer.10.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.10.mha.q@0,N,transformer.10.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.10.mha.k@0,N,transformer.10.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.10.mha.v@0,N,transformer.10.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.10.mha.attn@0,N,transformer.10.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.10.mha.wo@0,N,transformer.10._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.10.mha.o1@0,N,transformer.10.mha.attn@0,transformer.10.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.10.mha.o@0,N,transformer.10.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.10.mha.do@0,N,transformer.10.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.10.mha.o@0,
transformer.10.mha.do1@0,N,transformer.10.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.10.mha.o1@0,
transformer.10.mha.dattn@0,N,transformer.10.mha.do1@0,transformer.10._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.10.mha.dwo@0,N,transformer.10.mha.do1@0,transformer.10.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.10.mha.wo@0,
transformer.10.mha.dv@0,N,transformer.10.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.10.mha.v@0,
transformer.10.mha.dk@0,N,transformer.10.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.10.mha.k@0,
transformer.10.mha.dq@0,N,transformer.10.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.10.mha.q@0,
transformer.10.mha.dkv@0,N,transformer.10.mha.dv@0,transformer.10.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.10.mha.dqkv@0,N,transformer.10.mha.dkv@0,transformer.10.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.10.mha.qkv@0,
transformer.10.mha.dwqkv@0,N,transformer.10.mha.dqkv@0,transformer.10.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.10.mha.wqkv@0,
transformer.10.mha.dx1@0,N,transformer.10.mha.dqkv@0,transformer.10._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.10.mha.dx@0,N,transformer.10.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.10.mha.attn_kernel.q@0,N,transformer.10.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.10.mha.attn_kernel.k@0,N,transformer.10.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.10.mha.attn_kernel.v@0,N,transformer.10.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.10.mha.attn_kernel.k1@0,N,transformer.10.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.10.mha.attn_kernel.v1@0,N,transformer.10.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.10.mha.attn_kernel.qkv@0,N,transformer.10.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.10.mha.attn_kernel.k1@0"", ""transformer.10.mha.attn_kernel.v1@0""]}"
transformer.10.mha.attn_kernel.dqkv@0,N,transformer.10.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.10.mha.attn_kernel.qkv@0,
transformer.10.mha.attn_kernel.dq@0,N,transformer.10.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.10.mha.attn_kernel.q@0,
transformer.10.mha.attn_kernel.dk@0,N,transformer.10.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.10.mha.attn_kernel.dv@0,N,transformer.10.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.10.mha_res.x1@0,N,transformer.10.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.10.mha_res.x2@0,N,transformer.10.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.10.mha_res.y@0,N,transformer.10.mha_res.x1@0,transformer.10.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.10.mha_res.dy@0,N,transformer.10.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.10.mha_res.y@0,
transformer.10.mha_res.dx1@0,N,transformer.10.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.10.mha_res.x1@0,
transformer.10.mha_res.dx2@0,N,transformer.10.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.10.mha_res.x2@0,
transformer.10.post_attn_norm.x@0,N,transformer.10.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.10.post_attn_norm.y@0,N,transformer.10.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.10.post_attn_norm.dy@0,N,transformer.10.ffn.dx0@0,transformer.10.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.10.post_attn_norm.y@0,
transformer.10.post_attn_norm.dx@0,N,transformer.10.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.10.post_attn_norm.x@0,
transformer.10.ffn.x0@0,N,transformer.10.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.10.ffn.wgate@0,N,transformer.10._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.10.ffn.wdown@0,N,transformer.10._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.10.ffn.x00@0,N,transformer.10.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.10.ffn.xgate@0,N,transformer.10.ffn.x00@0,transformer.10.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.10.ffn.xdown1@0,N,transformer.10.ffn.xgate@0,transformer.10.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.10.ffn.xdown@0,N,transformer.10.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.10.ffn.dxdown@0,N,transformer.10.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.10.ffn.xdown@0,
transformer.10.ffn.dxdown2@0,N,transformer.10.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.10.ffn.dwdown@0,N,transformer.10.ffn.dxdown2@0,transformer.10.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.10.ffn.wdown@0,
transformer.10.ffn.dxgate@0,N,transformer.10.ffn.dxdown2@0,transformer.10._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.10.ffn.xgate@0,
transformer.10.ffn.x01@0,N,transformer.10.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.10.ffn.dwgate@0,N,transformer.10.ffn.dxgate@0,transformer.10.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.10.ffn.wgate@0,
transformer.10.ffn.dx000@0,N,transformer.10.ffn.dxgate@0,transformer.10._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.10.ffn.dx0@0,N,transformer.10.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.10.ffn_res.x1@0,N,transformer.10.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.10.ffn_res.x2@0,N,transformer.10.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.10.ffn_res.y@0,N,transformer.10.ffn_res.x1@0,transformer.10.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.10.ffn_res.dy@0,N,transformer.11.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.10.ffn_res.y@0,
transformer.10.ffn_res.dx1@0,N,transformer.10.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.10.ffn_res.x1@0,
transformer.10.ffn_res.dx2@0,N,transformer.10.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.10.ffn_res.x2@0,
transformer.10._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.10._assembled_weight@0,N,transformer.10._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.10._sharded_grad@0,N,transformer.10._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.10._sharded_weight@0,
transformer.10._assembled_grad@0,N,transformer.10.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.10.mha.dwo@0"", ""transformer.10.ffn.dwgate@0"", ""transformer.10.ffn.dwdown@0""]}"
transformer.10._mha.wqkv_backward@0,N,transformer.10._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.10._mha.wo_backward@0,N,transformer.10._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.10._ffn.wgate_backward@0,N,transformer.10._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.10._ffn.wdown_backward@0,N,transformer.10._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.10._assembled_weight_backward@0,N,transformer.10._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.11.input_norm.x@0,N,transformer.10.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.11.input_norm.y@0,N,transformer.11.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.11.input_norm.dy@0,N,transformer.11.mha.dx@0,transformer.11.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.11.input_norm.y@0,
transformer.11.input_norm.dx@0,N,transformer.11.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.11.input_norm.x@0,
transformer.11.mha.x@0,N,transformer.11.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.11.mha.wqkv@0,N,transformer.11._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.11.mha.qkv@0,N,transformer.11.mha.x@0,transformer.11.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.11.mha.q@0,N,transformer.11.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.11.mha.k@0,N,transformer.11.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.11.mha.v@0,N,transformer.11.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.11.mha.attn@0,N,transformer.11.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.11.mha.wo@0,N,transformer.11._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.11.mha.o1@0,N,transformer.11.mha.attn@0,transformer.11.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.11.mha.o@0,N,transformer.11.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.11.mha.do@0,N,transformer.11.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.11.mha.o@0,
transformer.11.mha.do1@0,N,transformer.11.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.11.mha.o1@0,
transformer.11.mha.dattn@0,N,transformer.11.mha.do1@0,transformer.11._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.11.mha.dwo@0,N,transformer.11.mha.do1@0,transformer.11.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.11.mha.wo@0,
transformer.11.mha.dv@0,N,transformer.11.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.11.mha.v@0,
transformer.11.mha.dk@0,N,transformer.11.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.11.mha.k@0,
transformer.11.mha.dq@0,N,transformer.11.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.11.mha.q@0,
transformer.11.mha.dkv@0,N,transformer.11.mha.dv@0,transformer.11.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.11.mha.dqkv@0,N,transformer.11.mha.dkv@0,transformer.11.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.11.mha.qkv@0,
transformer.11.mha.dwqkv@0,N,transformer.11.mha.dqkv@0,transformer.11.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.11.mha.wqkv@0,
transformer.11.mha.dx1@0,N,transformer.11.mha.dqkv@0,transformer.11._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.11.mha.dx@0,N,transformer.11.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.11.mha.attn_kernel.q@0,N,transformer.11.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.11.mha.attn_kernel.k@0,N,transformer.11.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.11.mha.attn_kernel.v@0,N,transformer.11.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.11.mha.attn_kernel.k1@0,N,transformer.11.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.11.mha.attn_kernel.v1@0,N,transformer.11.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.11.mha.attn_kernel.qkv@0,N,transformer.11.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.11.mha.attn_kernel.k1@0"", ""transformer.11.mha.attn_kernel.v1@0""]}"
transformer.11.mha.attn_kernel.dqkv@0,N,transformer.11.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.11.mha.attn_kernel.qkv@0,
transformer.11.mha.attn_kernel.dq@0,N,transformer.11.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.11.mha.attn_kernel.q@0,
transformer.11.mha.attn_kernel.dk@0,N,transformer.11.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.11.mha.attn_kernel.dv@0,N,transformer.11.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.11.mha_res.x1@0,N,transformer.11.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.11.mha_res.x2@0,N,transformer.11.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.11.mha_res.y@0,N,transformer.11.mha_res.x1@0,transformer.11.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.11.mha_res.dy@0,N,transformer.11.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.11.mha_res.y@0,
transformer.11.mha_res.dx1@0,N,transformer.11.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.11.mha_res.x1@0,
transformer.11.mha_res.dx2@0,N,transformer.11.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.11.mha_res.x2@0,
transformer.11.post_attn_norm.x@0,N,transformer.11.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.11.post_attn_norm.y@0,N,transformer.11.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.11.post_attn_norm.dy@0,N,transformer.11.ffn.dx0@0,transformer.11.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.11.post_attn_norm.y@0,
transformer.11.post_attn_norm.dx@0,N,transformer.11.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.11.post_attn_norm.x@0,
transformer.11.ffn.x0@0,N,transformer.11.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.11.ffn.wgate@0,N,transformer.11._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.11.ffn.wdown@0,N,transformer.11._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.11.ffn.x00@0,N,transformer.11.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.11.ffn.xgate@0,N,transformer.11.ffn.x00@0,transformer.11.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.11.ffn.xdown1@0,N,transformer.11.ffn.xgate@0,transformer.11.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.11.ffn.xdown@0,N,transformer.11.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.11.ffn.dxdown@0,N,transformer.11.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.11.ffn.xdown@0,
transformer.11.ffn.dxdown2@0,N,transformer.11.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.11.ffn.dwdown@0,N,transformer.11.ffn.dxdown2@0,transformer.11.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.11.ffn.wdown@0,
transformer.11.ffn.dxgate@0,N,transformer.11.ffn.dxdown2@0,transformer.11._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.11.ffn.xgate@0,
transformer.11.ffn.x01@0,N,transformer.11.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.11.ffn.dwgate@0,N,transformer.11.ffn.dxgate@0,transformer.11.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.11.ffn.wgate@0,
transformer.11.ffn.dx000@0,N,transformer.11.ffn.dxgate@0,transformer.11._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.11.ffn.dx0@0,N,transformer.11.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.11.ffn_res.x1@0,N,transformer.11.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.11.ffn_res.x2@0,N,transformer.11.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.11.ffn_res.y@0,N,transformer.11.ffn_res.x1@0,transformer.11.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.11.ffn_res.dy@0,N,transformer.12.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.11.ffn_res.y@0,
transformer.11.ffn_res.dx1@0,N,transformer.11.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.11.ffn_res.x1@0,
transformer.11.ffn_res.dx2@0,N,transformer.11.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.11.ffn_res.x2@0,
transformer.11._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.11._assembled_weight@0,N,transformer.11._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.11._sharded_grad@0,N,transformer.11._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.11._sharded_weight@0,
transformer.11._assembled_grad@0,N,transformer.11.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.11.mha.dwo@0"", ""transformer.11.ffn.dwgate@0"", ""transformer.11.ffn.dwdown@0""]}"
transformer.11._mha.wqkv_backward@0,N,transformer.11._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.11._mha.wo_backward@0,N,transformer.11._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.11._ffn.wgate_backward@0,N,transformer.11._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.11._ffn.wdown_backward@0,N,transformer.11._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.11._assembled_weight_backward@0,N,transformer.11._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.12.input_norm.x@0,N,transformer.11.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.12.input_norm.y@0,N,transformer.12.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.12.input_norm.dy@0,N,transformer.12.mha.dx@0,transformer.12.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.12.input_norm.y@0,
transformer.12.input_norm.dx@0,N,transformer.12.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.12.input_norm.x@0,
transformer.12.mha.x@0,N,transformer.12.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.12.mha.wqkv@0,N,transformer.12._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.12.mha.qkv@0,N,transformer.12.mha.x@0,transformer.12.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.12.mha.q@0,N,transformer.12.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.12.mha.k@0,N,transformer.12.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.12.mha.v@0,N,transformer.12.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.12.mha.attn@0,N,transformer.12.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.12.mha.wo@0,N,transformer.12._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.12.mha.o1@0,N,transformer.12.mha.attn@0,transformer.12.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.12.mha.o@0,N,transformer.12.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.12.mha.do@0,N,transformer.12.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.12.mha.o@0,
transformer.12.mha.do1@0,N,transformer.12.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.12.mha.o1@0,
transformer.12.mha.dattn@0,N,transformer.12.mha.do1@0,transformer.12._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.12.mha.dwo@0,N,transformer.12.mha.do1@0,transformer.12.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.12.mha.wo@0,
transformer.12.mha.dv@0,N,transformer.12.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.12.mha.v@0,
transformer.12.mha.dk@0,N,transformer.12.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.12.mha.k@0,
transformer.12.mha.dq@0,N,transformer.12.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.12.mha.q@0,
transformer.12.mha.dkv@0,N,transformer.12.mha.dv@0,transformer.12.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.12.mha.dqkv@0,N,transformer.12.mha.dkv@0,transformer.12.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.12.mha.qkv@0,
transformer.12.mha.dwqkv@0,N,transformer.12.mha.dqkv@0,transformer.12.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.12.mha.wqkv@0,
transformer.12.mha.dx1@0,N,transformer.12.mha.dqkv@0,transformer.12._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.12.mha.dx@0,N,transformer.12.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.12.mha.attn_kernel.q@0,N,transformer.12.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.12.mha.attn_kernel.k@0,N,transformer.12.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.12.mha.attn_kernel.v@0,N,transformer.12.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.12.mha.attn_kernel.k1@0,N,transformer.12.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.12.mha.attn_kernel.v1@0,N,transformer.12.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.12.mha.attn_kernel.qkv@0,N,transformer.12.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.12.mha.attn_kernel.k1@0"", ""transformer.12.mha.attn_kernel.v1@0""]}"
transformer.12.mha.attn_kernel.dqkv@0,N,transformer.12.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.12.mha.attn_kernel.qkv@0,
transformer.12.mha.attn_kernel.dq@0,N,transformer.12.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.12.mha.attn_kernel.q@0,
transformer.12.mha.attn_kernel.dk@0,N,transformer.12.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.12.mha.attn_kernel.dv@0,N,transformer.12.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.12.mha_res.x1@0,N,transformer.12.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.12.mha_res.x2@0,N,transformer.12.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.12.mha_res.y@0,N,transformer.12.mha_res.x1@0,transformer.12.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.12.mha_res.dy@0,N,transformer.12.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.12.mha_res.y@0,
transformer.12.mha_res.dx1@0,N,transformer.12.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.12.mha_res.x1@0,
transformer.12.mha_res.dx2@0,N,transformer.12.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.12.mha_res.x2@0,
transformer.12.post_attn_norm.x@0,N,transformer.12.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.12.post_attn_norm.y@0,N,transformer.12.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.12.post_attn_norm.dy@0,N,transformer.12.ffn.dx0@0,transformer.12.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.12.post_attn_norm.y@0,
transformer.12.post_attn_norm.dx@0,N,transformer.12.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.12.post_attn_norm.x@0,
transformer.12.ffn.x0@0,N,transformer.12.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.12.ffn.wgate@0,N,transformer.12._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.12.ffn.wdown@0,N,transformer.12._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.12.ffn.x00@0,N,transformer.12.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.12.ffn.xgate@0,N,transformer.12.ffn.x00@0,transformer.12.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.12.ffn.xdown1@0,N,transformer.12.ffn.xgate@0,transformer.12.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.12.ffn.xdown@0,N,transformer.12.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.12.ffn.dxdown@0,N,transformer.12.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.12.ffn.xdown@0,
transformer.12.ffn.dxdown2@0,N,transformer.12.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.12.ffn.dwdown@0,N,transformer.12.ffn.dxdown2@0,transformer.12.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.12.ffn.wdown@0,
transformer.12.ffn.dxgate@0,N,transformer.12.ffn.dxdown2@0,transformer.12._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.12.ffn.xgate@0,
transformer.12.ffn.x01@0,N,transformer.12.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.12.ffn.dwgate@0,N,transformer.12.ffn.dxgate@0,transformer.12.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.12.ffn.wgate@0,
transformer.12.ffn.dx000@0,N,transformer.12.ffn.dxgate@0,transformer.12._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.12.ffn.dx0@0,N,transformer.12.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.12.ffn_res.x1@0,N,transformer.12.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.12.ffn_res.x2@0,N,transformer.12.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.12.ffn_res.y@0,N,transformer.12.ffn_res.x1@0,transformer.12.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.12.ffn_res.dy@0,N,transformer.13.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.12.ffn_res.y@0,
transformer.12.ffn_res.dx1@0,N,transformer.12.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.12.ffn_res.x1@0,
transformer.12.ffn_res.dx2@0,N,transformer.12.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.12.ffn_res.x2@0,
transformer.12._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.12._assembled_weight@0,N,transformer.12._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.12._sharded_grad@0,N,transformer.12._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.12._sharded_weight@0,
transformer.12._assembled_grad@0,N,transformer.12.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.12.mha.dwo@0"", ""transformer.12.ffn.dwgate@0"", ""transformer.12.ffn.dwdown@0""]}"
transformer.12._mha.wqkv_backward@0,N,transformer.12._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.12._mha.wo_backward@0,N,transformer.12._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.12._ffn.wgate_backward@0,N,transformer.12._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.12._ffn.wdown_backward@0,N,transformer.12._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.12._assembled_weight_backward@0,N,transformer.12._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.13.input_norm.x@0,N,transformer.12.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.13.input_norm.y@0,N,transformer.13.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.13.input_norm.dy@0,N,transformer.13.mha.dx@0,transformer.13.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.13.input_norm.y@0,
transformer.13.input_norm.dx@0,N,transformer.13.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.13.input_norm.x@0,
transformer.13.mha.x@0,N,transformer.13.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.13.mha.wqkv@0,N,transformer.13._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.13.mha.qkv@0,N,transformer.13.mha.x@0,transformer.13.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.13.mha.q@0,N,transformer.13.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.13.mha.k@0,N,transformer.13.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.13.mha.v@0,N,transformer.13.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.13.mha.attn@0,N,transformer.13.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.13.mha.wo@0,N,transformer.13._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.13.mha.o1@0,N,transformer.13.mha.attn@0,transformer.13.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.13.mha.o@0,N,transformer.13.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.13.mha.do@0,N,transformer.13.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.13.mha.o@0,
transformer.13.mha.do1@0,N,transformer.13.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.13.mha.o1@0,
transformer.13.mha.dattn@0,N,transformer.13.mha.do1@0,transformer.13._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.13.mha.dwo@0,N,transformer.13.mha.do1@0,transformer.13.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.13.mha.wo@0,
transformer.13.mha.dv@0,N,transformer.13.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.13.mha.v@0,
transformer.13.mha.dk@0,N,transformer.13.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.13.mha.k@0,
transformer.13.mha.dq@0,N,transformer.13.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.13.mha.q@0,
transformer.13.mha.dkv@0,N,transformer.13.mha.dv@0,transformer.13.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.13.mha.dqkv@0,N,transformer.13.mha.dkv@0,transformer.13.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.13.mha.qkv@0,
transformer.13.mha.dwqkv@0,N,transformer.13.mha.dqkv@0,transformer.13.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.13.mha.wqkv@0,
transformer.13.mha.dx1@0,N,transformer.13.mha.dqkv@0,transformer.13._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.13.mha.dx@0,N,transformer.13.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.13.mha.attn_kernel.q@0,N,transformer.13.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.13.mha.attn_kernel.k@0,N,transformer.13.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.13.mha.attn_kernel.v@0,N,transformer.13.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.13.mha.attn_kernel.k1@0,N,transformer.13.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.13.mha.attn_kernel.v1@0,N,transformer.13.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.13.mha.attn_kernel.qkv@0,N,transformer.13.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.13.mha.attn_kernel.k1@0"", ""transformer.13.mha.attn_kernel.v1@0""]}"
transformer.13.mha.attn_kernel.dqkv@0,N,transformer.13.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.13.mha.attn_kernel.qkv@0,
transformer.13.mha.attn_kernel.dq@0,N,transformer.13.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.13.mha.attn_kernel.q@0,
transformer.13.mha.attn_kernel.dk@0,N,transformer.13.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.13.mha.attn_kernel.dv@0,N,transformer.13.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.13.mha_res.x1@0,N,transformer.13.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.13.mha_res.x2@0,N,transformer.13.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.13.mha_res.y@0,N,transformer.13.mha_res.x1@0,transformer.13.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.13.mha_res.dy@0,N,transformer.13.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.13.mha_res.y@0,
transformer.13.mha_res.dx1@0,N,transformer.13.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.13.mha_res.x1@0,
transformer.13.mha_res.dx2@0,N,transformer.13.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.13.mha_res.x2@0,
transformer.13.post_attn_norm.x@0,N,transformer.13.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.13.post_attn_norm.y@0,N,transformer.13.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.13.post_attn_norm.dy@0,N,transformer.13.ffn.dx0@0,transformer.13.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.13.post_attn_norm.y@0,
transformer.13.post_attn_norm.dx@0,N,transformer.13.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.13.post_attn_norm.x@0,
transformer.13.ffn.x0@0,N,transformer.13.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.13.ffn.wgate@0,N,transformer.13._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.13.ffn.wdown@0,N,transformer.13._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.13.ffn.x00@0,N,transformer.13.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.13.ffn.xgate@0,N,transformer.13.ffn.x00@0,transformer.13.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.13.ffn.xdown1@0,N,transformer.13.ffn.xgate@0,transformer.13.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.13.ffn.xdown@0,N,transformer.13.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.13.ffn.dxdown@0,N,transformer.13.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.13.ffn.xdown@0,
transformer.13.ffn.dxdown2@0,N,transformer.13.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.13.ffn.dwdown@0,N,transformer.13.ffn.dxdown2@0,transformer.13.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.13.ffn.wdown@0,
transformer.13.ffn.dxgate@0,N,transformer.13.ffn.dxdown2@0,transformer.13._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.13.ffn.xgate@0,
transformer.13.ffn.x01@0,N,transformer.13.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.13.ffn.dwgate@0,N,transformer.13.ffn.dxgate@0,transformer.13.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.13.ffn.wgate@0,
transformer.13.ffn.dx000@0,N,transformer.13.ffn.dxgate@0,transformer.13._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.13.ffn.dx0@0,N,transformer.13.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.13.ffn_res.x1@0,N,transformer.13.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.13.ffn_res.x2@0,N,transformer.13.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.13.ffn_res.y@0,N,transformer.13.ffn_res.x1@0,transformer.13.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.13.ffn_res.dy@0,N,transformer.14.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.13.ffn_res.y@0,
transformer.13.ffn_res.dx1@0,N,transformer.13.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.13.ffn_res.x1@0,
transformer.13.ffn_res.dx2@0,N,transformer.13.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.13.ffn_res.x2@0,
transformer.13._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.13._assembled_weight@0,N,transformer.13._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.13._sharded_grad@0,N,transformer.13._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.13._sharded_weight@0,
transformer.13._assembled_grad@0,N,transformer.13.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.13.mha.dwo@0"", ""transformer.13.ffn.dwgate@0"", ""transformer.13.ffn.dwdown@0""]}"
transformer.13._mha.wqkv_backward@0,N,transformer.13._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.13._mha.wo_backward@0,N,transformer.13._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.13._ffn.wgate_backward@0,N,transformer.13._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.13._ffn.wdown_backward@0,N,transformer.13._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.13._assembled_weight_backward@0,N,transformer.13._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.14.input_norm.x@0,N,transformer.13.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.14.input_norm.y@0,N,transformer.14.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.14.input_norm.dy@0,N,transformer.14.mha.dx@0,transformer.14.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.14.input_norm.y@0,
transformer.14.input_norm.dx@0,N,transformer.14.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.14.input_norm.x@0,
transformer.14.mha.x@0,N,transformer.14.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.14.mha.wqkv@0,N,transformer.14._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.14.mha.qkv@0,N,transformer.14.mha.x@0,transformer.14.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.14.mha.q@0,N,transformer.14.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.14.mha.k@0,N,transformer.14.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.14.mha.v@0,N,transformer.14.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.14.mha.attn@0,N,transformer.14.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.14.mha.wo@0,N,transformer.14._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.14.mha.o1@0,N,transformer.14.mha.attn@0,transformer.14.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.14.mha.o@0,N,transformer.14.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.14.mha.do@0,N,transformer.14.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.14.mha.o@0,
transformer.14.mha.do1@0,N,transformer.14.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.14.mha.o1@0,
transformer.14.mha.dattn@0,N,transformer.14.mha.do1@0,transformer.14._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.14.mha.dwo@0,N,transformer.14.mha.do1@0,transformer.14.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.14.mha.wo@0,
transformer.14.mha.dv@0,N,transformer.14.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.14.mha.v@0,
transformer.14.mha.dk@0,N,transformer.14.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.14.mha.k@0,
transformer.14.mha.dq@0,N,transformer.14.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.14.mha.q@0,
transformer.14.mha.dkv@0,N,transformer.14.mha.dv@0,transformer.14.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.14.mha.dqkv@0,N,transformer.14.mha.dkv@0,transformer.14.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.14.mha.qkv@0,
transformer.14.mha.dwqkv@0,N,transformer.14.mha.dqkv@0,transformer.14.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.14.mha.wqkv@0,
transformer.14.mha.dx1@0,N,transformer.14.mha.dqkv@0,transformer.14._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.14.mha.dx@0,N,transformer.14.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.14.mha.attn_kernel.q@0,N,transformer.14.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.14.mha.attn_kernel.k@0,N,transformer.14.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.14.mha.attn_kernel.v@0,N,transformer.14.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.14.mha.attn_kernel.k1@0,N,transformer.14.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.14.mha.attn_kernel.v1@0,N,transformer.14.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.14.mha.attn_kernel.qkv@0,N,transformer.14.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.14.mha.attn_kernel.k1@0"", ""transformer.14.mha.attn_kernel.v1@0""]}"
transformer.14.mha.attn_kernel.dqkv@0,N,transformer.14.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.14.mha.attn_kernel.qkv@0,
transformer.14.mha.attn_kernel.dq@0,N,transformer.14.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.14.mha.attn_kernel.q@0,
transformer.14.mha.attn_kernel.dk@0,N,transformer.14.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.14.mha.attn_kernel.dv@0,N,transformer.14.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.14.mha_res.x1@0,N,transformer.14.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.14.mha_res.x2@0,N,transformer.14.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.14.mha_res.y@0,N,transformer.14.mha_res.x1@0,transformer.14.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.14.mha_res.dy@0,N,transformer.14.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.14.mha_res.y@0,
transformer.14.mha_res.dx1@0,N,transformer.14.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.14.mha_res.x1@0,
transformer.14.mha_res.dx2@0,N,transformer.14.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.14.mha_res.x2@0,
transformer.14.post_attn_norm.x@0,N,transformer.14.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.14.post_attn_norm.y@0,N,transformer.14.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.14.post_attn_norm.dy@0,N,transformer.14.ffn.dx0@0,transformer.14.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.14.post_attn_norm.y@0,
transformer.14.post_attn_norm.dx@0,N,transformer.14.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.14.post_attn_norm.x@0,
transformer.14.ffn.x0@0,N,transformer.14.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.14.ffn.wgate@0,N,transformer.14._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.14.ffn.wdown@0,N,transformer.14._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.14.ffn.x00@0,N,transformer.14.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.14.ffn.xgate@0,N,transformer.14.ffn.x00@0,transformer.14.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.14.ffn.xdown1@0,N,transformer.14.ffn.xgate@0,transformer.14.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.14.ffn.xdown@0,N,transformer.14.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.14.ffn.dxdown@0,N,transformer.14.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.14.ffn.xdown@0,
transformer.14.ffn.dxdown2@0,N,transformer.14.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.14.ffn.dwdown@0,N,transformer.14.ffn.dxdown2@0,transformer.14.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.14.ffn.wdown@0,
transformer.14.ffn.dxgate@0,N,transformer.14.ffn.dxdown2@0,transformer.14._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.14.ffn.xgate@0,
transformer.14.ffn.x01@0,N,transformer.14.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.14.ffn.dwgate@0,N,transformer.14.ffn.dxgate@0,transformer.14.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.14.ffn.wgate@0,
transformer.14.ffn.dx000@0,N,transformer.14.ffn.dxgate@0,transformer.14._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.14.ffn.dx0@0,N,transformer.14.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.14.ffn_res.x1@0,N,transformer.14.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.14.ffn_res.x2@0,N,transformer.14.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.14.ffn_res.y@0,N,transformer.14.ffn_res.x1@0,transformer.14.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.14.ffn_res.dy@0,N,transformer.15.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.14.ffn_res.y@0,
transformer.14.ffn_res.dx1@0,N,transformer.14.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.14.ffn_res.x1@0,
transformer.14.ffn_res.dx2@0,N,transformer.14.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.14.ffn_res.x2@0,
transformer.14._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.14._assembled_weight@0,N,transformer.14._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.14._sharded_grad@0,N,transformer.14._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.14._sharded_weight@0,
transformer.14._assembled_grad@0,N,transformer.14.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.14.mha.dwo@0"", ""transformer.14.ffn.dwgate@0"", ""transformer.14.ffn.dwdown@0""]}"
transformer.14._mha.wqkv_backward@0,N,transformer.14._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.14._mha.wo_backward@0,N,transformer.14._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.14._ffn.wgate_backward@0,N,transformer.14._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.14._ffn.wdown_backward@0,N,transformer.14._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.14._assembled_weight_backward@0,N,transformer.14._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.15.input_norm.x@0,N,transformer.14.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.15.input_norm.y@0,N,transformer.15.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.15.input_norm.dy@0,N,transformer.15.mha.dx@0,transformer.15.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.15.input_norm.y@0,
transformer.15.input_norm.dx@0,N,transformer.15.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.15.input_norm.x@0,
transformer.15.mha.x@0,N,transformer.15.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.15.mha.wqkv@0,N,transformer.15._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.15.mha.qkv@0,N,transformer.15.mha.x@0,transformer.15.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.15.mha.q@0,N,transformer.15.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.15.mha.k@0,N,transformer.15.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.15.mha.v@0,N,transformer.15.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.15.mha.attn@0,N,transformer.15.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.15.mha.wo@0,N,transformer.15._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.15.mha.o1@0,N,transformer.15.mha.attn@0,transformer.15.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.15.mha.o@0,N,transformer.15.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.15.mha.do@0,N,transformer.15.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.15.mha.o@0,
transformer.15.mha.do1@0,N,transformer.15.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.15.mha.o1@0,
transformer.15.mha.dattn@0,N,transformer.15.mha.do1@0,transformer.15._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.15.mha.dwo@0,N,transformer.15.mha.do1@0,transformer.15.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.15.mha.wo@0,
transformer.15.mha.dv@0,N,transformer.15.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.15.mha.v@0,
transformer.15.mha.dk@0,N,transformer.15.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.15.mha.k@0,
transformer.15.mha.dq@0,N,transformer.15.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.15.mha.q@0,
transformer.15.mha.dkv@0,N,transformer.15.mha.dv@0,transformer.15.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.15.mha.dqkv@0,N,transformer.15.mha.dkv@0,transformer.15.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.15.mha.qkv@0,
transformer.15.mha.dwqkv@0,N,transformer.15.mha.dqkv@0,transformer.15.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.15.mha.wqkv@0,
transformer.15.mha.dx1@0,N,transformer.15.mha.dqkv@0,transformer.15._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.15.mha.dx@0,N,transformer.15.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.15.mha.attn_kernel.q@0,N,transformer.15.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.15.mha.attn_kernel.k@0,N,transformer.15.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.15.mha.attn_kernel.v@0,N,transformer.15.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.15.mha.attn_kernel.k1@0,N,transformer.15.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.15.mha.attn_kernel.v1@0,N,transformer.15.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.15.mha.attn_kernel.qkv@0,N,transformer.15.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.15.mha.attn_kernel.k1@0"", ""transformer.15.mha.attn_kernel.v1@0""]}"
transformer.15.mha.attn_kernel.dqkv@0,N,transformer.15.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.15.mha.attn_kernel.qkv@0,
transformer.15.mha.attn_kernel.dq@0,N,transformer.15.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.15.mha.attn_kernel.q@0,
transformer.15.mha.attn_kernel.dk@0,N,transformer.15.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.15.mha.attn_kernel.dv@0,N,transformer.15.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.15.mha_res.x1@0,N,transformer.15.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.15.mha_res.x2@0,N,transformer.15.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.15.mha_res.y@0,N,transformer.15.mha_res.x1@0,transformer.15.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.15.mha_res.dy@0,N,transformer.15.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.15.mha_res.y@0,
transformer.15.mha_res.dx1@0,N,transformer.15.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.15.mha_res.x1@0,
transformer.15.mha_res.dx2@0,N,transformer.15.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.15.mha_res.x2@0,
transformer.15.post_attn_norm.x@0,N,transformer.15.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.15.post_attn_norm.y@0,N,transformer.15.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.15.post_attn_norm.dy@0,N,transformer.15.ffn.dx0@0,transformer.15.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.15.post_attn_norm.y@0,
transformer.15.post_attn_norm.dx@0,N,transformer.15.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.15.post_attn_norm.x@0,
transformer.15.ffn.x0@0,N,transformer.15.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.15.ffn.wgate@0,N,transformer.15._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.15.ffn.wdown@0,N,transformer.15._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.15.ffn.x00@0,N,transformer.15.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.15.ffn.xgate@0,N,transformer.15.ffn.x00@0,transformer.15.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.15.ffn.xdown1@0,N,transformer.15.ffn.xgate@0,transformer.15.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.15.ffn.xdown@0,N,transformer.15.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.15.ffn.dxdown@0,N,transformer.15.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.15.ffn.xdown@0,
transformer.15.ffn.dxdown2@0,N,transformer.15.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.15.ffn.dwdown@0,N,transformer.15.ffn.dxdown2@0,transformer.15.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.15.ffn.wdown@0,
transformer.15.ffn.dxgate@0,N,transformer.15.ffn.dxdown2@0,transformer.15._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.15.ffn.xgate@0,
transformer.15.ffn.x01@0,N,transformer.15.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.15.ffn.dwgate@0,N,transformer.15.ffn.dxgate@0,transformer.15.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.15.ffn.wgate@0,
transformer.15.ffn.dx000@0,N,transformer.15.ffn.dxgate@0,transformer.15._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.15.ffn.dx0@0,N,transformer.15.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.15.ffn_res.x1@0,N,transformer.15.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.15.ffn_res.x2@0,N,transformer.15.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.15.ffn_res.y@0,N,transformer.15.ffn_res.x1@0,transformer.15.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.15.ffn_res.dy@0,N,transformer.16.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.15.ffn_res.y@0,
transformer.15.ffn_res.dx1@0,N,transformer.15.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.15.ffn_res.x1@0,
transformer.15.ffn_res.dx2@0,N,transformer.15.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.15.ffn_res.x2@0,
transformer.15._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.15._assembled_weight@0,N,transformer.15._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.15._sharded_grad@0,N,transformer.15._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.15._sharded_weight@0,
transformer.15._assembled_grad@0,N,transformer.15.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.15.mha.dwo@0"", ""transformer.15.ffn.dwgate@0"", ""transformer.15.ffn.dwdown@0""]}"
transformer.15._mha.wqkv_backward@0,N,transformer.15._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.15._mha.wo_backward@0,N,transformer.15._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.15._ffn.wgate_backward@0,N,transformer.15._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.15._ffn.wdown_backward@0,N,transformer.15._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.15._assembled_weight_backward@0,N,transformer.15._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.16.input_norm.x@0,N,transformer.15.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.16.input_norm.y@0,N,transformer.16.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.16.input_norm.dy@0,N,transformer.16.mha.dx@0,transformer.16.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.16.input_norm.y@0,
transformer.16.input_norm.dx@0,N,transformer.16.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.16.input_norm.x@0,
transformer.16.mha.x@0,N,transformer.16.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.16.mha.wqkv@0,N,transformer.16._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.16.mha.qkv@0,N,transformer.16.mha.x@0,transformer.16.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.16.mha.q@0,N,transformer.16.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.16.mha.k@0,N,transformer.16.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.16.mha.v@0,N,transformer.16.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.16.mha.attn@0,N,transformer.16.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.16.mha.wo@0,N,transformer.16._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.16.mha.o1@0,N,transformer.16.mha.attn@0,transformer.16.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.16.mha.o@0,N,transformer.16.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.16.mha.do@0,N,transformer.16.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.16.mha.o@0,
transformer.16.mha.do1@0,N,transformer.16.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.16.mha.o1@0,
transformer.16.mha.dattn@0,N,transformer.16.mha.do1@0,transformer.16._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.16.mha.dwo@0,N,transformer.16.mha.do1@0,transformer.16.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.16.mha.wo@0,
transformer.16.mha.dv@0,N,transformer.16.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.16.mha.v@0,
transformer.16.mha.dk@0,N,transformer.16.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.16.mha.k@0,
transformer.16.mha.dq@0,N,transformer.16.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.16.mha.q@0,
transformer.16.mha.dkv@0,N,transformer.16.mha.dv@0,transformer.16.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.16.mha.dqkv@0,N,transformer.16.mha.dkv@0,transformer.16.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.16.mha.qkv@0,
transformer.16.mha.dwqkv@0,N,transformer.16.mha.dqkv@0,transformer.16.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.16.mha.wqkv@0,
transformer.16.mha.dx1@0,N,transformer.16.mha.dqkv@0,transformer.16._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.16.mha.dx@0,N,transformer.16.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.16.mha.attn_kernel.q@0,N,transformer.16.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.16.mha.attn_kernel.k@0,N,transformer.16.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.16.mha.attn_kernel.v@0,N,transformer.16.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.16.mha.attn_kernel.k1@0,N,transformer.16.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.16.mha.attn_kernel.v1@0,N,transformer.16.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.16.mha.attn_kernel.qkv@0,N,transformer.16.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.16.mha.attn_kernel.k1@0"", ""transformer.16.mha.attn_kernel.v1@0""]}"
transformer.16.mha.attn_kernel.dqkv@0,N,transformer.16.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.16.mha.attn_kernel.qkv@0,
transformer.16.mha.attn_kernel.dq@0,N,transformer.16.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.16.mha.attn_kernel.q@0,
transformer.16.mha.attn_kernel.dk@0,N,transformer.16.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.16.mha.attn_kernel.dv@0,N,transformer.16.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.16.mha_res.x1@0,N,transformer.16.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.16.mha_res.x2@0,N,transformer.16.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.16.mha_res.y@0,N,transformer.16.mha_res.x1@0,transformer.16.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.16.mha_res.dy@0,N,transformer.16.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.16.mha_res.y@0,
transformer.16.mha_res.dx1@0,N,transformer.16.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.16.mha_res.x1@0,
transformer.16.mha_res.dx2@0,N,transformer.16.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.16.mha_res.x2@0,
transformer.16.post_attn_norm.x@0,N,transformer.16.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.16.post_attn_norm.y@0,N,transformer.16.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.16.post_attn_norm.dy@0,N,transformer.16.ffn.dx0@0,transformer.16.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.16.post_attn_norm.y@0,
transformer.16.post_attn_norm.dx@0,N,transformer.16.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.16.post_attn_norm.x@0,
transformer.16.ffn.x0@0,N,transformer.16.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.16.ffn.wgate@0,N,transformer.16._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.16.ffn.wdown@0,N,transformer.16._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.16.ffn.x00@0,N,transformer.16.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.16.ffn.xgate@0,N,transformer.16.ffn.x00@0,transformer.16.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.16.ffn.xdown1@0,N,transformer.16.ffn.xgate@0,transformer.16.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.16.ffn.xdown@0,N,transformer.16.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.16.ffn.dxdown@0,N,transformer.16.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.16.ffn.xdown@0,
transformer.16.ffn.dxdown2@0,N,transformer.16.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.16.ffn.dwdown@0,N,transformer.16.ffn.dxdown2@0,transformer.16.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.16.ffn.wdown@0,
transformer.16.ffn.dxgate@0,N,transformer.16.ffn.dxdown2@0,transformer.16._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.16.ffn.xgate@0,
transformer.16.ffn.x01@0,N,transformer.16.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.16.ffn.dwgate@0,N,transformer.16.ffn.dxgate@0,transformer.16.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.16.ffn.wgate@0,
transformer.16.ffn.dx000@0,N,transformer.16.ffn.dxgate@0,transformer.16._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.16.ffn.dx0@0,N,transformer.16.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.16.ffn_res.x1@0,N,transformer.16.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.16.ffn_res.x2@0,N,transformer.16.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.16.ffn_res.y@0,N,transformer.16.ffn_res.x1@0,transformer.16.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.16.ffn_res.dy@0,N,transformer.17.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.16.ffn_res.y@0,
transformer.16.ffn_res.dx1@0,N,transformer.16.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.16.ffn_res.x1@0,
transformer.16.ffn_res.dx2@0,N,transformer.16.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.16.ffn_res.x2@0,
transformer.16._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.16._assembled_weight@0,N,transformer.16._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.16._sharded_grad@0,N,transformer.16._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.16._sharded_weight@0,
transformer.16._assembled_grad@0,N,transformer.16.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.16.mha.dwo@0"", ""transformer.16.ffn.dwgate@0"", ""transformer.16.ffn.dwdown@0""]}"
transformer.16._mha.wqkv_backward@0,N,transformer.16._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.16._mha.wo_backward@0,N,transformer.16._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.16._ffn.wgate_backward@0,N,transformer.16._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.16._ffn.wdown_backward@0,N,transformer.16._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.16._assembled_weight_backward@0,N,transformer.16._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.17.input_norm.x@0,N,transformer.16.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.17.input_norm.y@0,N,transformer.17.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.17.input_norm.dy@0,N,transformer.17.mha.dx@0,transformer.17.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.17.input_norm.y@0,
transformer.17.input_norm.dx@0,N,transformer.17.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.17.input_norm.x@0,
transformer.17.mha.x@0,N,transformer.17.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.17.mha.wqkv@0,N,transformer.17._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.17.mha.qkv@0,N,transformer.17.mha.x@0,transformer.17.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.17.mha.q@0,N,transformer.17.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.17.mha.k@0,N,transformer.17.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.17.mha.v@0,N,transformer.17.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.17.mha.attn@0,N,transformer.17.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.17.mha.wo@0,N,transformer.17._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.17.mha.o1@0,N,transformer.17.mha.attn@0,transformer.17.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.17.mha.o@0,N,transformer.17.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.17.mha.do@0,N,transformer.17.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.17.mha.o@0,
transformer.17.mha.do1@0,N,transformer.17.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.17.mha.o1@0,
transformer.17.mha.dattn@0,N,transformer.17.mha.do1@0,transformer.17._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.17.mha.dwo@0,N,transformer.17.mha.do1@0,transformer.17.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.17.mha.wo@0,
transformer.17.mha.dv@0,N,transformer.17.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.17.mha.v@0,
transformer.17.mha.dk@0,N,transformer.17.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.17.mha.k@0,
transformer.17.mha.dq@0,N,transformer.17.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.17.mha.q@0,
transformer.17.mha.dkv@0,N,transformer.17.mha.dv@0,transformer.17.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.17.mha.dqkv@0,N,transformer.17.mha.dkv@0,transformer.17.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.17.mha.qkv@0,
transformer.17.mha.dwqkv@0,N,transformer.17.mha.dqkv@0,transformer.17.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.17.mha.wqkv@0,
transformer.17.mha.dx1@0,N,transformer.17.mha.dqkv@0,transformer.17._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.17.mha.dx@0,N,transformer.17.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.17.mha.attn_kernel.q@0,N,transformer.17.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.17.mha.attn_kernel.k@0,N,transformer.17.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.17.mha.attn_kernel.v@0,N,transformer.17.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.17.mha.attn_kernel.k1@0,N,transformer.17.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.17.mha.attn_kernel.v1@0,N,transformer.17.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.17.mha.attn_kernel.qkv@0,N,transformer.17.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.17.mha.attn_kernel.k1@0"", ""transformer.17.mha.attn_kernel.v1@0""]}"
transformer.17.mha.attn_kernel.dqkv@0,N,transformer.17.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.17.mha.attn_kernel.qkv@0,
transformer.17.mha.attn_kernel.dq@0,N,transformer.17.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.17.mha.attn_kernel.q@0,
transformer.17.mha.attn_kernel.dk@0,N,transformer.17.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.17.mha.attn_kernel.dv@0,N,transformer.17.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.17.mha_res.x1@0,N,transformer.17.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.17.mha_res.x2@0,N,transformer.17.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.17.mha_res.y@0,N,transformer.17.mha_res.x1@0,transformer.17.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.17.mha_res.dy@0,N,transformer.17.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.17.mha_res.y@0,
transformer.17.mha_res.dx1@0,N,transformer.17.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.17.mha_res.x1@0,
transformer.17.mha_res.dx2@0,N,transformer.17.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.17.mha_res.x2@0,
transformer.17.post_attn_norm.x@0,N,transformer.17.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.17.post_attn_norm.y@0,N,transformer.17.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.17.post_attn_norm.dy@0,N,transformer.17.ffn.dx0@0,transformer.17.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.17.post_attn_norm.y@0,
transformer.17.post_attn_norm.dx@0,N,transformer.17.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.17.post_attn_norm.x@0,
transformer.17.ffn.x0@0,N,transformer.17.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.17.ffn.wgate@0,N,transformer.17._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.17.ffn.wdown@0,N,transformer.17._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.17.ffn.x00@0,N,transformer.17.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.17.ffn.xgate@0,N,transformer.17.ffn.x00@0,transformer.17.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.17.ffn.xdown1@0,N,transformer.17.ffn.xgate@0,transformer.17.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.17.ffn.xdown@0,N,transformer.17.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.17.ffn.dxdown@0,N,transformer.17.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.17.ffn.xdown@0,
transformer.17.ffn.dxdown2@0,N,transformer.17.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.17.ffn.dwdown@0,N,transformer.17.ffn.dxdown2@0,transformer.17.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.17.ffn.wdown@0,
transformer.17.ffn.dxgate@0,N,transformer.17.ffn.dxdown2@0,transformer.17._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.17.ffn.xgate@0,
transformer.17.ffn.x01@0,N,transformer.17.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.17.ffn.dwgate@0,N,transformer.17.ffn.dxgate@0,transformer.17.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.17.ffn.wgate@0,
transformer.17.ffn.dx000@0,N,transformer.17.ffn.dxgate@0,transformer.17._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.17.ffn.dx0@0,N,transformer.17.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.17.ffn_res.x1@0,N,transformer.17.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.17.ffn_res.x2@0,N,transformer.17.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.17.ffn_res.y@0,N,transformer.17.ffn_res.x1@0,transformer.17.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.17.ffn_res.dy@0,N,transformer.18.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.17.ffn_res.y@0,
transformer.17.ffn_res.dx1@0,N,transformer.17.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.17.ffn_res.x1@0,
transformer.17.ffn_res.dx2@0,N,transformer.17.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.17.ffn_res.x2@0,
transformer.17._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.17._assembled_weight@0,N,transformer.17._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.17._sharded_grad@0,N,transformer.17._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.17._sharded_weight@0,
transformer.17._assembled_grad@0,N,transformer.17.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.17.mha.dwo@0"", ""transformer.17.ffn.dwgate@0"", ""transformer.17.ffn.dwdown@0""]}"
transformer.17._mha.wqkv_backward@0,N,transformer.17._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.17._mha.wo_backward@0,N,transformer.17._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.17._ffn.wgate_backward@0,N,transformer.17._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.17._ffn.wdown_backward@0,N,transformer.17._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.17._assembled_weight_backward@0,N,transformer.17._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.18.input_norm.x@0,N,transformer.17.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.18.input_norm.y@0,N,transformer.18.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.18.input_norm.dy@0,N,transformer.18.mha.dx@0,transformer.18.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.18.input_norm.y@0,
transformer.18.input_norm.dx@0,N,transformer.18.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.18.input_norm.x@0,
transformer.18.mha.x@0,N,transformer.18.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.18.mha.wqkv@0,N,transformer.18._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.18.mha.qkv@0,N,transformer.18.mha.x@0,transformer.18.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.18.mha.q@0,N,transformer.18.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.18.mha.k@0,N,transformer.18.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.18.mha.v@0,N,transformer.18.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.18.mha.attn@0,N,transformer.18.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.18.mha.wo@0,N,transformer.18._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.18.mha.o1@0,N,transformer.18.mha.attn@0,transformer.18.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.18.mha.o@0,N,transformer.18.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.18.mha.do@0,N,transformer.18.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.18.mha.o@0,
transformer.18.mha.do1@0,N,transformer.18.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.18.mha.o1@0,
transformer.18.mha.dattn@0,N,transformer.18.mha.do1@0,transformer.18._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.18.mha.dwo@0,N,transformer.18.mha.do1@0,transformer.18.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.18.mha.wo@0,
transformer.18.mha.dv@0,N,transformer.18.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.18.mha.v@0,
transformer.18.mha.dk@0,N,transformer.18.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.18.mha.k@0,
transformer.18.mha.dq@0,N,transformer.18.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.18.mha.q@0,
transformer.18.mha.dkv@0,N,transformer.18.mha.dv@0,transformer.18.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.18.mha.dqkv@0,N,transformer.18.mha.dkv@0,transformer.18.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.18.mha.qkv@0,
transformer.18.mha.dwqkv@0,N,transformer.18.mha.dqkv@0,transformer.18.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.18.mha.wqkv@0,
transformer.18.mha.dx1@0,N,transformer.18.mha.dqkv@0,transformer.18._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.18.mha.dx@0,N,transformer.18.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.18.mha.attn_kernel.q@0,N,transformer.18.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.18.mha.attn_kernel.k@0,N,transformer.18.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.18.mha.attn_kernel.v@0,N,transformer.18.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.18.mha.attn_kernel.k1@0,N,transformer.18.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.18.mha.attn_kernel.v1@0,N,transformer.18.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.18.mha.attn_kernel.qkv@0,N,transformer.18.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.18.mha.attn_kernel.k1@0"", ""transformer.18.mha.attn_kernel.v1@0""]}"
transformer.18.mha.attn_kernel.dqkv@0,N,transformer.18.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.18.mha.attn_kernel.qkv@0,
transformer.18.mha.attn_kernel.dq@0,N,transformer.18.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.18.mha.attn_kernel.q@0,
transformer.18.mha.attn_kernel.dk@0,N,transformer.18.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.18.mha.attn_kernel.dv@0,N,transformer.18.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.18.mha_res.x1@0,N,transformer.18.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.18.mha_res.x2@0,N,transformer.18.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.18.mha_res.y@0,N,transformer.18.mha_res.x1@0,transformer.18.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.18.mha_res.dy@0,N,transformer.18.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.18.mha_res.y@0,
transformer.18.mha_res.dx1@0,N,transformer.18.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.18.mha_res.x1@0,
transformer.18.mha_res.dx2@0,N,transformer.18.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.18.mha_res.x2@0,
transformer.18.post_attn_norm.x@0,N,transformer.18.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.18.post_attn_norm.y@0,N,transformer.18.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.18.post_attn_norm.dy@0,N,transformer.18.ffn.dx0@0,transformer.18.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.18.post_attn_norm.y@0,
transformer.18.post_attn_norm.dx@0,N,transformer.18.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.18.post_attn_norm.x@0,
transformer.18.ffn.x0@0,N,transformer.18.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.18.ffn.wgate@0,N,transformer.18._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.18.ffn.wdown@0,N,transformer.18._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.18.ffn.x00@0,N,transformer.18.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.18.ffn.xgate@0,N,transformer.18.ffn.x00@0,transformer.18.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.18.ffn.xdown1@0,N,transformer.18.ffn.xgate@0,transformer.18.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.18.ffn.xdown@0,N,transformer.18.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.18.ffn.dxdown@0,N,transformer.18.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.18.ffn.xdown@0,
transformer.18.ffn.dxdown2@0,N,transformer.18.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.18.ffn.dwdown@0,N,transformer.18.ffn.dxdown2@0,transformer.18.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.18.ffn.wdown@0,
transformer.18.ffn.dxgate@0,N,transformer.18.ffn.dxdown2@0,transformer.18._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.18.ffn.xgate@0,
transformer.18.ffn.x01@0,N,transformer.18.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.18.ffn.dwgate@0,N,transformer.18.ffn.dxgate@0,transformer.18.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.18.ffn.wgate@0,
transformer.18.ffn.dx000@0,N,transformer.18.ffn.dxgate@0,transformer.18._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.18.ffn.dx0@0,N,transformer.18.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.18.ffn_res.x1@0,N,transformer.18.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.18.ffn_res.x2@0,N,transformer.18.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.18.ffn_res.y@0,N,transformer.18.ffn_res.x1@0,transformer.18.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.18.ffn_res.dy@0,N,transformer.19.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.18.ffn_res.y@0,
transformer.18.ffn_res.dx1@0,N,transformer.18.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.18.ffn_res.x1@0,
transformer.18.ffn_res.dx2@0,N,transformer.18.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.18.ffn_res.x2@0,
transformer.18._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.18._assembled_weight@0,N,transformer.18._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.18._sharded_grad@0,N,transformer.18._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.18._sharded_weight@0,
transformer.18._assembled_grad@0,N,transformer.18.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.18.mha.dwo@0"", ""transformer.18.ffn.dwgate@0"", ""transformer.18.ffn.dwdown@0""]}"
transformer.18._mha.wqkv_backward@0,N,transformer.18._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.18._mha.wo_backward@0,N,transformer.18._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.18._ffn.wgate_backward@0,N,transformer.18._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.18._ffn.wdown_backward@0,N,transformer.18._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.18._assembled_weight_backward@0,N,transformer.18._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.19.input_norm.x@0,N,transformer.18.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.19.input_norm.y@0,N,transformer.19.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.19.input_norm.dy@0,N,transformer.19.mha.dx@0,transformer.19.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.19.input_norm.y@0,
transformer.19.input_norm.dx@0,N,transformer.19.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.19.input_norm.x@0,
transformer.19.mha.x@0,N,transformer.19.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.19.mha.wqkv@0,N,transformer.19._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.19.mha.qkv@0,N,transformer.19.mha.x@0,transformer.19.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.19.mha.q@0,N,transformer.19.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.19.mha.k@0,N,transformer.19.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.19.mha.v@0,N,transformer.19.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.19.mha.attn@0,N,transformer.19.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.19.mha.wo@0,N,transformer.19._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.19.mha.o1@0,N,transformer.19.mha.attn@0,transformer.19.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.19.mha.o@0,N,transformer.19.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.19.mha.do@0,N,transformer.19.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.19.mha.o@0,
transformer.19.mha.do1@0,N,transformer.19.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.19.mha.o1@0,
transformer.19.mha.dattn@0,N,transformer.19.mha.do1@0,transformer.19._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.19.mha.dwo@0,N,transformer.19.mha.do1@0,transformer.19.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.19.mha.wo@0,
transformer.19.mha.dv@0,N,transformer.19.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.19.mha.v@0,
transformer.19.mha.dk@0,N,transformer.19.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.19.mha.k@0,
transformer.19.mha.dq@0,N,transformer.19.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.19.mha.q@0,
transformer.19.mha.dkv@0,N,transformer.19.mha.dv@0,transformer.19.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.19.mha.dqkv@0,N,transformer.19.mha.dkv@0,transformer.19.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.19.mha.qkv@0,
transformer.19.mha.dwqkv@0,N,transformer.19.mha.dqkv@0,transformer.19.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.19.mha.wqkv@0,
transformer.19.mha.dx1@0,N,transformer.19.mha.dqkv@0,transformer.19._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.19.mha.dx@0,N,transformer.19.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.19.mha.attn_kernel.q@0,N,transformer.19.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.19.mha.attn_kernel.k@0,N,transformer.19.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.19.mha.attn_kernel.v@0,N,transformer.19.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.19.mha.attn_kernel.k1@0,N,transformer.19.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.19.mha.attn_kernel.v1@0,N,transformer.19.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.19.mha.attn_kernel.qkv@0,N,transformer.19.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.19.mha.attn_kernel.k1@0"", ""transformer.19.mha.attn_kernel.v1@0""]}"
transformer.19.mha.attn_kernel.dqkv@0,N,transformer.19.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.19.mha.attn_kernel.qkv@0,
transformer.19.mha.attn_kernel.dq@0,N,transformer.19.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.19.mha.attn_kernel.q@0,
transformer.19.mha.attn_kernel.dk@0,N,transformer.19.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.19.mha.attn_kernel.dv@0,N,transformer.19.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.19.mha_res.x1@0,N,transformer.19.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.19.mha_res.x2@0,N,transformer.19.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.19.mha_res.y@0,N,transformer.19.mha_res.x1@0,transformer.19.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.19.mha_res.dy@0,N,transformer.19.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.19.mha_res.y@0,
transformer.19.mha_res.dx1@0,N,transformer.19.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.19.mha_res.x1@0,
transformer.19.mha_res.dx2@0,N,transformer.19.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.19.mha_res.x2@0,
transformer.19.post_attn_norm.x@0,N,transformer.19.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.19.post_attn_norm.y@0,N,transformer.19.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.19.post_attn_norm.dy@0,N,transformer.19.ffn.dx0@0,transformer.19.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.19.post_attn_norm.y@0,
transformer.19.post_attn_norm.dx@0,N,transformer.19.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.19.post_attn_norm.x@0,
transformer.19.ffn.x0@0,N,transformer.19.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.19.ffn.wgate@0,N,transformer.19._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.19.ffn.wdown@0,N,transformer.19._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.19.ffn.x00@0,N,transformer.19.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.19.ffn.xgate@0,N,transformer.19.ffn.x00@0,transformer.19.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.19.ffn.xdown1@0,N,transformer.19.ffn.xgate@0,transformer.19.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.19.ffn.xdown@0,N,transformer.19.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.19.ffn.dxdown@0,N,transformer.19.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.19.ffn.xdown@0,
transformer.19.ffn.dxdown2@0,N,transformer.19.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.19.ffn.dwdown@0,N,transformer.19.ffn.dxdown2@0,transformer.19.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.19.ffn.wdown@0,
transformer.19.ffn.dxgate@0,N,transformer.19.ffn.dxdown2@0,transformer.19._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.19.ffn.xgate@0,
transformer.19.ffn.x01@0,N,transformer.19.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.19.ffn.dwgate@0,N,transformer.19.ffn.dxgate@0,transformer.19.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.19.ffn.wgate@0,
transformer.19.ffn.dx000@0,N,transformer.19.ffn.dxgate@0,transformer.19._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.19.ffn.dx0@0,N,transformer.19.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.19.ffn_res.x1@0,N,transformer.19.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.19.ffn_res.x2@0,N,transformer.19.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.19.ffn_res.y@0,N,transformer.19.ffn_res.x1@0,transformer.19.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.19.ffn_res.dy@0,N,transformer.20.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.19.ffn_res.y@0,
transformer.19.ffn_res.dx1@0,N,transformer.19.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.19.ffn_res.x1@0,
transformer.19.ffn_res.dx2@0,N,transformer.19.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.19.ffn_res.x2@0,
transformer.19._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.19._assembled_weight@0,N,transformer.19._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.19._sharded_grad@0,N,transformer.19._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.19._sharded_weight@0,
transformer.19._assembled_grad@0,N,transformer.19.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.19.mha.dwo@0"", ""transformer.19.ffn.dwgate@0"", ""transformer.19.ffn.dwdown@0""]}"
transformer.19._mha.wqkv_backward@0,N,transformer.19._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.19._mha.wo_backward@0,N,transformer.19._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.19._ffn.wgate_backward@0,N,transformer.19._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.19._ffn.wdown_backward@0,N,transformer.19._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.19._assembled_weight_backward@0,N,transformer.19._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.20.input_norm.x@0,N,transformer.19.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.20.input_norm.y@0,N,transformer.20.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.20.input_norm.dy@0,N,transformer.20.mha.dx@0,transformer.20.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.20.input_norm.y@0,
transformer.20.input_norm.dx@0,N,transformer.20.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.20.input_norm.x@0,
transformer.20.mha.x@0,N,transformer.20.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.20.mha.wqkv@0,N,transformer.20._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.20.mha.qkv@0,N,transformer.20.mha.x@0,transformer.20.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.20.mha.q@0,N,transformer.20.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.20.mha.k@0,N,transformer.20.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.20.mha.v@0,N,transformer.20.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.20.mha.attn@0,N,transformer.20.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.20.mha.wo@0,N,transformer.20._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.20.mha.o1@0,N,transformer.20.mha.attn@0,transformer.20.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.20.mha.o@0,N,transformer.20.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.20.mha.do@0,N,transformer.20.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.20.mha.o@0,
transformer.20.mha.do1@0,N,transformer.20.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.20.mha.o1@0,
transformer.20.mha.dattn@0,N,transformer.20.mha.do1@0,transformer.20._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.20.mha.dwo@0,N,transformer.20.mha.do1@0,transformer.20.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.20.mha.wo@0,
transformer.20.mha.dv@0,N,transformer.20.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.20.mha.v@0,
transformer.20.mha.dk@0,N,transformer.20.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.20.mha.k@0,
transformer.20.mha.dq@0,N,transformer.20.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.20.mha.q@0,
transformer.20.mha.dkv@0,N,transformer.20.mha.dv@0,transformer.20.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.20.mha.dqkv@0,N,transformer.20.mha.dkv@0,transformer.20.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.20.mha.qkv@0,
transformer.20.mha.dwqkv@0,N,transformer.20.mha.dqkv@0,transformer.20.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.20.mha.wqkv@0,
transformer.20.mha.dx1@0,N,transformer.20.mha.dqkv@0,transformer.20._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.20.mha.dx@0,N,transformer.20.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.20.mha.attn_kernel.q@0,N,transformer.20.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.20.mha.attn_kernel.k@0,N,transformer.20.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.20.mha.attn_kernel.v@0,N,transformer.20.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.20.mha.attn_kernel.k1@0,N,transformer.20.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.20.mha.attn_kernel.v1@0,N,transformer.20.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.20.mha.attn_kernel.qkv@0,N,transformer.20.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.20.mha.attn_kernel.k1@0"", ""transformer.20.mha.attn_kernel.v1@0""]}"
transformer.20.mha.attn_kernel.dqkv@0,N,transformer.20.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.20.mha.attn_kernel.qkv@0,
transformer.20.mha.attn_kernel.dq@0,N,transformer.20.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.20.mha.attn_kernel.q@0,
transformer.20.mha.attn_kernel.dk@0,N,transformer.20.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.20.mha.attn_kernel.dv@0,N,transformer.20.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.20.mha_res.x1@0,N,transformer.20.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.20.mha_res.x2@0,N,transformer.20.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.20.mha_res.y@0,N,transformer.20.mha_res.x1@0,transformer.20.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.20.mha_res.dy@0,N,transformer.20.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.20.mha_res.y@0,
transformer.20.mha_res.dx1@0,N,transformer.20.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.20.mha_res.x1@0,
transformer.20.mha_res.dx2@0,N,transformer.20.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.20.mha_res.x2@0,
transformer.20.post_attn_norm.x@0,N,transformer.20.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.20.post_attn_norm.y@0,N,transformer.20.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.20.post_attn_norm.dy@0,N,transformer.20.ffn.dx0@0,transformer.20.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.20.post_attn_norm.y@0,
transformer.20.post_attn_norm.dx@0,N,transformer.20.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.20.post_attn_norm.x@0,
transformer.20.ffn.x0@0,N,transformer.20.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.20.ffn.wgate@0,N,transformer.20._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.20.ffn.wdown@0,N,transformer.20._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.20.ffn.x00@0,N,transformer.20.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.20.ffn.xgate@0,N,transformer.20.ffn.x00@0,transformer.20.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.20.ffn.xdown1@0,N,transformer.20.ffn.xgate@0,transformer.20.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.20.ffn.xdown@0,N,transformer.20.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.20.ffn.dxdown@0,N,transformer.20.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.20.ffn.xdown@0,
transformer.20.ffn.dxdown2@0,N,transformer.20.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.20.ffn.dwdown@0,N,transformer.20.ffn.dxdown2@0,transformer.20.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.20.ffn.wdown@0,
transformer.20.ffn.dxgate@0,N,transformer.20.ffn.dxdown2@0,transformer.20._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.20.ffn.xgate@0,
transformer.20.ffn.x01@0,N,transformer.20.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.20.ffn.dwgate@0,N,transformer.20.ffn.dxgate@0,transformer.20.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.20.ffn.wgate@0,
transformer.20.ffn.dx000@0,N,transformer.20.ffn.dxgate@0,transformer.20._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.20.ffn.dx0@0,N,transformer.20.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.20.ffn_res.x1@0,N,transformer.20.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.20.ffn_res.x2@0,N,transformer.20.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.20.ffn_res.y@0,N,transformer.20.ffn_res.x1@0,transformer.20.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.20.ffn_res.dy@0,N,transformer.21.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.20.ffn_res.y@0,
transformer.20.ffn_res.dx1@0,N,transformer.20.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.20.ffn_res.x1@0,
transformer.20.ffn_res.dx2@0,N,transformer.20.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.20.ffn_res.x2@0,
transformer.20._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.20._assembled_weight@0,N,transformer.20._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.20._sharded_grad@0,N,transformer.20._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.20._sharded_weight@0,
transformer.20._assembled_grad@0,N,transformer.20.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.20.mha.dwo@0"", ""transformer.20.ffn.dwgate@0"", ""transformer.20.ffn.dwdown@0""]}"
transformer.20._mha.wqkv_backward@0,N,transformer.20._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.20._mha.wo_backward@0,N,transformer.20._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.20._ffn.wgate_backward@0,N,transformer.20._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.20._ffn.wdown_backward@0,N,transformer.20._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.20._assembled_weight_backward@0,N,transformer.20._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.21.input_norm.x@0,N,transformer.20.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.21.input_norm.y@0,N,transformer.21.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.21.input_norm.dy@0,N,transformer.21.mha.dx@0,transformer.21.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.21.input_norm.y@0,
transformer.21.input_norm.dx@0,N,transformer.21.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.21.input_norm.x@0,
transformer.21.mha.x@0,N,transformer.21.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.21.mha.wqkv@0,N,transformer.21._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.21.mha.qkv@0,N,transformer.21.mha.x@0,transformer.21.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.21.mha.q@0,N,transformer.21.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.21.mha.k@0,N,transformer.21.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.21.mha.v@0,N,transformer.21.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.21.mha.attn@0,N,transformer.21.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.21.mha.wo@0,N,transformer.21._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.21.mha.o1@0,N,transformer.21.mha.attn@0,transformer.21.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.21.mha.o@0,N,transformer.21.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.21.mha.do@0,N,transformer.21.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.21.mha.o@0,
transformer.21.mha.do1@0,N,transformer.21.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.21.mha.o1@0,
transformer.21.mha.dattn@0,N,transformer.21.mha.do1@0,transformer.21._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.21.mha.dwo@0,N,transformer.21.mha.do1@0,transformer.21.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.21.mha.wo@0,
transformer.21.mha.dv@0,N,transformer.21.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.21.mha.v@0,
transformer.21.mha.dk@0,N,transformer.21.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.21.mha.k@0,
transformer.21.mha.dq@0,N,transformer.21.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.21.mha.q@0,
transformer.21.mha.dkv@0,N,transformer.21.mha.dv@0,transformer.21.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.21.mha.dqkv@0,N,transformer.21.mha.dkv@0,transformer.21.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.21.mha.qkv@0,
transformer.21.mha.dwqkv@0,N,transformer.21.mha.dqkv@0,transformer.21.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.21.mha.wqkv@0,
transformer.21.mha.dx1@0,N,transformer.21.mha.dqkv@0,transformer.21._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.21.mha.dx@0,N,transformer.21.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.21.mha.attn_kernel.q@0,N,transformer.21.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.21.mha.attn_kernel.k@0,N,transformer.21.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.21.mha.attn_kernel.v@0,N,transformer.21.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.21.mha.attn_kernel.k1@0,N,transformer.21.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.21.mha.attn_kernel.v1@0,N,transformer.21.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.21.mha.attn_kernel.qkv@0,N,transformer.21.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.21.mha.attn_kernel.k1@0"", ""transformer.21.mha.attn_kernel.v1@0""]}"
transformer.21.mha.attn_kernel.dqkv@0,N,transformer.21.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.21.mha.attn_kernel.qkv@0,
transformer.21.mha.attn_kernel.dq@0,N,transformer.21.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.21.mha.attn_kernel.q@0,
transformer.21.mha.attn_kernel.dk@0,N,transformer.21.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.21.mha.attn_kernel.dv@0,N,transformer.21.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.21.mha_res.x1@0,N,transformer.21.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.21.mha_res.x2@0,N,transformer.21.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.21.mha_res.y@0,N,transformer.21.mha_res.x1@0,transformer.21.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.21.mha_res.dy@0,N,transformer.21.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.21.mha_res.y@0,
transformer.21.mha_res.dx1@0,N,transformer.21.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.21.mha_res.x1@0,
transformer.21.mha_res.dx2@0,N,transformer.21.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.21.mha_res.x2@0,
transformer.21.post_attn_norm.x@0,N,transformer.21.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.21.post_attn_norm.y@0,N,transformer.21.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.21.post_attn_norm.dy@0,N,transformer.21.ffn.dx0@0,transformer.21.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.21.post_attn_norm.y@0,
transformer.21.post_attn_norm.dx@0,N,transformer.21.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.21.post_attn_norm.x@0,
transformer.21.ffn.x0@0,N,transformer.21.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.21.ffn.wgate@0,N,transformer.21._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.21.ffn.wdown@0,N,transformer.21._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.21.ffn.x00@0,N,transformer.21.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.21.ffn.xgate@0,N,transformer.21.ffn.x00@0,transformer.21.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.21.ffn.xdown1@0,N,transformer.21.ffn.xgate@0,transformer.21.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.21.ffn.xdown@0,N,transformer.21.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.21.ffn.dxdown@0,N,transformer.21.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.21.ffn.xdown@0,
transformer.21.ffn.dxdown2@0,N,transformer.21.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.21.ffn.dwdown@0,N,transformer.21.ffn.dxdown2@0,transformer.21.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.21.ffn.wdown@0,
transformer.21.ffn.dxgate@0,N,transformer.21.ffn.dxdown2@0,transformer.21._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.21.ffn.xgate@0,
transformer.21.ffn.x01@0,N,transformer.21.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.21.ffn.dwgate@0,N,transformer.21.ffn.dxgate@0,transformer.21.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.21.ffn.wgate@0,
transformer.21.ffn.dx000@0,N,transformer.21.ffn.dxgate@0,transformer.21._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.21.ffn.dx0@0,N,transformer.21.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.21.ffn_res.x1@0,N,transformer.21.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.21.ffn_res.x2@0,N,transformer.21.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.21.ffn_res.y@0,N,transformer.21.ffn_res.x1@0,transformer.21.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.21.ffn_res.dy@0,N,transformer.22.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.21.ffn_res.y@0,
transformer.21.ffn_res.dx1@0,N,transformer.21.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.21.ffn_res.x1@0,
transformer.21.ffn_res.dx2@0,N,transformer.21.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.21.ffn_res.x2@0,
transformer.21._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.21._assembled_weight@0,N,transformer.21._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.21._sharded_grad@0,N,transformer.21._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.21._sharded_weight@0,
transformer.21._assembled_grad@0,N,transformer.21.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.21.mha.dwo@0"", ""transformer.21.ffn.dwgate@0"", ""transformer.21.ffn.dwdown@0""]}"
transformer.21._mha.wqkv_backward@0,N,transformer.21._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.21._mha.wo_backward@0,N,transformer.21._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.21._ffn.wgate_backward@0,N,transformer.21._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.21._ffn.wdown_backward@0,N,transformer.21._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.21._assembled_weight_backward@0,N,transformer.21._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.22.input_norm.x@0,N,transformer.21.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.22.input_norm.y@0,N,transformer.22.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.22.input_norm.dy@0,N,transformer.22.mha.dx@0,transformer.22.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.22.input_norm.y@0,
transformer.22.input_norm.dx@0,N,transformer.22.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.22.input_norm.x@0,
transformer.22.mha.x@0,N,transformer.22.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.22.mha.wqkv@0,N,transformer.22._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.22.mha.qkv@0,N,transformer.22.mha.x@0,transformer.22.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.22.mha.q@0,N,transformer.22.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.22.mha.k@0,N,transformer.22.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.22.mha.v@0,N,transformer.22.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.22.mha.attn@0,N,transformer.22.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.22.mha.wo@0,N,transformer.22._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.22.mha.o1@0,N,transformer.22.mha.attn@0,transformer.22.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.22.mha.o@0,N,transformer.22.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.22.mha.do@0,N,transformer.22.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.22.mha.o@0,
transformer.22.mha.do1@0,N,transformer.22.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.22.mha.o1@0,
transformer.22.mha.dattn@0,N,transformer.22.mha.do1@0,transformer.22._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.22.mha.dwo@0,N,transformer.22.mha.do1@0,transformer.22.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.22.mha.wo@0,
transformer.22.mha.dv@0,N,transformer.22.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.22.mha.v@0,
transformer.22.mha.dk@0,N,transformer.22.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.22.mha.k@0,
transformer.22.mha.dq@0,N,transformer.22.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.22.mha.q@0,
transformer.22.mha.dkv@0,N,transformer.22.mha.dv@0,transformer.22.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.22.mha.dqkv@0,N,transformer.22.mha.dkv@0,transformer.22.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.22.mha.qkv@0,
transformer.22.mha.dwqkv@0,N,transformer.22.mha.dqkv@0,transformer.22.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.22.mha.wqkv@0,
transformer.22.mha.dx1@0,N,transformer.22.mha.dqkv@0,transformer.22._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.22.mha.dx@0,N,transformer.22.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.22.mha.attn_kernel.q@0,N,transformer.22.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.22.mha.attn_kernel.k@0,N,transformer.22.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.22.mha.attn_kernel.v@0,N,transformer.22.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.22.mha.attn_kernel.k1@0,N,transformer.22.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.22.mha.attn_kernel.v1@0,N,transformer.22.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.22.mha.attn_kernel.qkv@0,N,transformer.22.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.22.mha.attn_kernel.k1@0"", ""transformer.22.mha.attn_kernel.v1@0""]}"
transformer.22.mha.attn_kernel.dqkv@0,N,transformer.22.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.22.mha.attn_kernel.qkv@0,
transformer.22.mha.attn_kernel.dq@0,N,transformer.22.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.22.mha.attn_kernel.q@0,
transformer.22.mha.attn_kernel.dk@0,N,transformer.22.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.22.mha.attn_kernel.dv@0,N,transformer.22.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.22.mha_res.x1@0,N,transformer.22.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.22.mha_res.x2@0,N,transformer.22.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.22.mha_res.y@0,N,transformer.22.mha_res.x1@0,transformer.22.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.22.mha_res.dy@0,N,transformer.22.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.22.mha_res.y@0,
transformer.22.mha_res.dx1@0,N,transformer.22.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.22.mha_res.x1@0,
transformer.22.mha_res.dx2@0,N,transformer.22.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.22.mha_res.x2@0,
transformer.22.post_attn_norm.x@0,N,transformer.22.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.22.post_attn_norm.y@0,N,transformer.22.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.22.post_attn_norm.dy@0,N,transformer.22.ffn.dx0@0,transformer.22.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.22.post_attn_norm.y@0,
transformer.22.post_attn_norm.dx@0,N,transformer.22.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.22.post_attn_norm.x@0,
transformer.22.ffn.x0@0,N,transformer.22.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.22.ffn.wgate@0,N,transformer.22._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.22.ffn.wdown@0,N,transformer.22._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.22.ffn.x00@0,N,transformer.22.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.22.ffn.xgate@0,N,transformer.22.ffn.x00@0,transformer.22.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.22.ffn.xdown1@0,N,transformer.22.ffn.xgate@0,transformer.22.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.22.ffn.xdown@0,N,transformer.22.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.22.ffn.dxdown@0,N,transformer.22.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.22.ffn.xdown@0,
transformer.22.ffn.dxdown2@0,N,transformer.22.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.22.ffn.dwdown@0,N,transformer.22.ffn.dxdown2@0,transformer.22.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.22.ffn.wdown@0,
transformer.22.ffn.dxgate@0,N,transformer.22.ffn.dxdown2@0,transformer.22._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.22.ffn.xgate@0,
transformer.22.ffn.x01@0,N,transformer.22.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.22.ffn.dwgate@0,N,transformer.22.ffn.dxgate@0,transformer.22.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.22.ffn.wgate@0,
transformer.22.ffn.dx000@0,N,transformer.22.ffn.dxgate@0,transformer.22._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.22.ffn.dx0@0,N,transformer.22.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.22.ffn_res.x1@0,N,transformer.22.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.22.ffn_res.x2@0,N,transformer.22.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.22.ffn_res.y@0,N,transformer.22.ffn_res.x1@0,transformer.22.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.22.ffn_res.dy@0,N,transformer.23.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.22.ffn_res.y@0,
transformer.22.ffn_res.dx1@0,N,transformer.22.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.22.ffn_res.x1@0,
transformer.22.ffn_res.dx2@0,N,transformer.22.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.22.ffn_res.x2@0,
transformer.22._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.22._assembled_weight@0,N,transformer.22._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.22._sharded_grad@0,N,transformer.22._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.22._sharded_weight@0,
transformer.22._assembled_grad@0,N,transformer.22.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.22.mha.dwo@0"", ""transformer.22.ffn.dwgate@0"", ""transformer.22.ffn.dwdown@0""]}"
transformer.22._mha.wqkv_backward@0,N,transformer.22._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.22._mha.wo_backward@0,N,transformer.22._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.22._ffn.wgate_backward@0,N,transformer.22._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.22._ffn.wdown_backward@0,N,transformer.22._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.22._assembled_weight_backward@0,N,transformer.22._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.23.input_norm.x@0,N,transformer.22.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.23.input_norm.y@0,N,transformer.23.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.23.input_norm.dy@0,N,transformer.23.mha.dx@0,transformer.23.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.23.input_norm.y@0,
transformer.23.input_norm.dx@0,N,transformer.23.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.23.input_norm.x@0,
transformer.23.mha.x@0,N,transformer.23.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.23.mha.wqkv@0,N,transformer.23._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.23.mha.qkv@0,N,transformer.23.mha.x@0,transformer.23.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.23.mha.q@0,N,transformer.23.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.23.mha.k@0,N,transformer.23.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.23.mha.v@0,N,transformer.23.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.23.mha.attn@0,N,transformer.23.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.23.mha.wo@0,N,transformer.23._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.23.mha.o1@0,N,transformer.23.mha.attn@0,transformer.23.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.23.mha.o@0,N,transformer.23.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.23.mha.do@0,N,transformer.23.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.23.mha.o@0,
transformer.23.mha.do1@0,N,transformer.23.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.23.mha.o1@0,
transformer.23.mha.dattn@0,N,transformer.23.mha.do1@0,transformer.23._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.23.mha.dwo@0,N,transformer.23.mha.do1@0,transformer.23.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.23.mha.wo@0,
transformer.23.mha.dv@0,N,transformer.23.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.23.mha.v@0,
transformer.23.mha.dk@0,N,transformer.23.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.23.mha.k@0,
transformer.23.mha.dq@0,N,transformer.23.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.23.mha.q@0,
transformer.23.mha.dkv@0,N,transformer.23.mha.dv@0,transformer.23.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.23.mha.dqkv@0,N,transformer.23.mha.dkv@0,transformer.23.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.23.mha.qkv@0,
transformer.23.mha.dwqkv@0,N,transformer.23.mha.dqkv@0,transformer.23.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.23.mha.wqkv@0,
transformer.23.mha.dx1@0,N,transformer.23.mha.dqkv@0,transformer.23._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.23.mha.dx@0,N,transformer.23.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.23.mha.attn_kernel.q@0,N,transformer.23.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.23.mha.attn_kernel.k@0,N,transformer.23.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.23.mha.attn_kernel.v@0,N,transformer.23.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.23.mha.attn_kernel.k1@0,N,transformer.23.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.23.mha.attn_kernel.v1@0,N,transformer.23.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.23.mha.attn_kernel.qkv@0,N,transformer.23.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.23.mha.attn_kernel.k1@0"", ""transformer.23.mha.attn_kernel.v1@0""]}"
transformer.23.mha.attn_kernel.dqkv@0,N,transformer.23.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.23.mha.attn_kernel.qkv@0,
transformer.23.mha.attn_kernel.dq@0,N,transformer.23.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.23.mha.attn_kernel.q@0,
transformer.23.mha.attn_kernel.dk@0,N,transformer.23.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.23.mha.attn_kernel.dv@0,N,transformer.23.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.23.mha_res.x1@0,N,transformer.23.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.23.mha_res.x2@0,N,transformer.23.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.23.mha_res.y@0,N,transformer.23.mha_res.x1@0,transformer.23.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.23.mha_res.dy@0,N,transformer.23.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.23.mha_res.y@0,
transformer.23.mha_res.dx1@0,N,transformer.23.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.23.mha_res.x1@0,
transformer.23.mha_res.dx2@0,N,transformer.23.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.23.mha_res.x2@0,
transformer.23.post_attn_norm.x@0,N,transformer.23.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.23.post_attn_norm.y@0,N,transformer.23.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.23.post_attn_norm.dy@0,N,transformer.23.ffn.dx0@0,transformer.23.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.23.post_attn_norm.y@0,
transformer.23.post_attn_norm.dx@0,N,transformer.23.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.23.post_attn_norm.x@0,
transformer.23.ffn.x0@0,N,transformer.23.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.23.ffn.wgate@0,N,transformer.23._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.23.ffn.wdown@0,N,transformer.23._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.23.ffn.x00@0,N,transformer.23.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.23.ffn.xgate@0,N,transformer.23.ffn.x00@0,transformer.23.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.23.ffn.xdown1@0,N,transformer.23.ffn.xgate@0,transformer.23.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.23.ffn.xdown@0,N,transformer.23.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.23.ffn.dxdown@0,N,transformer.23.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.23.ffn.xdown@0,
transformer.23.ffn.dxdown2@0,N,transformer.23.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.23.ffn.dwdown@0,N,transformer.23.ffn.dxdown2@0,transformer.23.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.23.ffn.wdown@0,
transformer.23.ffn.dxgate@0,N,transformer.23.ffn.dxdown2@0,transformer.23._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.23.ffn.xgate@0,
transformer.23.ffn.x01@0,N,transformer.23.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.23.ffn.dwgate@0,N,transformer.23.ffn.dxgate@0,transformer.23.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.23.ffn.wgate@0,
transformer.23.ffn.dx000@0,N,transformer.23.ffn.dxgate@0,transformer.23._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.23.ffn.dx0@0,N,transformer.23.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.23.ffn_res.x1@0,N,transformer.23.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.23.ffn_res.x2@0,N,transformer.23.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.23.ffn_res.y@0,N,transformer.23.ffn_res.x1@0,transformer.23.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.23.ffn_res.dy@0,N,transformer.24.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.23.ffn_res.y@0,
transformer.23.ffn_res.dx1@0,N,transformer.23.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.23.ffn_res.x1@0,
transformer.23.ffn_res.dx2@0,N,transformer.23.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.23.ffn_res.x2@0,
transformer.23._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.23._assembled_weight@0,N,transformer.23._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.23._sharded_grad@0,N,transformer.23._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.23._sharded_weight@0,
transformer.23._assembled_grad@0,N,transformer.23.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.23.mha.dwo@0"", ""transformer.23.ffn.dwgate@0"", ""transformer.23.ffn.dwdown@0""]}"
transformer.23._mha.wqkv_backward@0,N,transformer.23._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.23._mha.wo_backward@0,N,transformer.23._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.23._ffn.wgate_backward@0,N,transformer.23._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.23._ffn.wdown_backward@0,N,transformer.23._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.23._assembled_weight_backward@0,N,transformer.23._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.24.input_norm.x@0,N,transformer.23.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.24.input_norm.y@0,N,transformer.24.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.24.input_norm.dy@0,N,transformer.24.mha.dx@0,transformer.24.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.24.input_norm.y@0,
transformer.24.input_norm.dx@0,N,transformer.24.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.24.input_norm.x@0,
transformer.24.mha.x@0,N,transformer.24.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.24.mha.wqkv@0,N,transformer.24._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.24.mha.qkv@0,N,transformer.24.mha.x@0,transformer.24.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.24.mha.q@0,N,transformer.24.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.24.mha.k@0,N,transformer.24.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.24.mha.v@0,N,transformer.24.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.24.mha.attn@0,N,transformer.24.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.24.mha.wo@0,N,transformer.24._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.24.mha.o1@0,N,transformer.24.mha.attn@0,transformer.24.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.24.mha.o@0,N,transformer.24.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.24.mha.do@0,N,transformer.24.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.24.mha.o@0,
transformer.24.mha.do1@0,N,transformer.24.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.24.mha.o1@0,
transformer.24.mha.dattn@0,N,transformer.24.mha.do1@0,transformer.24._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.24.mha.dwo@0,N,transformer.24.mha.do1@0,transformer.24.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.24.mha.wo@0,
transformer.24.mha.dv@0,N,transformer.24.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.24.mha.v@0,
transformer.24.mha.dk@0,N,transformer.24.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.24.mha.k@0,
transformer.24.mha.dq@0,N,transformer.24.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.24.mha.q@0,
transformer.24.mha.dkv@0,N,transformer.24.mha.dv@0,transformer.24.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.24.mha.dqkv@0,N,transformer.24.mha.dkv@0,transformer.24.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.24.mha.qkv@0,
transformer.24.mha.dwqkv@0,N,transformer.24.mha.dqkv@0,transformer.24.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.24.mha.wqkv@0,
transformer.24.mha.dx1@0,N,transformer.24.mha.dqkv@0,transformer.24._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.24.mha.dx@0,N,transformer.24.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.24.mha.attn_kernel.q@0,N,transformer.24.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.24.mha.attn_kernel.k@0,N,transformer.24.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.24.mha.attn_kernel.v@0,N,transformer.24.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.24.mha.attn_kernel.k1@0,N,transformer.24.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.24.mha.attn_kernel.v1@0,N,transformer.24.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.24.mha.attn_kernel.qkv@0,N,transformer.24.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.24.mha.attn_kernel.k1@0"", ""transformer.24.mha.attn_kernel.v1@0""]}"
transformer.24.mha.attn_kernel.dqkv@0,N,transformer.24.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.24.mha.attn_kernel.qkv@0,
transformer.24.mha.attn_kernel.dq@0,N,transformer.24.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.24.mha.attn_kernel.q@0,
transformer.24.mha.attn_kernel.dk@0,N,transformer.24.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.24.mha.attn_kernel.dv@0,N,transformer.24.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.24.mha_res.x1@0,N,transformer.24.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.24.mha_res.x2@0,N,transformer.24.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.24.mha_res.y@0,N,transformer.24.mha_res.x1@0,transformer.24.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.24.mha_res.dy@0,N,transformer.24.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.24.mha_res.y@0,
transformer.24.mha_res.dx1@0,N,transformer.24.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.24.mha_res.x1@0,
transformer.24.mha_res.dx2@0,N,transformer.24.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.24.mha_res.x2@0,
transformer.24.post_attn_norm.x@0,N,transformer.24.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.24.post_attn_norm.y@0,N,transformer.24.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.24.post_attn_norm.dy@0,N,transformer.24.ffn.dx0@0,transformer.24.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.24.post_attn_norm.y@0,
transformer.24.post_attn_norm.dx@0,N,transformer.24.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.24.post_attn_norm.x@0,
transformer.24.ffn.x0@0,N,transformer.24.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.24.ffn.wgate@0,N,transformer.24._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.24.ffn.wdown@0,N,transformer.24._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.24.ffn.x00@0,N,transformer.24.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.24.ffn.xgate@0,N,transformer.24.ffn.x00@0,transformer.24.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.24.ffn.xdown1@0,N,transformer.24.ffn.xgate@0,transformer.24.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.24.ffn.xdown@0,N,transformer.24.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.24.ffn.dxdown@0,N,transformer.24.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.24.ffn.xdown@0,
transformer.24.ffn.dxdown2@0,N,transformer.24.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.24.ffn.dwdown@0,N,transformer.24.ffn.dxdown2@0,transformer.24.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.24.ffn.wdown@0,
transformer.24.ffn.dxgate@0,N,transformer.24.ffn.dxdown2@0,transformer.24._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.24.ffn.xgate@0,
transformer.24.ffn.x01@0,N,transformer.24.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.24.ffn.dwgate@0,N,transformer.24.ffn.dxgate@0,transformer.24.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.24.ffn.wgate@0,
transformer.24.ffn.dx000@0,N,transformer.24.ffn.dxgate@0,transformer.24._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.24.ffn.dx0@0,N,transformer.24.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.24.ffn_res.x1@0,N,transformer.24.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.24.ffn_res.x2@0,N,transformer.24.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.24.ffn_res.y@0,N,transformer.24.ffn_res.x1@0,transformer.24.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.24.ffn_res.dy@0,N,transformer.25.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.24.ffn_res.y@0,
transformer.24.ffn_res.dx1@0,N,transformer.24.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.24.ffn_res.x1@0,
transformer.24.ffn_res.dx2@0,N,transformer.24.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.24.ffn_res.x2@0,
transformer.24._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.24._assembled_weight@0,N,transformer.24._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.24._sharded_grad@0,N,transformer.24._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.24._sharded_weight@0,
transformer.24._assembled_grad@0,N,transformer.24.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.24.mha.dwo@0"", ""transformer.24.ffn.dwgate@0"", ""transformer.24.ffn.dwdown@0""]}"
transformer.24._mha.wqkv_backward@0,N,transformer.24._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.24._mha.wo_backward@0,N,transformer.24._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.24._ffn.wgate_backward@0,N,transformer.24._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.24._ffn.wdown_backward@0,N,transformer.24._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.24._assembled_weight_backward@0,N,transformer.24._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.25.input_norm.x@0,N,transformer.24.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.25.input_norm.y@0,N,transformer.25.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.25.input_norm.dy@0,N,transformer.25.mha.dx@0,transformer.25.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.25.input_norm.y@0,
transformer.25.input_norm.dx@0,N,transformer.25.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.25.input_norm.x@0,
transformer.25.mha.x@0,N,transformer.25.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.25.mha.wqkv@0,N,transformer.25._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.25.mha.qkv@0,N,transformer.25.mha.x@0,transformer.25.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.25.mha.q@0,N,transformer.25.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.25.mha.k@0,N,transformer.25.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.25.mha.v@0,N,transformer.25.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.25.mha.attn@0,N,transformer.25.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.25.mha.wo@0,N,transformer.25._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.25.mha.o1@0,N,transformer.25.mha.attn@0,transformer.25.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.25.mha.o@0,N,transformer.25.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.25.mha.do@0,N,transformer.25.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.25.mha.o@0,
transformer.25.mha.do1@0,N,transformer.25.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.25.mha.o1@0,
transformer.25.mha.dattn@0,N,transformer.25.mha.do1@0,transformer.25._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.25.mha.dwo@0,N,transformer.25.mha.do1@0,transformer.25.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.25.mha.wo@0,
transformer.25.mha.dv@0,N,transformer.25.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.25.mha.v@0,
transformer.25.mha.dk@0,N,transformer.25.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.25.mha.k@0,
transformer.25.mha.dq@0,N,transformer.25.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.25.mha.q@0,
transformer.25.mha.dkv@0,N,transformer.25.mha.dv@0,transformer.25.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.25.mha.dqkv@0,N,transformer.25.mha.dkv@0,transformer.25.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.25.mha.qkv@0,
transformer.25.mha.dwqkv@0,N,transformer.25.mha.dqkv@0,transformer.25.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.25.mha.wqkv@0,
transformer.25.mha.dx1@0,N,transformer.25.mha.dqkv@0,transformer.25._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.25.mha.dx@0,N,transformer.25.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.25.mha.attn_kernel.q@0,N,transformer.25.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.25.mha.attn_kernel.k@0,N,transformer.25.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.25.mha.attn_kernel.v@0,N,transformer.25.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.25.mha.attn_kernel.k1@0,N,transformer.25.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.25.mha.attn_kernel.v1@0,N,transformer.25.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.25.mha.attn_kernel.qkv@0,N,transformer.25.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.25.mha.attn_kernel.k1@0"", ""transformer.25.mha.attn_kernel.v1@0""]}"
transformer.25.mha.attn_kernel.dqkv@0,N,transformer.25.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.25.mha.attn_kernel.qkv@0,
transformer.25.mha.attn_kernel.dq@0,N,transformer.25.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.25.mha.attn_kernel.q@0,
transformer.25.mha.attn_kernel.dk@0,N,transformer.25.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.25.mha.attn_kernel.dv@0,N,transformer.25.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.25.mha_res.x1@0,N,transformer.25.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.25.mha_res.x2@0,N,transformer.25.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.25.mha_res.y@0,N,transformer.25.mha_res.x1@0,transformer.25.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.25.mha_res.dy@0,N,transformer.25.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.25.mha_res.y@0,
transformer.25.mha_res.dx1@0,N,transformer.25.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.25.mha_res.x1@0,
transformer.25.mha_res.dx2@0,N,transformer.25.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.25.mha_res.x2@0,
transformer.25.post_attn_norm.x@0,N,transformer.25.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.25.post_attn_norm.y@0,N,transformer.25.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.25.post_attn_norm.dy@0,N,transformer.25.ffn.dx0@0,transformer.25.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.25.post_attn_norm.y@0,
transformer.25.post_attn_norm.dx@0,N,transformer.25.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.25.post_attn_norm.x@0,
transformer.25.ffn.x0@0,N,transformer.25.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.25.ffn.wgate@0,N,transformer.25._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.25.ffn.wdown@0,N,transformer.25._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.25.ffn.x00@0,N,transformer.25.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.25.ffn.xgate@0,N,transformer.25.ffn.x00@0,transformer.25.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.25.ffn.xdown1@0,N,transformer.25.ffn.xgate@0,transformer.25.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.25.ffn.xdown@0,N,transformer.25.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.25.ffn.dxdown@0,N,transformer.25.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.25.ffn.xdown@0,
transformer.25.ffn.dxdown2@0,N,transformer.25.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.25.ffn.dwdown@0,N,transformer.25.ffn.dxdown2@0,transformer.25.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.25.ffn.wdown@0,
transformer.25.ffn.dxgate@0,N,transformer.25.ffn.dxdown2@0,transformer.25._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.25.ffn.xgate@0,
transformer.25.ffn.x01@0,N,transformer.25.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.25.ffn.dwgate@0,N,transformer.25.ffn.dxgate@0,transformer.25.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.25.ffn.wgate@0,
transformer.25.ffn.dx000@0,N,transformer.25.ffn.dxgate@0,transformer.25._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.25.ffn.dx0@0,N,transformer.25.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.25.ffn_res.x1@0,N,transformer.25.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.25.ffn_res.x2@0,N,transformer.25.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.25.ffn_res.y@0,N,transformer.25.ffn_res.x1@0,transformer.25.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.25.ffn_res.dy@0,N,transformer.26.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.25.ffn_res.y@0,
transformer.25.ffn_res.dx1@0,N,transformer.25.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.25.ffn_res.x1@0,
transformer.25.ffn_res.dx2@0,N,transformer.25.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.25.ffn_res.x2@0,
transformer.25._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.25._assembled_weight@0,N,transformer.25._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.25._sharded_grad@0,N,transformer.25._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.25._sharded_weight@0,
transformer.25._assembled_grad@0,N,transformer.25.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.25.mha.dwo@0"", ""transformer.25.ffn.dwgate@0"", ""transformer.25.ffn.dwdown@0""]}"
transformer.25._mha.wqkv_backward@0,N,transformer.25._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.25._mha.wo_backward@0,N,transformer.25._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.25._ffn.wgate_backward@0,N,transformer.25._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.25._ffn.wdown_backward@0,N,transformer.25._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.25._assembled_weight_backward@0,N,transformer.25._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.26.input_norm.x@0,N,transformer.25.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.26.input_norm.y@0,N,transformer.26.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.26.input_norm.dy@0,N,transformer.26.mha.dx@0,transformer.26.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.26.input_norm.y@0,
transformer.26.input_norm.dx@0,N,transformer.26.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.26.input_norm.x@0,
transformer.26.mha.x@0,N,transformer.26.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.26.mha.wqkv@0,N,transformer.26._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.26.mha.qkv@0,N,transformer.26.mha.x@0,transformer.26.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.26.mha.q@0,N,transformer.26.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.26.mha.k@0,N,transformer.26.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.26.mha.v@0,N,transformer.26.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.26.mha.attn@0,N,transformer.26.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.26.mha.wo@0,N,transformer.26._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.26.mha.o1@0,N,transformer.26.mha.attn@0,transformer.26.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.26.mha.o@0,N,transformer.26.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.26.mha.do@0,N,transformer.26.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.26.mha.o@0,
transformer.26.mha.do1@0,N,transformer.26.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.26.mha.o1@0,
transformer.26.mha.dattn@0,N,transformer.26.mha.do1@0,transformer.26._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.26.mha.dwo@0,N,transformer.26.mha.do1@0,transformer.26.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.26.mha.wo@0,
transformer.26.mha.dv@0,N,transformer.26.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.26.mha.v@0,
transformer.26.mha.dk@0,N,transformer.26.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.26.mha.k@0,
transformer.26.mha.dq@0,N,transformer.26.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.26.mha.q@0,
transformer.26.mha.dkv@0,N,transformer.26.mha.dv@0,transformer.26.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.26.mha.dqkv@0,N,transformer.26.mha.dkv@0,transformer.26.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.26.mha.qkv@0,
transformer.26.mha.dwqkv@0,N,transformer.26.mha.dqkv@0,transformer.26.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.26.mha.wqkv@0,
transformer.26.mha.dx1@0,N,transformer.26.mha.dqkv@0,transformer.26._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.26.mha.dx@0,N,transformer.26.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.26.mha.attn_kernel.q@0,N,transformer.26.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.26.mha.attn_kernel.k@0,N,transformer.26.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.26.mha.attn_kernel.v@0,N,transformer.26.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.26.mha.attn_kernel.k1@0,N,transformer.26.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.26.mha.attn_kernel.v1@0,N,transformer.26.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.26.mha.attn_kernel.qkv@0,N,transformer.26.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.26.mha.attn_kernel.k1@0"", ""transformer.26.mha.attn_kernel.v1@0""]}"
transformer.26.mha.attn_kernel.dqkv@0,N,transformer.26.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.26.mha.attn_kernel.qkv@0,
transformer.26.mha.attn_kernel.dq@0,N,transformer.26.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.26.mha.attn_kernel.q@0,
transformer.26.mha.attn_kernel.dk@0,N,transformer.26.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.26.mha.attn_kernel.dv@0,N,transformer.26.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.26.mha_res.x1@0,N,transformer.26.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.26.mha_res.x2@0,N,transformer.26.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.26.mha_res.y@0,N,transformer.26.mha_res.x1@0,transformer.26.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.26.mha_res.dy@0,N,transformer.26.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.26.mha_res.y@0,
transformer.26.mha_res.dx1@0,N,transformer.26.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.26.mha_res.x1@0,
transformer.26.mha_res.dx2@0,N,transformer.26.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.26.mha_res.x2@0,
transformer.26.post_attn_norm.x@0,N,transformer.26.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.26.post_attn_norm.y@0,N,transformer.26.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.26.post_attn_norm.dy@0,N,transformer.26.ffn.dx0@0,transformer.26.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.26.post_attn_norm.y@0,
transformer.26.post_attn_norm.dx@0,N,transformer.26.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.26.post_attn_norm.x@0,
transformer.26.ffn.x0@0,N,transformer.26.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.26.ffn.wgate@0,N,transformer.26._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.26.ffn.wdown@0,N,transformer.26._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.26.ffn.x00@0,N,transformer.26.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.26.ffn.xgate@0,N,transformer.26.ffn.x00@0,transformer.26.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.26.ffn.xdown1@0,N,transformer.26.ffn.xgate@0,transformer.26.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.26.ffn.xdown@0,N,transformer.26.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.26.ffn.dxdown@0,N,transformer.26.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.26.ffn.xdown@0,
transformer.26.ffn.dxdown2@0,N,transformer.26.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.26.ffn.dwdown@0,N,transformer.26.ffn.dxdown2@0,transformer.26.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.26.ffn.wdown@0,
transformer.26.ffn.dxgate@0,N,transformer.26.ffn.dxdown2@0,transformer.26._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.26.ffn.xgate@0,
transformer.26.ffn.x01@0,N,transformer.26.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.26.ffn.dwgate@0,N,transformer.26.ffn.dxgate@0,transformer.26.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.26.ffn.wgate@0,
transformer.26.ffn.dx000@0,N,transformer.26.ffn.dxgate@0,transformer.26._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.26.ffn.dx0@0,N,transformer.26.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.26.ffn_res.x1@0,N,transformer.26.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.26.ffn_res.x2@0,N,transformer.26.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.26.ffn_res.y@0,N,transformer.26.ffn_res.x1@0,transformer.26.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.26.ffn_res.dy@0,N,transformer.27.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.26.ffn_res.y@0,
transformer.26.ffn_res.dx1@0,N,transformer.26.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.26.ffn_res.x1@0,
transformer.26.ffn_res.dx2@0,N,transformer.26.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.26.ffn_res.x2@0,
transformer.26._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.26._assembled_weight@0,N,transformer.26._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.26._sharded_grad@0,N,transformer.26._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.26._sharded_weight@0,
transformer.26._assembled_grad@0,N,transformer.26.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.26.mha.dwo@0"", ""transformer.26.ffn.dwgate@0"", ""transformer.26.ffn.dwdown@0""]}"
transformer.26._mha.wqkv_backward@0,N,transformer.26._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.26._mha.wo_backward@0,N,transformer.26._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.26._ffn.wgate_backward@0,N,transformer.26._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.26._ffn.wdown_backward@0,N,transformer.26._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.26._assembled_weight_backward@0,N,transformer.26._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.27.input_norm.x@0,N,transformer.26.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.27.input_norm.y@0,N,transformer.27.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.27.input_norm.dy@0,N,transformer.27.mha.dx@0,transformer.27.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.27.input_norm.y@0,
transformer.27.input_norm.dx@0,N,transformer.27.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.27.input_norm.x@0,
transformer.27.mha.x@0,N,transformer.27.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.27.mha.wqkv@0,N,transformer.27._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.27.mha.qkv@0,N,transformer.27.mha.x@0,transformer.27.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.27.mha.q@0,N,transformer.27.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.27.mha.k@0,N,transformer.27.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.27.mha.v@0,N,transformer.27.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.27.mha.attn@0,N,transformer.27.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.27.mha.wo@0,N,transformer.27._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.27.mha.o1@0,N,transformer.27.mha.attn@0,transformer.27.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.27.mha.o@0,N,transformer.27.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.27.mha.do@0,N,transformer.27.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.27.mha.o@0,
transformer.27.mha.do1@0,N,transformer.27.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.27.mha.o1@0,
transformer.27.mha.dattn@0,N,transformer.27.mha.do1@0,transformer.27._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.27.mha.dwo@0,N,transformer.27.mha.do1@0,transformer.27.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.27.mha.wo@0,
transformer.27.mha.dv@0,N,transformer.27.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.27.mha.v@0,
transformer.27.mha.dk@0,N,transformer.27.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.27.mha.k@0,
transformer.27.mha.dq@0,N,transformer.27.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.27.mha.q@0,
transformer.27.mha.dkv@0,N,transformer.27.mha.dv@0,transformer.27.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.27.mha.dqkv@0,N,transformer.27.mha.dkv@0,transformer.27.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.27.mha.qkv@0,
transformer.27.mha.dwqkv@0,N,transformer.27.mha.dqkv@0,transformer.27.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.27.mha.wqkv@0,
transformer.27.mha.dx1@0,N,transformer.27.mha.dqkv@0,transformer.27._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.27.mha.dx@0,N,transformer.27.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.27.mha.attn_kernel.q@0,N,transformer.27.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.27.mha.attn_kernel.k@0,N,transformer.27.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.27.mha.attn_kernel.v@0,N,transformer.27.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.27.mha.attn_kernel.k1@0,N,transformer.27.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.27.mha.attn_kernel.v1@0,N,transformer.27.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.27.mha.attn_kernel.qkv@0,N,transformer.27.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.27.mha.attn_kernel.k1@0"", ""transformer.27.mha.attn_kernel.v1@0""]}"
transformer.27.mha.attn_kernel.dqkv@0,N,transformer.27.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.27.mha.attn_kernel.qkv@0,
transformer.27.mha.attn_kernel.dq@0,N,transformer.27.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.27.mha.attn_kernel.q@0,
transformer.27.mha.attn_kernel.dk@0,N,transformer.27.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.27.mha.attn_kernel.dv@0,N,transformer.27.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.27.mha_res.x1@0,N,transformer.27.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.27.mha_res.x2@0,N,transformer.27.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.27.mha_res.y@0,N,transformer.27.mha_res.x1@0,transformer.27.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.27.mha_res.dy@0,N,transformer.27.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.27.mha_res.y@0,
transformer.27.mha_res.dx1@0,N,transformer.27.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.27.mha_res.x1@0,
transformer.27.mha_res.dx2@0,N,transformer.27.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.27.mha_res.x2@0,
transformer.27.post_attn_norm.x@0,N,transformer.27.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.27.post_attn_norm.y@0,N,transformer.27.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.27.post_attn_norm.dy@0,N,transformer.27.ffn.dx0@0,transformer.27.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.27.post_attn_norm.y@0,
transformer.27.post_attn_norm.dx@0,N,transformer.27.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.27.post_attn_norm.x@0,
transformer.27.ffn.x0@0,N,transformer.27.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.27.ffn.wgate@0,N,transformer.27._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.27.ffn.wdown@0,N,transformer.27._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.27.ffn.x00@0,N,transformer.27.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.27.ffn.xgate@0,N,transformer.27.ffn.x00@0,transformer.27.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.27.ffn.xdown1@0,N,transformer.27.ffn.xgate@0,transformer.27.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.27.ffn.xdown@0,N,transformer.27.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.27.ffn.dxdown@0,N,transformer.27.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.27.ffn.xdown@0,
transformer.27.ffn.dxdown2@0,N,transformer.27.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.27.ffn.dwdown@0,N,transformer.27.ffn.dxdown2@0,transformer.27.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.27.ffn.wdown@0,
transformer.27.ffn.dxgate@0,N,transformer.27.ffn.dxdown2@0,transformer.27._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.27.ffn.xgate@0,
transformer.27.ffn.x01@0,N,transformer.27.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.27.ffn.dwgate@0,N,transformer.27.ffn.dxgate@0,transformer.27.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.27.ffn.wgate@0,
transformer.27.ffn.dx000@0,N,transformer.27.ffn.dxgate@0,transformer.27._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.27.ffn.dx0@0,N,transformer.27.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.27.ffn_res.x1@0,N,transformer.27.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.27.ffn_res.x2@0,N,transformer.27.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.27.ffn_res.y@0,N,transformer.27.ffn_res.x1@0,transformer.27.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.27.ffn_res.dy@0,N,transformer.28.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.27.ffn_res.y@0,
transformer.27.ffn_res.dx1@0,N,transformer.27.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.27.ffn_res.x1@0,
transformer.27.ffn_res.dx2@0,N,transformer.27.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.27.ffn_res.x2@0,
transformer.27._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.27._assembled_weight@0,N,transformer.27._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.27._sharded_grad@0,N,transformer.27._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.27._sharded_weight@0,
transformer.27._assembled_grad@0,N,transformer.27.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.27.mha.dwo@0"", ""transformer.27.ffn.dwgate@0"", ""transformer.27.ffn.dwdown@0""]}"
transformer.27._mha.wqkv_backward@0,N,transformer.27._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.27._mha.wo_backward@0,N,transformer.27._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.27._ffn.wgate_backward@0,N,transformer.27._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.27._ffn.wdown_backward@0,N,transformer.27._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.27._assembled_weight_backward@0,N,transformer.27._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.28.input_norm.x@0,N,transformer.27.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.28.input_norm.y@0,N,transformer.28.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.28.input_norm.dy@0,N,transformer.28.mha.dx@0,transformer.28.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.28.input_norm.y@0,
transformer.28.input_norm.dx@0,N,transformer.28.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.28.input_norm.x@0,
transformer.28.mha.x@0,N,transformer.28.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.28.mha.wqkv@0,N,transformer.28._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.28.mha.qkv@0,N,transformer.28.mha.x@0,transformer.28.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.28.mha.q@0,N,transformer.28.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.28.mha.k@0,N,transformer.28.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.28.mha.v@0,N,transformer.28.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.28.mha.attn@0,N,transformer.28.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.28.mha.wo@0,N,transformer.28._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.28.mha.o1@0,N,transformer.28.mha.attn@0,transformer.28.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.28.mha.o@0,N,transformer.28.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.28.mha.do@0,N,transformer.28.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.28.mha.o@0,
transformer.28.mha.do1@0,N,transformer.28.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.28.mha.o1@0,
transformer.28.mha.dattn@0,N,transformer.28.mha.do1@0,transformer.28._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.28.mha.dwo@0,N,transformer.28.mha.do1@0,transformer.28.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.28.mha.wo@0,
transformer.28.mha.dv@0,N,transformer.28.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.28.mha.v@0,
transformer.28.mha.dk@0,N,transformer.28.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.28.mha.k@0,
transformer.28.mha.dq@0,N,transformer.28.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.28.mha.q@0,
transformer.28.mha.dkv@0,N,transformer.28.mha.dv@0,transformer.28.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.28.mha.dqkv@0,N,transformer.28.mha.dkv@0,transformer.28.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.28.mha.qkv@0,
transformer.28.mha.dwqkv@0,N,transformer.28.mha.dqkv@0,transformer.28.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.28.mha.wqkv@0,
transformer.28.mha.dx1@0,N,transformer.28.mha.dqkv@0,transformer.28._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.28.mha.dx@0,N,transformer.28.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.28.mha.attn_kernel.q@0,N,transformer.28.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.28.mha.attn_kernel.k@0,N,transformer.28.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.28.mha.attn_kernel.v@0,N,transformer.28.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.28.mha.attn_kernel.k1@0,N,transformer.28.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.28.mha.attn_kernel.v1@0,N,transformer.28.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.28.mha.attn_kernel.qkv@0,N,transformer.28.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.28.mha.attn_kernel.k1@0"", ""transformer.28.mha.attn_kernel.v1@0""]}"
transformer.28.mha.attn_kernel.dqkv@0,N,transformer.28.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.28.mha.attn_kernel.qkv@0,
transformer.28.mha.attn_kernel.dq@0,N,transformer.28.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.28.mha.attn_kernel.q@0,
transformer.28.mha.attn_kernel.dk@0,N,transformer.28.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.28.mha.attn_kernel.dv@0,N,transformer.28.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.28.mha_res.x1@0,N,transformer.28.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.28.mha_res.x2@0,N,transformer.28.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.28.mha_res.y@0,N,transformer.28.mha_res.x1@0,transformer.28.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.28.mha_res.dy@0,N,transformer.28.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.28.mha_res.y@0,
transformer.28.mha_res.dx1@0,N,transformer.28.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.28.mha_res.x1@0,
transformer.28.mha_res.dx2@0,N,transformer.28.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.28.mha_res.x2@0,
transformer.28.post_attn_norm.x@0,N,transformer.28.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.28.post_attn_norm.y@0,N,transformer.28.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.28.post_attn_norm.dy@0,N,transformer.28.ffn.dx0@0,transformer.28.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.28.post_attn_norm.y@0,
transformer.28.post_attn_norm.dx@0,N,transformer.28.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.28.post_attn_norm.x@0,
transformer.28.ffn.x0@0,N,transformer.28.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.28.ffn.wgate@0,N,transformer.28._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.28.ffn.wdown@0,N,transformer.28._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.28.ffn.x00@0,N,transformer.28.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.28.ffn.xgate@0,N,transformer.28.ffn.x00@0,transformer.28.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.28.ffn.xdown1@0,N,transformer.28.ffn.xgate@0,transformer.28.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.28.ffn.xdown@0,N,transformer.28.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.28.ffn.dxdown@0,N,transformer.28.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.28.ffn.xdown@0,
transformer.28.ffn.dxdown2@0,N,transformer.28.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.28.ffn.dwdown@0,N,transformer.28.ffn.dxdown2@0,transformer.28.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.28.ffn.wdown@0,
transformer.28.ffn.dxgate@0,N,transformer.28.ffn.dxdown2@0,transformer.28._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.28.ffn.xgate@0,
transformer.28.ffn.x01@0,N,transformer.28.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.28.ffn.dwgate@0,N,transformer.28.ffn.dxgate@0,transformer.28.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.28.ffn.wgate@0,
transformer.28.ffn.dx000@0,N,transformer.28.ffn.dxgate@0,transformer.28._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.28.ffn.dx0@0,N,transformer.28.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.28.ffn_res.x1@0,N,transformer.28.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.28.ffn_res.x2@0,N,transformer.28.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.28.ffn_res.y@0,N,transformer.28.ffn_res.x1@0,transformer.28.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.28.ffn_res.dy@0,N,transformer.29.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.28.ffn_res.y@0,
transformer.28.ffn_res.dx1@0,N,transformer.28.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.28.ffn_res.x1@0,
transformer.28.ffn_res.dx2@0,N,transformer.28.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.28.ffn_res.x2@0,
transformer.28._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.28._assembled_weight@0,N,transformer.28._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.28._sharded_grad@0,N,transformer.28._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.28._sharded_weight@0,
transformer.28._assembled_grad@0,N,transformer.28.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.28.mha.dwo@0"", ""transformer.28.ffn.dwgate@0"", ""transformer.28.ffn.dwdown@0""]}"
transformer.28._mha.wqkv_backward@0,N,transformer.28._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.28._mha.wo_backward@0,N,transformer.28._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.28._ffn.wgate_backward@0,N,transformer.28._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.28._ffn.wdown_backward@0,N,transformer.28._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.28._assembled_weight_backward@0,N,transformer.28._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.29.input_norm.x@0,N,transformer.28.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.29.input_norm.y@0,N,transformer.29.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.29.input_norm.dy@0,N,transformer.29.mha.dx@0,transformer.29.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.29.input_norm.y@0,
transformer.29.input_norm.dx@0,N,transformer.29.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.29.input_norm.x@0,
transformer.29.mha.x@0,N,transformer.29.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.29.mha.wqkv@0,N,transformer.29._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.29.mha.qkv@0,N,transformer.29.mha.x@0,transformer.29.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.29.mha.q@0,N,transformer.29.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.29.mha.k@0,N,transformer.29.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.29.mha.v@0,N,transformer.29.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.29.mha.attn@0,N,transformer.29.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.29.mha.wo@0,N,transformer.29._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.29.mha.o1@0,N,transformer.29.mha.attn@0,transformer.29.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.29.mha.o@0,N,transformer.29.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.29.mha.do@0,N,transformer.29.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.29.mha.o@0,
transformer.29.mha.do1@0,N,transformer.29.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.29.mha.o1@0,
transformer.29.mha.dattn@0,N,transformer.29.mha.do1@0,transformer.29._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.29.mha.dwo@0,N,transformer.29.mha.do1@0,transformer.29.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.29.mha.wo@0,
transformer.29.mha.dv@0,N,transformer.29.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.29.mha.v@0,
transformer.29.mha.dk@0,N,transformer.29.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.29.mha.k@0,
transformer.29.mha.dq@0,N,transformer.29.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.29.mha.q@0,
transformer.29.mha.dkv@0,N,transformer.29.mha.dv@0,transformer.29.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.29.mha.dqkv@0,N,transformer.29.mha.dkv@0,transformer.29.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.29.mha.qkv@0,
transformer.29.mha.dwqkv@0,N,transformer.29.mha.dqkv@0,transformer.29.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.29.mha.wqkv@0,
transformer.29.mha.dx1@0,N,transformer.29.mha.dqkv@0,transformer.29._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.29.mha.dx@0,N,transformer.29.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.29.mha.attn_kernel.q@0,N,transformer.29.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.29.mha.attn_kernel.k@0,N,transformer.29.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.29.mha.attn_kernel.v@0,N,transformer.29.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.29.mha.attn_kernel.k1@0,N,transformer.29.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.29.mha.attn_kernel.v1@0,N,transformer.29.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.29.mha.attn_kernel.qkv@0,N,transformer.29.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.29.mha.attn_kernel.k1@0"", ""transformer.29.mha.attn_kernel.v1@0""]}"
transformer.29.mha.attn_kernel.dqkv@0,N,transformer.29.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.29.mha.attn_kernel.qkv@0,
transformer.29.mha.attn_kernel.dq@0,N,transformer.29.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.29.mha.attn_kernel.q@0,
transformer.29.mha.attn_kernel.dk@0,N,transformer.29.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.29.mha.attn_kernel.dv@0,N,transformer.29.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.29.mha_res.x1@0,N,transformer.29.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.29.mha_res.x2@0,N,transformer.29.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.29.mha_res.y@0,N,transformer.29.mha_res.x1@0,transformer.29.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.29.mha_res.dy@0,N,transformer.29.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.29.mha_res.y@0,
transformer.29.mha_res.dx1@0,N,transformer.29.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.29.mha_res.x1@0,
transformer.29.mha_res.dx2@0,N,transformer.29.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.29.mha_res.x2@0,
transformer.29.post_attn_norm.x@0,N,transformer.29.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.29.post_attn_norm.y@0,N,transformer.29.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.29.post_attn_norm.dy@0,N,transformer.29.ffn.dx0@0,transformer.29.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.29.post_attn_norm.y@0,
transformer.29.post_attn_norm.dx@0,N,transformer.29.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.29.post_attn_norm.x@0,
transformer.29.ffn.x0@0,N,transformer.29.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.29.ffn.wgate@0,N,transformer.29._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.29.ffn.wdown@0,N,transformer.29._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.29.ffn.x00@0,N,transformer.29.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.29.ffn.xgate@0,N,transformer.29.ffn.x00@0,transformer.29.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.29.ffn.xdown1@0,N,transformer.29.ffn.xgate@0,transformer.29.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.29.ffn.xdown@0,N,transformer.29.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.29.ffn.dxdown@0,N,transformer.29.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.29.ffn.xdown@0,
transformer.29.ffn.dxdown2@0,N,transformer.29.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.29.ffn.dwdown@0,N,transformer.29.ffn.dxdown2@0,transformer.29.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.29.ffn.wdown@0,
transformer.29.ffn.dxgate@0,N,transformer.29.ffn.dxdown2@0,transformer.29._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.29.ffn.xgate@0,
transformer.29.ffn.x01@0,N,transformer.29.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.29.ffn.dwgate@0,N,transformer.29.ffn.dxgate@0,transformer.29.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.29.ffn.wgate@0,
transformer.29.ffn.dx000@0,N,transformer.29.ffn.dxgate@0,transformer.29._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.29.ffn.dx0@0,N,transformer.29.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.29.ffn_res.x1@0,N,transformer.29.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.29.ffn_res.x2@0,N,transformer.29.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.29.ffn_res.y@0,N,transformer.29.ffn_res.x1@0,transformer.29.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.29.ffn_res.dy@0,N,transformer.30.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.29.ffn_res.y@0,
transformer.29.ffn_res.dx1@0,N,transformer.29.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.29.ffn_res.x1@0,
transformer.29.ffn_res.dx2@0,N,transformer.29.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.29.ffn_res.x2@0,
transformer.29._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.29._assembled_weight@0,N,transformer.29._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.29._sharded_grad@0,N,transformer.29._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.29._sharded_weight@0,
transformer.29._assembled_grad@0,N,transformer.29.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.29.mha.dwo@0"", ""transformer.29.ffn.dwgate@0"", ""transformer.29.ffn.dwdown@0""]}"
transformer.29._mha.wqkv_backward@0,N,transformer.29._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.29._mha.wo_backward@0,N,transformer.29._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.29._ffn.wgate_backward@0,N,transformer.29._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.29._ffn.wdown_backward@0,N,transformer.29._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.29._assembled_weight_backward@0,N,transformer.29._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.30.input_norm.x@0,N,transformer.29.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.30.input_norm.y@0,N,transformer.30.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.30.input_norm.dy@0,N,transformer.30.mha.dx@0,transformer.30.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.30.input_norm.y@0,
transformer.30.input_norm.dx@0,N,transformer.30.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.30.input_norm.x@0,
transformer.30.mha.x@0,N,transformer.30.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.30.mha.wqkv@0,N,transformer.30._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.30.mha.qkv@0,N,transformer.30.mha.x@0,transformer.30.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.30.mha.q@0,N,transformer.30.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.30.mha.k@0,N,transformer.30.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.30.mha.v@0,N,transformer.30.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.30.mha.attn@0,N,transformer.30.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.30.mha.wo@0,N,transformer.30._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.30.mha.o1@0,N,transformer.30.mha.attn@0,transformer.30.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.30.mha.o@0,N,transformer.30.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.30.mha.do@0,N,transformer.30.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.30.mha.o@0,
transformer.30.mha.do1@0,N,transformer.30.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.30.mha.o1@0,
transformer.30.mha.dattn@0,N,transformer.30.mha.do1@0,transformer.30._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.30.mha.dwo@0,N,transformer.30.mha.do1@0,transformer.30.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.30.mha.wo@0,
transformer.30.mha.dv@0,N,transformer.30.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.30.mha.v@0,
transformer.30.mha.dk@0,N,transformer.30.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.30.mha.k@0,
transformer.30.mha.dq@0,N,transformer.30.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.30.mha.q@0,
transformer.30.mha.dkv@0,N,transformer.30.mha.dv@0,transformer.30.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.30.mha.dqkv@0,N,transformer.30.mha.dkv@0,transformer.30.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.30.mha.qkv@0,
transformer.30.mha.dwqkv@0,N,transformer.30.mha.dqkv@0,transformer.30.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.30.mha.wqkv@0,
transformer.30.mha.dx1@0,N,transformer.30.mha.dqkv@0,transformer.30._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.30.mha.dx@0,N,transformer.30.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.30.mha.attn_kernel.q@0,N,transformer.30.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.30.mha.attn_kernel.k@0,N,transformer.30.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.30.mha.attn_kernel.v@0,N,transformer.30.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.30.mha.attn_kernel.k1@0,N,transformer.30.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.30.mha.attn_kernel.v1@0,N,transformer.30.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.30.mha.attn_kernel.qkv@0,N,transformer.30.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.30.mha.attn_kernel.k1@0"", ""transformer.30.mha.attn_kernel.v1@0""]}"
transformer.30.mha.attn_kernel.dqkv@0,N,transformer.30.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.30.mha.attn_kernel.qkv@0,
transformer.30.mha.attn_kernel.dq@0,N,transformer.30.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.30.mha.attn_kernel.q@0,
transformer.30.mha.attn_kernel.dk@0,N,transformer.30.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.30.mha.attn_kernel.dv@0,N,transformer.30.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.30.mha_res.x1@0,N,transformer.30.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.30.mha_res.x2@0,N,transformer.30.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.30.mha_res.y@0,N,transformer.30.mha_res.x1@0,transformer.30.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.30.mha_res.dy@0,N,transformer.30.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.30.mha_res.y@0,
transformer.30.mha_res.dx1@0,N,transformer.30.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.30.mha_res.x1@0,
transformer.30.mha_res.dx2@0,N,transformer.30.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.30.mha_res.x2@0,
transformer.30.post_attn_norm.x@0,N,transformer.30.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.30.post_attn_norm.y@0,N,transformer.30.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.30.post_attn_norm.dy@0,N,transformer.30.ffn.dx0@0,transformer.30.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.30.post_attn_norm.y@0,
transformer.30.post_attn_norm.dx@0,N,transformer.30.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.30.post_attn_norm.x@0,
transformer.30.ffn.x0@0,N,transformer.30.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.30.ffn.wgate@0,N,transformer.30._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.30.ffn.wdown@0,N,transformer.30._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.30.ffn.x00@0,N,transformer.30.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.30.ffn.xgate@0,N,transformer.30.ffn.x00@0,transformer.30.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.30.ffn.xdown1@0,N,transformer.30.ffn.xgate@0,transformer.30.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.30.ffn.xdown@0,N,transformer.30.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.30.ffn.dxdown@0,N,transformer.30.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.30.ffn.xdown@0,
transformer.30.ffn.dxdown2@0,N,transformer.30.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.30.ffn.dwdown@0,N,transformer.30.ffn.dxdown2@0,transformer.30.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.30.ffn.wdown@0,
transformer.30.ffn.dxgate@0,N,transformer.30.ffn.dxdown2@0,transformer.30._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.30.ffn.xgate@0,
transformer.30.ffn.x01@0,N,transformer.30.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.30.ffn.dwgate@0,N,transformer.30.ffn.dxgate@0,transformer.30.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.30.ffn.wgate@0,
transformer.30.ffn.dx000@0,N,transformer.30.ffn.dxgate@0,transformer.30._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.30.ffn.dx0@0,N,transformer.30.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.30.ffn_res.x1@0,N,transformer.30.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.30.ffn_res.x2@0,N,transformer.30.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.30.ffn_res.y@0,N,transformer.30.ffn_res.x1@0,transformer.30.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.30.ffn_res.dy@0,N,transformer.31.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.30.ffn_res.y@0,
transformer.30.ffn_res.dx1@0,N,transformer.30.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.30.ffn_res.x1@0,
transformer.30.ffn_res.dx2@0,N,transformer.30.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.30.ffn_res.x2@0,
transformer.30._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.30._assembled_weight@0,N,transformer.30._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.30._sharded_grad@0,N,transformer.30._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.30._sharded_weight@0,
transformer.30._assembled_grad@0,N,transformer.30.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.30.mha.dwo@0"", ""transformer.30.ffn.dwgate@0"", ""transformer.30.ffn.dwdown@0""]}"
transformer.30._mha.wqkv_backward@0,N,transformer.30._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.30._mha.wo_backward@0,N,transformer.30._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.30._ffn.wgate_backward@0,N,transformer.30._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.30._ffn.wdown_backward@0,N,transformer.30._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.30._assembled_weight_backward@0,N,transformer.30._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.31.input_norm.x@0,N,transformer.30.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.31.input_norm.y@0,N,transformer.31.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.31.input_norm.dy@0,N,transformer.31.mha.dx@0,transformer.31.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.31.input_norm.y@0,
transformer.31.input_norm.dx@0,N,transformer.31.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.31.input_norm.x@0,
transformer.31.mha.x@0,N,transformer.31.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.31.mha.wqkv@0,N,transformer.31._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.31.mha.qkv@0,N,transformer.31.mha.x@0,transformer.31.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.31.mha.q@0,N,transformer.31.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.31.mha.k@0,N,transformer.31.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.31.mha.v@0,N,transformer.31.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.31.mha.attn@0,N,transformer.31.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.31.mha.wo@0,N,transformer.31._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.31.mha.o1@0,N,transformer.31.mha.attn@0,transformer.31.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.31.mha.o@0,N,transformer.31.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.31.mha.do@0,N,transformer.31.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.31.mha.o@0,
transformer.31.mha.do1@0,N,transformer.31.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.31.mha.o1@0,
transformer.31.mha.dattn@0,N,transformer.31.mha.do1@0,transformer.31._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.31.mha.dwo@0,N,transformer.31.mha.do1@0,transformer.31.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.31.mha.wo@0,
transformer.31.mha.dv@0,N,transformer.31.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.31.mha.v@0,
transformer.31.mha.dk@0,N,transformer.31.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.31.mha.k@0,
transformer.31.mha.dq@0,N,transformer.31.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.31.mha.q@0,
transformer.31.mha.dkv@0,N,transformer.31.mha.dv@0,transformer.31.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.31.mha.dqkv@0,N,transformer.31.mha.dkv@0,transformer.31.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.31.mha.qkv@0,
transformer.31.mha.dwqkv@0,N,transformer.31.mha.dqkv@0,transformer.31.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.31.mha.wqkv@0,
transformer.31.mha.dx1@0,N,transformer.31.mha.dqkv@0,transformer.31._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.31.mha.dx@0,N,transformer.31.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.31.mha.attn_kernel.q@0,N,transformer.31.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.31.mha.attn_kernel.k@0,N,transformer.31.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.31.mha.attn_kernel.v@0,N,transformer.31.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.31.mha.attn_kernel.k1@0,N,transformer.31.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.31.mha.attn_kernel.v1@0,N,transformer.31.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.31.mha.attn_kernel.qkv@0,N,transformer.31.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.31.mha.attn_kernel.k1@0"", ""transformer.31.mha.attn_kernel.v1@0""]}"
transformer.31.mha.attn_kernel.dqkv@0,N,transformer.31.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.31.mha.attn_kernel.qkv@0,
transformer.31.mha.attn_kernel.dq@0,N,transformer.31.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.31.mha.attn_kernel.q@0,
transformer.31.mha.attn_kernel.dk@0,N,transformer.31.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.31.mha.attn_kernel.dv@0,N,transformer.31.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.31.mha_res.x1@0,N,transformer.31.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.31.mha_res.x2@0,N,transformer.31.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.31.mha_res.y@0,N,transformer.31.mha_res.x1@0,transformer.31.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.31.mha_res.dy@0,N,transformer.31.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.31.mha_res.y@0,
transformer.31.mha_res.dx1@0,N,transformer.31.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.31.mha_res.x1@0,
transformer.31.mha_res.dx2@0,N,transformer.31.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.31.mha_res.x2@0,
transformer.31.post_attn_norm.x@0,N,transformer.31.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.31.post_attn_norm.y@0,N,transformer.31.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.31.post_attn_norm.dy@0,N,transformer.31.ffn.dx0@0,transformer.31.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.31.post_attn_norm.y@0,
transformer.31.post_attn_norm.dx@0,N,transformer.31.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.31.post_attn_norm.x@0,
transformer.31.ffn.x0@0,N,transformer.31.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.31.ffn.wgate@0,N,transformer.31._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.31.ffn.wdown@0,N,transformer.31._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.31.ffn.x00@0,N,transformer.31.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.31.ffn.xgate@0,N,transformer.31.ffn.x00@0,transformer.31.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.31.ffn.xdown1@0,N,transformer.31.ffn.xgate@0,transformer.31.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.31.ffn.xdown@0,N,transformer.31.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.31.ffn.dxdown@0,N,transformer.31.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.31.ffn.xdown@0,
transformer.31.ffn.dxdown2@0,N,transformer.31.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.31.ffn.dwdown@0,N,transformer.31.ffn.dxdown2@0,transformer.31.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.31.ffn.wdown@0,
transformer.31.ffn.dxgate@0,N,transformer.31.ffn.dxdown2@0,transformer.31._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.31.ffn.xgate@0,
transformer.31.ffn.x01@0,N,transformer.31.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.31.ffn.dwgate@0,N,transformer.31.ffn.dxgate@0,transformer.31.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.31.ffn.wgate@0,
transformer.31.ffn.dx000@0,N,transformer.31.ffn.dxgate@0,transformer.31._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.31.ffn.dx0@0,N,transformer.31.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.31.ffn_res.x1@0,N,transformer.31.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.31.ffn_res.x2@0,N,transformer.31.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.31.ffn_res.y@0,N,transformer.31.ffn_res.x1@0,transformer.31.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.31.ffn_res.dy@0,N,transformer.32.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.31.ffn_res.y@0,
transformer.31.ffn_res.dx1@0,N,transformer.31.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.31.ffn_res.x1@0,
transformer.31.ffn_res.dx2@0,N,transformer.31.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.31.ffn_res.x2@0,
transformer.31._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.31._assembled_weight@0,N,transformer.31._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.31._sharded_grad@0,N,transformer.31._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.31._sharded_weight@0,
transformer.31._assembled_grad@0,N,transformer.31.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.31.mha.dwo@0"", ""transformer.31.ffn.dwgate@0"", ""transformer.31.ffn.dwdown@0""]}"
transformer.31._mha.wqkv_backward@0,N,transformer.31._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.31._mha.wo_backward@0,N,transformer.31._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.31._ffn.wgate_backward@0,N,transformer.31._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.31._ffn.wdown_backward@0,N,transformer.31._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.31._assembled_weight_backward@0,N,transformer.31._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.32.input_norm.x@0,N,transformer.31.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.32.input_norm.y@0,N,transformer.32.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.32.input_norm.dy@0,N,transformer.32.mha.dx@0,transformer.32.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.32.input_norm.y@0,
transformer.32.input_norm.dx@0,N,transformer.32.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.32.input_norm.x@0,
transformer.32.mha.x@0,N,transformer.32.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.32.mha.wqkv@0,N,transformer.32._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.32.mha.qkv@0,N,transformer.32.mha.x@0,transformer.32.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.32.mha.q@0,N,transformer.32.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.32.mha.k@0,N,transformer.32.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.32.mha.v@0,N,transformer.32.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.32.mha.attn@0,N,transformer.32.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.32.mha.wo@0,N,transformer.32._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.32.mha.o1@0,N,transformer.32.mha.attn@0,transformer.32.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.32.mha.o@0,N,transformer.32.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.32.mha.do@0,N,transformer.32.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.32.mha.o@0,
transformer.32.mha.do1@0,N,transformer.32.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.32.mha.o1@0,
transformer.32.mha.dattn@0,N,transformer.32.mha.do1@0,transformer.32._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.32.mha.dwo@0,N,transformer.32.mha.do1@0,transformer.32.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.32.mha.wo@0,
transformer.32.mha.dv@0,N,transformer.32.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.32.mha.v@0,
transformer.32.mha.dk@0,N,transformer.32.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.32.mha.k@0,
transformer.32.mha.dq@0,N,transformer.32.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.32.mha.q@0,
transformer.32.mha.dkv@0,N,transformer.32.mha.dv@0,transformer.32.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.32.mha.dqkv@0,N,transformer.32.mha.dkv@0,transformer.32.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.32.mha.qkv@0,
transformer.32.mha.dwqkv@0,N,transformer.32.mha.dqkv@0,transformer.32.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.32.mha.wqkv@0,
transformer.32.mha.dx1@0,N,transformer.32.mha.dqkv@0,transformer.32._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.32.mha.dx@0,N,transformer.32.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.32.mha.attn_kernel.q@0,N,transformer.32.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.32.mha.attn_kernel.k@0,N,transformer.32.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.32.mha.attn_kernel.v@0,N,transformer.32.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.32.mha.attn_kernel.k1@0,N,transformer.32.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.32.mha.attn_kernel.v1@0,N,transformer.32.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.32.mha.attn_kernel.qkv@0,N,transformer.32.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.32.mha.attn_kernel.k1@0"", ""transformer.32.mha.attn_kernel.v1@0""]}"
transformer.32.mha.attn_kernel.dqkv@0,N,transformer.32.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.32.mha.attn_kernel.qkv@0,
transformer.32.mha.attn_kernel.dq@0,N,transformer.32.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.32.mha.attn_kernel.q@0,
transformer.32.mha.attn_kernel.dk@0,N,transformer.32.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.32.mha.attn_kernel.dv@0,N,transformer.32.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.32.mha_res.x1@0,N,transformer.32.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.32.mha_res.x2@0,N,transformer.32.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.32.mha_res.y@0,N,transformer.32.mha_res.x1@0,transformer.32.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.32.mha_res.dy@0,N,transformer.32.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.32.mha_res.y@0,
transformer.32.mha_res.dx1@0,N,transformer.32.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.32.mha_res.x1@0,
transformer.32.mha_res.dx2@0,N,transformer.32.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.32.mha_res.x2@0,
transformer.32.post_attn_norm.x@0,N,transformer.32.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.32.post_attn_norm.y@0,N,transformer.32.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.32.post_attn_norm.dy@0,N,transformer.32.ffn.dx0@0,transformer.32.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.32.post_attn_norm.y@0,
transformer.32.post_attn_norm.dx@0,N,transformer.32.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.32.post_attn_norm.x@0,
transformer.32.ffn.x0@0,N,transformer.32.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.32.ffn.wgate@0,N,transformer.32._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.32.ffn.wdown@0,N,transformer.32._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.32.ffn.x00@0,N,transformer.32.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.32.ffn.xgate@0,N,transformer.32.ffn.x00@0,transformer.32.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.32.ffn.xdown1@0,N,transformer.32.ffn.xgate@0,transformer.32.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.32.ffn.xdown@0,N,transformer.32.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.32.ffn.dxdown@0,N,transformer.32.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.32.ffn.xdown@0,
transformer.32.ffn.dxdown2@0,N,transformer.32.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.32.ffn.dwdown@0,N,transformer.32.ffn.dxdown2@0,transformer.32.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.32.ffn.wdown@0,
transformer.32.ffn.dxgate@0,N,transformer.32.ffn.dxdown2@0,transformer.32._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.32.ffn.xgate@0,
transformer.32.ffn.x01@0,N,transformer.32.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.32.ffn.dwgate@0,N,transformer.32.ffn.dxgate@0,transformer.32.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.32.ffn.wgate@0,
transformer.32.ffn.dx000@0,N,transformer.32.ffn.dxgate@0,transformer.32._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.32.ffn.dx0@0,N,transformer.32.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.32.ffn_res.x1@0,N,transformer.32.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.32.ffn_res.x2@0,N,transformer.32.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.32.ffn_res.y@0,N,transformer.32.ffn_res.x1@0,transformer.32.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.32.ffn_res.dy@0,N,transformer.33.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.32.ffn_res.y@0,
transformer.32.ffn_res.dx1@0,N,transformer.32.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.32.ffn_res.x1@0,
transformer.32.ffn_res.dx2@0,N,transformer.32.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.32.ffn_res.x2@0,
transformer.32._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.32._assembled_weight@0,N,transformer.32._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.32._sharded_grad@0,N,transformer.32._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.32._sharded_weight@0,
transformer.32._assembled_grad@0,N,transformer.32.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.32.mha.dwo@0"", ""transformer.32.ffn.dwgate@0"", ""transformer.32.ffn.dwdown@0""]}"
transformer.32._mha.wqkv_backward@0,N,transformer.32._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.32._mha.wo_backward@0,N,transformer.32._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.32._ffn.wgate_backward@0,N,transformer.32._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.32._ffn.wdown_backward@0,N,transformer.32._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.32._assembled_weight_backward@0,N,transformer.32._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.33.input_norm.x@0,N,transformer.32.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.33.input_norm.y@0,N,transformer.33.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.33.input_norm.dy@0,N,transformer.33.mha.dx@0,transformer.33.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.33.input_norm.y@0,
transformer.33.input_norm.dx@0,N,transformer.33.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.33.input_norm.x@0,
transformer.33.mha.x@0,N,transformer.33.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.33.mha.wqkv@0,N,transformer.33._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.33.mha.qkv@0,N,transformer.33.mha.x@0,transformer.33.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.33.mha.q@0,N,transformer.33.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.33.mha.k@0,N,transformer.33.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.33.mha.v@0,N,transformer.33.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.33.mha.attn@0,N,transformer.33.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.33.mha.wo@0,N,transformer.33._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.33.mha.o1@0,N,transformer.33.mha.attn@0,transformer.33.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.33.mha.o@0,N,transformer.33.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.33.mha.do@0,N,transformer.33.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.33.mha.o@0,
transformer.33.mha.do1@0,N,transformer.33.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.33.mha.o1@0,
transformer.33.mha.dattn@0,N,transformer.33.mha.do1@0,transformer.33._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.33.mha.dwo@0,N,transformer.33.mha.do1@0,transformer.33.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.33.mha.wo@0,
transformer.33.mha.dv@0,N,transformer.33.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.33.mha.v@0,
transformer.33.mha.dk@0,N,transformer.33.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.33.mha.k@0,
transformer.33.mha.dq@0,N,transformer.33.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.33.mha.q@0,
transformer.33.mha.dkv@0,N,transformer.33.mha.dv@0,transformer.33.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.33.mha.dqkv@0,N,transformer.33.mha.dkv@0,transformer.33.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.33.mha.qkv@0,
transformer.33.mha.dwqkv@0,N,transformer.33.mha.dqkv@0,transformer.33.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.33.mha.wqkv@0,
transformer.33.mha.dx1@0,N,transformer.33.mha.dqkv@0,transformer.33._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.33.mha.dx@0,N,transformer.33.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.33.mha.attn_kernel.q@0,N,transformer.33.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.33.mha.attn_kernel.k@0,N,transformer.33.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.33.mha.attn_kernel.v@0,N,transformer.33.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.33.mha.attn_kernel.k1@0,N,transformer.33.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.33.mha.attn_kernel.v1@0,N,transformer.33.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.33.mha.attn_kernel.qkv@0,N,transformer.33.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.33.mha.attn_kernel.k1@0"", ""transformer.33.mha.attn_kernel.v1@0""]}"
transformer.33.mha.attn_kernel.dqkv@0,N,transformer.33.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.33.mha.attn_kernel.qkv@0,
transformer.33.mha.attn_kernel.dq@0,N,transformer.33.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.33.mha.attn_kernel.q@0,
transformer.33.mha.attn_kernel.dk@0,N,transformer.33.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.33.mha.attn_kernel.dv@0,N,transformer.33.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.33.mha_res.x1@0,N,transformer.33.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.33.mha_res.x2@0,N,transformer.33.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.33.mha_res.y@0,N,transformer.33.mha_res.x1@0,transformer.33.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.33.mha_res.dy@0,N,transformer.33.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.33.mha_res.y@0,
transformer.33.mha_res.dx1@0,N,transformer.33.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.33.mha_res.x1@0,
transformer.33.mha_res.dx2@0,N,transformer.33.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.33.mha_res.x2@0,
transformer.33.post_attn_norm.x@0,N,transformer.33.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.33.post_attn_norm.y@0,N,transformer.33.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.33.post_attn_norm.dy@0,N,transformer.33.ffn.dx0@0,transformer.33.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.33.post_attn_norm.y@0,
transformer.33.post_attn_norm.dx@0,N,transformer.33.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.33.post_attn_norm.x@0,
transformer.33.ffn.x0@0,N,transformer.33.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.33.ffn.wgate@0,N,transformer.33._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.33.ffn.wdown@0,N,transformer.33._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.33.ffn.x00@0,N,transformer.33.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.33.ffn.xgate@0,N,transformer.33.ffn.x00@0,transformer.33.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.33.ffn.xdown1@0,N,transformer.33.ffn.xgate@0,transformer.33.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.33.ffn.xdown@0,N,transformer.33.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.33.ffn.dxdown@0,N,transformer.33.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.33.ffn.xdown@0,
transformer.33.ffn.dxdown2@0,N,transformer.33.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.33.ffn.dwdown@0,N,transformer.33.ffn.dxdown2@0,transformer.33.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.33.ffn.wdown@0,
transformer.33.ffn.dxgate@0,N,transformer.33.ffn.dxdown2@0,transformer.33._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.33.ffn.xgate@0,
transformer.33.ffn.x01@0,N,transformer.33.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.33.ffn.dwgate@0,N,transformer.33.ffn.dxgate@0,transformer.33.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.33.ffn.wgate@0,
transformer.33.ffn.dx000@0,N,transformer.33.ffn.dxgate@0,transformer.33._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.33.ffn.dx0@0,N,transformer.33.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.33.ffn_res.x1@0,N,transformer.33.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.33.ffn_res.x2@0,N,transformer.33.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.33.ffn_res.y@0,N,transformer.33.ffn_res.x1@0,transformer.33.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.33.ffn_res.dy@0,N,transformer.34.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.33.ffn_res.y@0,
transformer.33.ffn_res.dx1@0,N,transformer.33.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.33.ffn_res.x1@0,
transformer.33.ffn_res.dx2@0,N,transformer.33.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.33.ffn_res.x2@0,
transformer.33._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.33._assembled_weight@0,N,transformer.33._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.33._sharded_grad@0,N,transformer.33._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.33._sharded_weight@0,
transformer.33._assembled_grad@0,N,transformer.33.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.33.mha.dwo@0"", ""transformer.33.ffn.dwgate@0"", ""transformer.33.ffn.dwdown@0""]}"
transformer.33._mha.wqkv_backward@0,N,transformer.33._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.33._mha.wo_backward@0,N,transformer.33._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.33._ffn.wgate_backward@0,N,transformer.33._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.33._ffn.wdown_backward@0,N,transformer.33._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.33._assembled_weight_backward@0,N,transformer.33._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.34.input_norm.x@0,N,transformer.33.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.34.input_norm.y@0,N,transformer.34.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.34.input_norm.dy@0,N,transformer.34.mha.dx@0,transformer.34.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.34.input_norm.y@0,
transformer.34.input_norm.dx@0,N,transformer.34.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.34.input_norm.x@0,
transformer.34.mha.x@0,N,transformer.34.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.34.mha.wqkv@0,N,transformer.34._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.34.mha.qkv@0,N,transformer.34.mha.x@0,transformer.34.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.34.mha.q@0,N,transformer.34.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.34.mha.k@0,N,transformer.34.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.34.mha.v@0,N,transformer.34.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.34.mha.attn@0,N,transformer.34.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.34.mha.wo@0,N,transformer.34._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.34.mha.o1@0,N,transformer.34.mha.attn@0,transformer.34.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.34.mha.o@0,N,transformer.34.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.34.mha.do@0,N,transformer.34.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.34.mha.o@0,
transformer.34.mha.do1@0,N,transformer.34.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.34.mha.o1@0,
transformer.34.mha.dattn@0,N,transformer.34.mha.do1@0,transformer.34._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.34.mha.dwo@0,N,transformer.34.mha.do1@0,transformer.34.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.34.mha.wo@0,
transformer.34.mha.dv@0,N,transformer.34.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.34.mha.v@0,
transformer.34.mha.dk@0,N,transformer.34.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.34.mha.k@0,
transformer.34.mha.dq@0,N,transformer.34.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.34.mha.q@0,
transformer.34.mha.dkv@0,N,transformer.34.mha.dv@0,transformer.34.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.34.mha.dqkv@0,N,transformer.34.mha.dkv@0,transformer.34.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.34.mha.qkv@0,
transformer.34.mha.dwqkv@0,N,transformer.34.mha.dqkv@0,transformer.34.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.34.mha.wqkv@0,
transformer.34.mha.dx1@0,N,transformer.34.mha.dqkv@0,transformer.34._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.34.mha.dx@0,N,transformer.34.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.34.mha.attn_kernel.q@0,N,transformer.34.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.34.mha.attn_kernel.k@0,N,transformer.34.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.34.mha.attn_kernel.v@0,N,transformer.34.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.34.mha.attn_kernel.k1@0,N,transformer.34.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.34.mha.attn_kernel.v1@0,N,transformer.34.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.34.mha.attn_kernel.qkv@0,N,transformer.34.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.34.mha.attn_kernel.k1@0"", ""transformer.34.mha.attn_kernel.v1@0""]}"
transformer.34.mha.attn_kernel.dqkv@0,N,transformer.34.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.34.mha.attn_kernel.qkv@0,
transformer.34.mha.attn_kernel.dq@0,N,transformer.34.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.34.mha.attn_kernel.q@0,
transformer.34.mha.attn_kernel.dk@0,N,transformer.34.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.34.mha.attn_kernel.dv@0,N,transformer.34.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.34.mha_res.x1@0,N,transformer.34.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.34.mha_res.x2@0,N,transformer.34.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.34.mha_res.y@0,N,transformer.34.mha_res.x1@0,transformer.34.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.34.mha_res.dy@0,N,transformer.34.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.34.mha_res.y@0,
transformer.34.mha_res.dx1@0,N,transformer.34.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.34.mha_res.x1@0,
transformer.34.mha_res.dx2@0,N,transformer.34.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.34.mha_res.x2@0,
transformer.34.post_attn_norm.x@0,N,transformer.34.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.34.post_attn_norm.y@0,N,transformer.34.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.34.post_attn_norm.dy@0,N,transformer.34.ffn.dx0@0,transformer.34.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.34.post_attn_norm.y@0,
transformer.34.post_attn_norm.dx@0,N,transformer.34.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.34.post_attn_norm.x@0,
transformer.34.ffn.x0@0,N,transformer.34.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.34.ffn.wgate@0,N,transformer.34._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.34.ffn.wdown@0,N,transformer.34._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.34.ffn.x00@0,N,transformer.34.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.34.ffn.xgate@0,N,transformer.34.ffn.x00@0,transformer.34.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.34.ffn.xdown1@0,N,transformer.34.ffn.xgate@0,transformer.34.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.34.ffn.xdown@0,N,transformer.34.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.34.ffn.dxdown@0,N,transformer.34.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.34.ffn.xdown@0,
transformer.34.ffn.dxdown2@0,N,transformer.34.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.34.ffn.dwdown@0,N,transformer.34.ffn.dxdown2@0,transformer.34.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.34.ffn.wdown@0,
transformer.34.ffn.dxgate@0,N,transformer.34.ffn.dxdown2@0,transformer.34._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.34.ffn.xgate@0,
transformer.34.ffn.x01@0,N,transformer.34.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.34.ffn.dwgate@0,N,transformer.34.ffn.dxgate@0,transformer.34.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.34.ffn.wgate@0,
transformer.34.ffn.dx000@0,N,transformer.34.ffn.dxgate@0,transformer.34._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.34.ffn.dx0@0,N,transformer.34.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.34.ffn_res.x1@0,N,transformer.34.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.34.ffn_res.x2@0,N,transformer.34.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.34.ffn_res.y@0,N,transformer.34.ffn_res.x1@0,transformer.34.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.34.ffn_res.dy@0,N,transformer.35.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.34.ffn_res.y@0,
transformer.34.ffn_res.dx1@0,N,transformer.34.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.34.ffn_res.x1@0,
transformer.34.ffn_res.dx2@0,N,transformer.34.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.34.ffn_res.x2@0,
transformer.34._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.34._assembled_weight@0,N,transformer.34._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.34._sharded_grad@0,N,transformer.34._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.34._sharded_weight@0,
transformer.34._assembled_grad@0,N,transformer.34.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.34.mha.dwo@0"", ""transformer.34.ffn.dwgate@0"", ""transformer.34.ffn.dwdown@0""]}"
transformer.34._mha.wqkv_backward@0,N,transformer.34._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.34._mha.wo_backward@0,N,transformer.34._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.34._ffn.wgate_backward@0,N,transformer.34._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.34._ffn.wdown_backward@0,N,transformer.34._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.34._assembled_weight_backward@0,N,transformer.34._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.35.input_norm.x@0,N,transformer.34.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.35.input_norm.y@0,N,transformer.35.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.35.input_norm.dy@0,N,transformer.35.mha.dx@0,transformer.35.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.35.input_norm.y@0,
transformer.35.input_norm.dx@0,N,transformer.35.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.35.input_norm.x@0,
transformer.35.mha.x@0,N,transformer.35.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.35.mha.wqkv@0,N,transformer.35._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.35.mha.qkv@0,N,transformer.35.mha.x@0,transformer.35.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.35.mha.q@0,N,transformer.35.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.35.mha.k@0,N,transformer.35.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.35.mha.v@0,N,transformer.35.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.35.mha.attn@0,N,transformer.35.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.35.mha.wo@0,N,transformer.35._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.35.mha.o1@0,N,transformer.35.mha.attn@0,transformer.35.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.35.mha.o@0,N,transformer.35.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.35.mha.do@0,N,transformer.35.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.35.mha.o@0,
transformer.35.mha.do1@0,N,transformer.35.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.35.mha.o1@0,
transformer.35.mha.dattn@0,N,transformer.35.mha.do1@0,transformer.35._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.35.mha.dwo@0,N,transformer.35.mha.do1@0,transformer.35.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.35.mha.wo@0,
transformer.35.mha.dv@0,N,transformer.35.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.35.mha.v@0,
transformer.35.mha.dk@0,N,transformer.35.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.35.mha.k@0,
transformer.35.mha.dq@0,N,transformer.35.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.35.mha.q@0,
transformer.35.mha.dkv@0,N,transformer.35.mha.dv@0,transformer.35.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.35.mha.dqkv@0,N,transformer.35.mha.dkv@0,transformer.35.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.35.mha.qkv@0,
transformer.35.mha.dwqkv@0,N,transformer.35.mha.dqkv@0,transformer.35.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.35.mha.wqkv@0,
transformer.35.mha.dx1@0,N,transformer.35.mha.dqkv@0,transformer.35._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.35.mha.dx@0,N,transformer.35.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.35.mha.attn_kernel.q@0,N,transformer.35.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.35.mha.attn_kernel.k@0,N,transformer.35.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.35.mha.attn_kernel.v@0,N,transformer.35.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.35.mha.attn_kernel.k1@0,N,transformer.35.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.35.mha.attn_kernel.v1@0,N,transformer.35.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.35.mha.attn_kernel.qkv@0,N,transformer.35.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.35.mha.attn_kernel.k1@0"", ""transformer.35.mha.attn_kernel.v1@0""]}"
transformer.35.mha.attn_kernel.dqkv@0,N,transformer.35.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.35.mha.attn_kernel.qkv@0,
transformer.35.mha.attn_kernel.dq@0,N,transformer.35.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.35.mha.attn_kernel.q@0,
transformer.35.mha.attn_kernel.dk@0,N,transformer.35.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.35.mha.attn_kernel.dv@0,N,transformer.35.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.35.mha_res.x1@0,N,transformer.35.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.35.mha_res.x2@0,N,transformer.35.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.35.mha_res.y@0,N,transformer.35.mha_res.x1@0,transformer.35.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.35.mha_res.dy@0,N,transformer.35.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.35.mha_res.y@0,
transformer.35.mha_res.dx1@0,N,transformer.35.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.35.mha_res.x1@0,
transformer.35.mha_res.dx2@0,N,transformer.35.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.35.mha_res.x2@0,
transformer.35.post_attn_norm.x@0,N,transformer.35.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.35.post_attn_norm.y@0,N,transformer.35.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.35.post_attn_norm.dy@0,N,transformer.35.ffn.dx0@0,transformer.35.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.35.post_attn_norm.y@0,
transformer.35.post_attn_norm.dx@0,N,transformer.35.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.35.post_attn_norm.x@0,
transformer.35.ffn.x0@0,N,transformer.35.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.35.ffn.wgate@0,N,transformer.35._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.35.ffn.wdown@0,N,transformer.35._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.35.ffn.x00@0,N,transformer.35.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.35.ffn.xgate@0,N,transformer.35.ffn.x00@0,transformer.35.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.35.ffn.xdown1@0,N,transformer.35.ffn.xgate@0,transformer.35.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.35.ffn.xdown@0,N,transformer.35.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.35.ffn.dxdown@0,N,transformer.35.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.35.ffn.xdown@0,
transformer.35.ffn.dxdown2@0,N,transformer.35.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.35.ffn.dwdown@0,N,transformer.35.ffn.dxdown2@0,transformer.35.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.35.ffn.wdown@0,
transformer.35.ffn.dxgate@0,N,transformer.35.ffn.dxdown2@0,transformer.35._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.35.ffn.xgate@0,
transformer.35.ffn.x01@0,N,transformer.35.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.35.ffn.dwgate@0,N,transformer.35.ffn.dxgate@0,transformer.35.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.35.ffn.wgate@0,
transformer.35.ffn.dx000@0,N,transformer.35.ffn.dxgate@0,transformer.35._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.35.ffn.dx0@0,N,transformer.35.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.35.ffn_res.x1@0,N,transformer.35.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.35.ffn_res.x2@0,N,transformer.35.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.35.ffn_res.y@0,N,transformer.35.ffn_res.x1@0,transformer.35.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.35.ffn_res.dy@0,N,transformer.36.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.35.ffn_res.y@0,
transformer.35.ffn_res.dx1@0,N,transformer.35.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.35.ffn_res.x1@0,
transformer.35.ffn_res.dx2@0,N,transformer.35.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.35.ffn_res.x2@0,
transformer.35._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.35._assembled_weight@0,N,transformer.35._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.35._sharded_grad@0,N,transformer.35._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.35._sharded_weight@0,
transformer.35._assembled_grad@0,N,transformer.35.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.35.mha.dwo@0"", ""transformer.35.ffn.dwgate@0"", ""transformer.35.ffn.dwdown@0""]}"
transformer.35._mha.wqkv_backward@0,N,transformer.35._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.35._mha.wo_backward@0,N,transformer.35._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.35._ffn.wgate_backward@0,N,transformer.35._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.35._ffn.wdown_backward@0,N,transformer.35._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.35._assembled_weight_backward@0,N,transformer.35._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.36.input_norm.x@0,N,transformer.35.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.36.input_norm.y@0,N,transformer.36.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.36.input_norm.dy@0,N,transformer.36.mha.dx@0,transformer.36.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.36.input_norm.y@0,
transformer.36.input_norm.dx@0,N,transformer.36.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.36.input_norm.x@0,
transformer.36.mha.x@0,N,transformer.36.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.36.mha.wqkv@0,N,transformer.36._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.36.mha.qkv@0,N,transformer.36.mha.x@0,transformer.36.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.36.mha.q@0,N,transformer.36.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.36.mha.k@0,N,transformer.36.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.36.mha.v@0,N,transformer.36.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.36.mha.attn@0,N,transformer.36.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.36.mha.wo@0,N,transformer.36._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.36.mha.o1@0,N,transformer.36.mha.attn@0,transformer.36.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.36.mha.o@0,N,transformer.36.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.36.mha.do@0,N,transformer.36.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.36.mha.o@0,
transformer.36.mha.do1@0,N,transformer.36.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.36.mha.o1@0,
transformer.36.mha.dattn@0,N,transformer.36.mha.do1@0,transformer.36._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.36.mha.dwo@0,N,transformer.36.mha.do1@0,transformer.36.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.36.mha.wo@0,
transformer.36.mha.dv@0,N,transformer.36.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.36.mha.v@0,
transformer.36.mha.dk@0,N,transformer.36.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.36.mha.k@0,
transformer.36.mha.dq@0,N,transformer.36.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.36.mha.q@0,
transformer.36.mha.dkv@0,N,transformer.36.mha.dv@0,transformer.36.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.36.mha.dqkv@0,N,transformer.36.mha.dkv@0,transformer.36.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.36.mha.qkv@0,
transformer.36.mha.dwqkv@0,N,transformer.36.mha.dqkv@0,transformer.36.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.36.mha.wqkv@0,
transformer.36.mha.dx1@0,N,transformer.36.mha.dqkv@0,transformer.36._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.36.mha.dx@0,N,transformer.36.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.36.mha.attn_kernel.q@0,N,transformer.36.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.36.mha.attn_kernel.k@0,N,transformer.36.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.36.mha.attn_kernel.v@0,N,transformer.36.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.36.mha.attn_kernel.k1@0,N,transformer.36.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.36.mha.attn_kernel.v1@0,N,transformer.36.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.36.mha.attn_kernel.qkv@0,N,transformer.36.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.36.mha.attn_kernel.k1@0"", ""transformer.36.mha.attn_kernel.v1@0""]}"
transformer.36.mha.attn_kernel.dqkv@0,N,transformer.36.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.36.mha.attn_kernel.qkv@0,
transformer.36.mha.attn_kernel.dq@0,N,transformer.36.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.36.mha.attn_kernel.q@0,
transformer.36.mha.attn_kernel.dk@0,N,transformer.36.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.36.mha.attn_kernel.dv@0,N,transformer.36.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.36.mha_res.x1@0,N,transformer.36.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.36.mha_res.x2@0,N,transformer.36.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.36.mha_res.y@0,N,transformer.36.mha_res.x1@0,transformer.36.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.36.mha_res.dy@0,N,transformer.36.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.36.mha_res.y@0,
transformer.36.mha_res.dx1@0,N,transformer.36.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.36.mha_res.x1@0,
transformer.36.mha_res.dx2@0,N,transformer.36.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.36.mha_res.x2@0,
transformer.36.post_attn_norm.x@0,N,transformer.36.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.36.post_attn_norm.y@0,N,transformer.36.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.36.post_attn_norm.dy@0,N,transformer.36.ffn.dx0@0,transformer.36.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.36.post_attn_norm.y@0,
transformer.36.post_attn_norm.dx@0,N,transformer.36.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.36.post_attn_norm.x@0,
transformer.36.ffn.x0@0,N,transformer.36.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.36.ffn.wgate@0,N,transformer.36._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.36.ffn.wdown@0,N,transformer.36._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.36.ffn.x00@0,N,transformer.36.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.36.ffn.xgate@0,N,transformer.36.ffn.x00@0,transformer.36.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.36.ffn.xdown1@0,N,transformer.36.ffn.xgate@0,transformer.36.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.36.ffn.xdown@0,N,transformer.36.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.36.ffn.dxdown@0,N,transformer.36.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.36.ffn.xdown@0,
transformer.36.ffn.dxdown2@0,N,transformer.36.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.36.ffn.dwdown@0,N,transformer.36.ffn.dxdown2@0,transformer.36.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.36.ffn.wdown@0,
transformer.36.ffn.dxgate@0,N,transformer.36.ffn.dxdown2@0,transformer.36._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.36.ffn.xgate@0,
transformer.36.ffn.x01@0,N,transformer.36.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.36.ffn.dwgate@0,N,transformer.36.ffn.dxgate@0,transformer.36.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.36.ffn.wgate@0,
transformer.36.ffn.dx000@0,N,transformer.36.ffn.dxgate@0,transformer.36._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.36.ffn.dx0@0,N,transformer.36.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.36.ffn_res.x1@0,N,transformer.36.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.36.ffn_res.x2@0,N,transformer.36.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.36.ffn_res.y@0,N,transformer.36.ffn_res.x1@0,transformer.36.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.36.ffn_res.dy@0,N,transformer.37.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.36.ffn_res.y@0,
transformer.36.ffn_res.dx1@0,N,transformer.36.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.36.ffn_res.x1@0,
transformer.36.ffn_res.dx2@0,N,transformer.36.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.36.ffn_res.x2@0,
transformer.36._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.36._assembled_weight@0,N,transformer.36._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.36._sharded_grad@0,N,transformer.36._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.36._sharded_weight@0,
transformer.36._assembled_grad@0,N,transformer.36.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.36.mha.dwo@0"", ""transformer.36.ffn.dwgate@0"", ""transformer.36.ffn.dwdown@0""]}"
transformer.36._mha.wqkv_backward@0,N,transformer.36._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.36._mha.wo_backward@0,N,transformer.36._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.36._ffn.wgate_backward@0,N,transformer.36._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.36._ffn.wdown_backward@0,N,transformer.36._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.36._assembled_weight_backward@0,N,transformer.36._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.37.input_norm.x@0,N,transformer.36.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.37.input_norm.y@0,N,transformer.37.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.37.input_norm.dy@0,N,transformer.37.mha.dx@0,transformer.37.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.37.input_norm.y@0,
transformer.37.input_norm.dx@0,N,transformer.37.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.37.input_norm.x@0,
transformer.37.mha.x@0,N,transformer.37.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.37.mha.wqkv@0,N,transformer.37._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.37.mha.qkv@0,N,transformer.37.mha.x@0,transformer.37.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.37.mha.q@0,N,transformer.37.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.37.mha.k@0,N,transformer.37.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.37.mha.v@0,N,transformer.37.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.37.mha.attn@0,N,transformer.37.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.37.mha.wo@0,N,transformer.37._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.37.mha.o1@0,N,transformer.37.mha.attn@0,transformer.37.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.37.mha.o@0,N,transformer.37.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.37.mha.do@0,N,transformer.37.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.37.mha.o@0,
transformer.37.mha.do1@0,N,transformer.37.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.37.mha.o1@0,
transformer.37.mha.dattn@0,N,transformer.37.mha.do1@0,transformer.37._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.37.mha.dwo@0,N,transformer.37.mha.do1@0,transformer.37.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.37.mha.wo@0,
transformer.37.mha.dv@0,N,transformer.37.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.37.mha.v@0,
transformer.37.mha.dk@0,N,transformer.37.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.37.mha.k@0,
transformer.37.mha.dq@0,N,transformer.37.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.37.mha.q@0,
transformer.37.mha.dkv@0,N,transformer.37.mha.dv@0,transformer.37.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.37.mha.dqkv@0,N,transformer.37.mha.dkv@0,transformer.37.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.37.mha.qkv@0,
transformer.37.mha.dwqkv@0,N,transformer.37.mha.dqkv@0,transformer.37.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.37.mha.wqkv@0,
transformer.37.mha.dx1@0,N,transformer.37.mha.dqkv@0,transformer.37._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.37.mha.dx@0,N,transformer.37.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.37.mha.attn_kernel.q@0,N,transformer.37.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.37.mha.attn_kernel.k@0,N,transformer.37.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.37.mha.attn_kernel.v@0,N,transformer.37.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.37.mha.attn_kernel.k1@0,N,transformer.37.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.37.mha.attn_kernel.v1@0,N,transformer.37.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.37.mha.attn_kernel.qkv@0,N,transformer.37.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.37.mha.attn_kernel.k1@0"", ""transformer.37.mha.attn_kernel.v1@0""]}"
transformer.37.mha.attn_kernel.dqkv@0,N,transformer.37.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.37.mha.attn_kernel.qkv@0,
transformer.37.mha.attn_kernel.dq@0,N,transformer.37.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.37.mha.attn_kernel.q@0,
transformer.37.mha.attn_kernel.dk@0,N,transformer.37.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.37.mha.attn_kernel.dv@0,N,transformer.37.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.37.mha_res.x1@0,N,transformer.37.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.37.mha_res.x2@0,N,transformer.37.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.37.mha_res.y@0,N,transformer.37.mha_res.x1@0,transformer.37.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.37.mha_res.dy@0,N,transformer.37.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.37.mha_res.y@0,
transformer.37.mha_res.dx1@0,N,transformer.37.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.37.mha_res.x1@0,
transformer.37.mha_res.dx2@0,N,transformer.37.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.37.mha_res.x2@0,
transformer.37.post_attn_norm.x@0,N,transformer.37.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.37.post_attn_norm.y@0,N,transformer.37.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.37.post_attn_norm.dy@0,N,transformer.37.ffn.dx0@0,transformer.37.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.37.post_attn_norm.y@0,
transformer.37.post_attn_norm.dx@0,N,transformer.37.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.37.post_attn_norm.x@0,
transformer.37.ffn.x0@0,N,transformer.37.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.37.ffn.wgate@0,N,transformer.37._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.37.ffn.wdown@0,N,transformer.37._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.37.ffn.x00@0,N,transformer.37.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.37.ffn.xgate@0,N,transformer.37.ffn.x00@0,transformer.37.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.37.ffn.xdown1@0,N,transformer.37.ffn.xgate@0,transformer.37.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.37.ffn.xdown@0,N,transformer.37.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.37.ffn.dxdown@0,N,transformer.37.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.37.ffn.xdown@0,
transformer.37.ffn.dxdown2@0,N,transformer.37.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.37.ffn.dwdown@0,N,transformer.37.ffn.dxdown2@0,transformer.37.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.37.ffn.wdown@0,
transformer.37.ffn.dxgate@0,N,transformer.37.ffn.dxdown2@0,transformer.37._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.37.ffn.xgate@0,
transformer.37.ffn.x01@0,N,transformer.37.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.37.ffn.dwgate@0,N,transformer.37.ffn.dxgate@0,transformer.37.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.37.ffn.wgate@0,
transformer.37.ffn.dx000@0,N,transformer.37.ffn.dxgate@0,transformer.37._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.37.ffn.dx0@0,N,transformer.37.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.37.ffn_res.x1@0,N,transformer.37.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.37.ffn_res.x2@0,N,transformer.37.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.37.ffn_res.y@0,N,transformer.37.ffn_res.x1@0,transformer.37.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.37.ffn_res.dy@0,N,transformer.38.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.37.ffn_res.y@0,
transformer.37.ffn_res.dx1@0,N,transformer.37.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.37.ffn_res.x1@0,
transformer.37.ffn_res.dx2@0,N,transformer.37.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.37.ffn_res.x2@0,
transformer.37._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.37._assembled_weight@0,N,transformer.37._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.37._sharded_grad@0,N,transformer.37._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.37._sharded_weight@0,
transformer.37._assembled_grad@0,N,transformer.37.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.37.mha.dwo@0"", ""transformer.37.ffn.dwgate@0"", ""transformer.37.ffn.dwdown@0""]}"
transformer.37._mha.wqkv_backward@0,N,transformer.37._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.37._mha.wo_backward@0,N,transformer.37._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.37._ffn.wgate_backward@0,N,transformer.37._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.37._ffn.wdown_backward@0,N,transformer.37._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.37._assembled_weight_backward@0,N,transformer.37._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.38.input_norm.x@0,N,transformer.37.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.38.input_norm.y@0,N,transformer.38.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.38.input_norm.dy@0,N,transformer.38.mha.dx@0,transformer.38.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.38.input_norm.y@0,
transformer.38.input_norm.dx@0,N,transformer.38.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.38.input_norm.x@0,
transformer.38.mha.x@0,N,transformer.38.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.38.mha.wqkv@0,N,transformer.38._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.38.mha.qkv@0,N,transformer.38.mha.x@0,transformer.38.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.38.mha.q@0,N,transformer.38.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.38.mha.k@0,N,transformer.38.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.38.mha.v@0,N,transformer.38.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.38.mha.attn@0,N,transformer.38.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.38.mha.wo@0,N,transformer.38._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.38.mha.o1@0,N,transformer.38.mha.attn@0,transformer.38.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.38.mha.o@0,N,transformer.38.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.38.mha.do@0,N,transformer.38.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.38.mha.o@0,
transformer.38.mha.do1@0,N,transformer.38.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.38.mha.o1@0,
transformer.38.mha.dattn@0,N,transformer.38.mha.do1@0,transformer.38._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.38.mha.dwo@0,N,transformer.38.mha.do1@0,transformer.38.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.38.mha.wo@0,
transformer.38.mha.dv@0,N,transformer.38.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.38.mha.v@0,
transformer.38.mha.dk@0,N,transformer.38.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.38.mha.k@0,
transformer.38.mha.dq@0,N,transformer.38.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.38.mha.q@0,
transformer.38.mha.dkv@0,N,transformer.38.mha.dv@0,transformer.38.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.38.mha.dqkv@0,N,transformer.38.mha.dkv@0,transformer.38.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.38.mha.qkv@0,
transformer.38.mha.dwqkv@0,N,transformer.38.mha.dqkv@0,transformer.38.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.38.mha.wqkv@0,
transformer.38.mha.dx1@0,N,transformer.38.mha.dqkv@0,transformer.38._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.38.mha.dx@0,N,transformer.38.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.38.mha.attn_kernel.q@0,N,transformer.38.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.38.mha.attn_kernel.k@0,N,transformer.38.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.38.mha.attn_kernel.v@0,N,transformer.38.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.38.mha.attn_kernel.k1@0,N,transformer.38.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.38.mha.attn_kernel.v1@0,N,transformer.38.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.38.mha.attn_kernel.qkv@0,N,transformer.38.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.38.mha.attn_kernel.k1@0"", ""transformer.38.mha.attn_kernel.v1@0""]}"
transformer.38.mha.attn_kernel.dqkv@0,N,transformer.38.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.38.mha.attn_kernel.qkv@0,
transformer.38.mha.attn_kernel.dq@0,N,transformer.38.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.38.mha.attn_kernel.q@0,
transformer.38.mha.attn_kernel.dk@0,N,transformer.38.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.38.mha.attn_kernel.dv@0,N,transformer.38.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.38.mha_res.x1@0,N,transformer.38.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.38.mha_res.x2@0,N,transformer.38.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.38.mha_res.y@0,N,transformer.38.mha_res.x1@0,transformer.38.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.38.mha_res.dy@0,N,transformer.38.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.38.mha_res.y@0,
transformer.38.mha_res.dx1@0,N,transformer.38.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.38.mha_res.x1@0,
transformer.38.mha_res.dx2@0,N,transformer.38.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.38.mha_res.x2@0,
transformer.38.post_attn_norm.x@0,N,transformer.38.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.38.post_attn_norm.y@0,N,transformer.38.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.38.post_attn_norm.dy@0,N,transformer.38.ffn.dx0@0,transformer.38.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.38.post_attn_norm.y@0,
transformer.38.post_attn_norm.dx@0,N,transformer.38.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.38.post_attn_norm.x@0,
transformer.38.ffn.x0@0,N,transformer.38.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.38.ffn.wgate@0,N,transformer.38._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.38.ffn.wdown@0,N,transformer.38._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.38.ffn.x00@0,N,transformer.38.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.38.ffn.xgate@0,N,transformer.38.ffn.x00@0,transformer.38.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.38.ffn.xdown1@0,N,transformer.38.ffn.xgate@0,transformer.38.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.38.ffn.xdown@0,N,transformer.38.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.38.ffn.dxdown@0,N,transformer.38.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.38.ffn.xdown@0,
transformer.38.ffn.dxdown2@0,N,transformer.38.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.38.ffn.dwdown@0,N,transformer.38.ffn.dxdown2@0,transformer.38.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.38.ffn.wdown@0,
transformer.38.ffn.dxgate@0,N,transformer.38.ffn.dxdown2@0,transformer.38._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.38.ffn.xgate@0,
transformer.38.ffn.x01@0,N,transformer.38.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.38.ffn.dwgate@0,N,transformer.38.ffn.dxgate@0,transformer.38.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.38.ffn.wgate@0,
transformer.38.ffn.dx000@0,N,transformer.38.ffn.dxgate@0,transformer.38._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.38.ffn.dx0@0,N,transformer.38.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.38.ffn_res.x1@0,N,transformer.38.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.38.ffn_res.x2@0,N,transformer.38.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.38.ffn_res.y@0,N,transformer.38.ffn_res.x1@0,transformer.38.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.38.ffn_res.dy@0,N,transformer.39.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.38.ffn_res.y@0,
transformer.38.ffn_res.dx1@0,N,transformer.38.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.38.ffn_res.x1@0,
transformer.38.ffn_res.dx2@0,N,transformer.38.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.38.ffn_res.x2@0,
transformer.38._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.38._assembled_weight@0,N,transformer.38._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.38._sharded_grad@0,N,transformer.38._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.38._sharded_weight@0,
transformer.38._assembled_grad@0,N,transformer.38.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.38.mha.dwo@0"", ""transformer.38.ffn.dwgate@0"", ""transformer.38.ffn.dwdown@0""]}"
transformer.38._mha.wqkv_backward@0,N,transformer.38._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.38._mha.wo_backward@0,N,transformer.38._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.38._ffn.wgate_backward@0,N,transformer.38._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.38._ffn.wdown_backward@0,N,transformer.38._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.38._assembled_weight_backward@0,N,transformer.38._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.39.input_norm.x@0,N,transformer.38.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.39.input_norm.y@0,N,transformer.39.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.39.input_norm.dy@0,N,transformer.39.mha.dx@0,transformer.39.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.39.input_norm.y@0,
transformer.39.input_norm.dx@0,N,transformer.39.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.39.input_norm.x@0,
transformer.39.mha.x@0,N,transformer.39.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.39.mha.wqkv@0,N,transformer.39._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.39.mha.qkv@0,N,transformer.39.mha.x@0,transformer.39.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.39.mha.q@0,N,transformer.39.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.39.mha.k@0,N,transformer.39.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.39.mha.v@0,N,transformer.39.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.39.mha.attn@0,N,transformer.39.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.39.mha.wo@0,N,transformer.39._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.39.mha.o1@0,N,transformer.39.mha.attn@0,transformer.39.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.39.mha.o@0,N,transformer.39.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.39.mha.do@0,N,transformer.39.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.39.mha.o@0,
transformer.39.mha.do1@0,N,transformer.39.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.39.mha.o1@0,
transformer.39.mha.dattn@0,N,transformer.39.mha.do1@0,transformer.39._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.39.mha.dwo@0,N,transformer.39.mha.do1@0,transformer.39.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.39.mha.wo@0,
transformer.39.mha.dv@0,N,transformer.39.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.39.mha.v@0,
transformer.39.mha.dk@0,N,transformer.39.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.39.mha.k@0,
transformer.39.mha.dq@0,N,transformer.39.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.39.mha.q@0,
transformer.39.mha.dkv@0,N,transformer.39.mha.dv@0,transformer.39.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.39.mha.dqkv@0,N,transformer.39.mha.dkv@0,transformer.39.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.39.mha.qkv@0,
transformer.39.mha.dwqkv@0,N,transformer.39.mha.dqkv@0,transformer.39.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.39.mha.wqkv@0,
transformer.39.mha.dx1@0,N,transformer.39.mha.dqkv@0,transformer.39._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.39.mha.dx@0,N,transformer.39.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.39.mha.attn_kernel.q@0,N,transformer.39.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.39.mha.attn_kernel.k@0,N,transformer.39.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.39.mha.attn_kernel.v@0,N,transformer.39.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.39.mha.attn_kernel.k1@0,N,transformer.39.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.39.mha.attn_kernel.v1@0,N,transformer.39.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.39.mha.attn_kernel.qkv@0,N,transformer.39.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.39.mha.attn_kernel.k1@0"", ""transformer.39.mha.attn_kernel.v1@0""]}"
transformer.39.mha.attn_kernel.dqkv@0,N,transformer.39.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.39.mha.attn_kernel.qkv@0,
transformer.39.mha.attn_kernel.dq@0,N,transformer.39.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.39.mha.attn_kernel.q@0,
transformer.39.mha.attn_kernel.dk@0,N,transformer.39.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.39.mha.attn_kernel.dv@0,N,transformer.39.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.39.mha_res.x1@0,N,transformer.39.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.39.mha_res.x2@0,N,transformer.39.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.39.mha_res.y@0,N,transformer.39.mha_res.x1@0,transformer.39.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.39.mha_res.dy@0,N,transformer.39.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.39.mha_res.y@0,
transformer.39.mha_res.dx1@0,N,transformer.39.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.39.mha_res.x1@0,
transformer.39.mha_res.dx2@0,N,transformer.39.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.39.mha_res.x2@0,
transformer.39.post_attn_norm.x@0,N,transformer.39.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.39.post_attn_norm.y@0,N,transformer.39.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.39.post_attn_norm.dy@0,N,transformer.39.ffn.dx0@0,transformer.39.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.39.post_attn_norm.y@0,
transformer.39.post_attn_norm.dx@0,N,transformer.39.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.39.post_attn_norm.x@0,
transformer.39.ffn.x0@0,N,transformer.39.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.39.ffn.wgate@0,N,transformer.39._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.39.ffn.wdown@0,N,transformer.39._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.39.ffn.x00@0,N,transformer.39.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.39.ffn.xgate@0,N,transformer.39.ffn.x00@0,transformer.39.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.39.ffn.xdown1@0,N,transformer.39.ffn.xgate@0,transformer.39.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.39.ffn.xdown@0,N,transformer.39.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.39.ffn.dxdown@0,N,transformer.39.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.39.ffn.xdown@0,
transformer.39.ffn.dxdown2@0,N,transformer.39.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.39.ffn.dwdown@0,N,transformer.39.ffn.dxdown2@0,transformer.39.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.39.ffn.wdown@0,
transformer.39.ffn.dxgate@0,N,transformer.39.ffn.dxdown2@0,transformer.39._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.39.ffn.xgate@0,
transformer.39.ffn.x01@0,N,transformer.39.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.39.ffn.dwgate@0,N,transformer.39.ffn.dxgate@0,transformer.39.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.39.ffn.wgate@0,
transformer.39.ffn.dx000@0,N,transformer.39.ffn.dxgate@0,transformer.39._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.39.ffn.dx0@0,N,transformer.39.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.39.ffn_res.x1@0,N,transformer.39.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.39.ffn_res.x2@0,N,transformer.39.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.39.ffn_res.y@0,N,transformer.39.ffn_res.x1@0,transformer.39.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.39.ffn_res.dy@0,N,transformer.40.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.39.ffn_res.y@0,
transformer.39.ffn_res.dx1@0,N,transformer.39.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.39.ffn_res.x1@0,
transformer.39.ffn_res.dx2@0,N,transformer.39.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.39.ffn_res.x2@0,
transformer.39._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.39._assembled_weight@0,N,transformer.39._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.39._sharded_grad@0,N,transformer.39._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.39._sharded_weight@0,
transformer.39._assembled_grad@0,N,transformer.39.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.39.mha.dwo@0"", ""transformer.39.ffn.dwgate@0"", ""transformer.39.ffn.dwdown@0""]}"
transformer.39._mha.wqkv_backward@0,N,transformer.39._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.39._mha.wo_backward@0,N,transformer.39._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.39._ffn.wgate_backward@0,N,transformer.39._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.39._ffn.wdown_backward@0,N,transformer.39._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.39._assembled_weight_backward@0,N,transformer.39._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.40.input_norm.x@0,N,transformer.39.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.40.input_norm.y@0,N,transformer.40.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.40.input_norm.dy@0,N,transformer.40.mha.dx@0,transformer.40.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.40.input_norm.y@0,
transformer.40.input_norm.dx@0,N,transformer.40.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.40.input_norm.x@0,
transformer.40.mha.x@0,N,transformer.40.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.40.mha.wqkv@0,N,transformer.40._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.40.mha.qkv@0,N,transformer.40.mha.x@0,transformer.40.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.40.mha.q@0,N,transformer.40.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.40.mha.k@0,N,transformer.40.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.40.mha.v@0,N,transformer.40.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.40.mha.attn@0,N,transformer.40.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.40.mha.wo@0,N,transformer.40._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.40.mha.o1@0,N,transformer.40.mha.attn@0,transformer.40.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.40.mha.o@0,N,transformer.40.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.40.mha.do@0,N,transformer.40.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.40.mha.o@0,
transformer.40.mha.do1@0,N,transformer.40.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.40.mha.o1@0,
transformer.40.mha.dattn@0,N,transformer.40.mha.do1@0,transformer.40._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.40.mha.dwo@0,N,transformer.40.mha.do1@0,transformer.40.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.40.mha.wo@0,
transformer.40.mha.dv@0,N,transformer.40.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.40.mha.v@0,
transformer.40.mha.dk@0,N,transformer.40.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.40.mha.k@0,
transformer.40.mha.dq@0,N,transformer.40.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.40.mha.q@0,
transformer.40.mha.dkv@0,N,transformer.40.mha.dv@0,transformer.40.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.40.mha.dqkv@0,N,transformer.40.mha.dkv@0,transformer.40.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.40.mha.qkv@0,
transformer.40.mha.dwqkv@0,N,transformer.40.mha.dqkv@0,transformer.40.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.40.mha.wqkv@0,
transformer.40.mha.dx1@0,N,transformer.40.mha.dqkv@0,transformer.40._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.40.mha.dx@0,N,transformer.40.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.40.mha.attn_kernel.q@0,N,transformer.40.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.40.mha.attn_kernel.k@0,N,transformer.40.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.40.mha.attn_kernel.v@0,N,transformer.40.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.40.mha.attn_kernel.k1@0,N,transformer.40.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.40.mha.attn_kernel.v1@0,N,transformer.40.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.40.mha.attn_kernel.qkv@0,N,transformer.40.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.40.mha.attn_kernel.k1@0"", ""transformer.40.mha.attn_kernel.v1@0""]}"
transformer.40.mha.attn_kernel.dqkv@0,N,transformer.40.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.40.mha.attn_kernel.qkv@0,
transformer.40.mha.attn_kernel.dq@0,N,transformer.40.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.40.mha.attn_kernel.q@0,
transformer.40.mha.attn_kernel.dk@0,N,transformer.40.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.40.mha.attn_kernel.dv@0,N,transformer.40.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.40.mha_res.x1@0,N,transformer.40.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.40.mha_res.x2@0,N,transformer.40.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.40.mha_res.y@0,N,transformer.40.mha_res.x1@0,transformer.40.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.40.mha_res.dy@0,N,transformer.40.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.40.mha_res.y@0,
transformer.40.mha_res.dx1@0,N,transformer.40.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.40.mha_res.x1@0,
transformer.40.mha_res.dx2@0,N,transformer.40.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.40.mha_res.x2@0,
transformer.40.post_attn_norm.x@0,N,transformer.40.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.40.post_attn_norm.y@0,N,transformer.40.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.40.post_attn_norm.dy@0,N,transformer.40.ffn.dx0@0,transformer.40.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.40.post_attn_norm.y@0,
transformer.40.post_attn_norm.dx@0,N,transformer.40.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.40.post_attn_norm.x@0,
transformer.40.ffn.x0@0,N,transformer.40.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.40.ffn.wgate@0,N,transformer.40._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.40.ffn.wdown@0,N,transformer.40._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.40.ffn.x00@0,N,transformer.40.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.40.ffn.xgate@0,N,transformer.40.ffn.x00@0,transformer.40.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.40.ffn.xdown1@0,N,transformer.40.ffn.xgate@0,transformer.40.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.40.ffn.xdown@0,N,transformer.40.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.40.ffn.dxdown@0,N,transformer.40.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.40.ffn.xdown@0,
transformer.40.ffn.dxdown2@0,N,transformer.40.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.40.ffn.dwdown@0,N,transformer.40.ffn.dxdown2@0,transformer.40.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.40.ffn.wdown@0,
transformer.40.ffn.dxgate@0,N,transformer.40.ffn.dxdown2@0,transformer.40._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.40.ffn.xgate@0,
transformer.40.ffn.x01@0,N,transformer.40.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.40.ffn.dwgate@0,N,transformer.40.ffn.dxgate@0,transformer.40.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.40.ffn.wgate@0,
transformer.40.ffn.dx000@0,N,transformer.40.ffn.dxgate@0,transformer.40._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.40.ffn.dx0@0,N,transformer.40.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.40.ffn_res.x1@0,N,transformer.40.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.40.ffn_res.x2@0,N,transformer.40.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.40.ffn_res.y@0,N,transformer.40.ffn_res.x1@0,transformer.40.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.40.ffn_res.dy@0,N,transformer.41.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.40.ffn_res.y@0,
transformer.40.ffn_res.dx1@0,N,transformer.40.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.40.ffn_res.x1@0,
transformer.40.ffn_res.dx2@0,N,transformer.40.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.40.ffn_res.x2@0,
transformer.40._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.40._assembled_weight@0,N,transformer.40._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.40._sharded_grad@0,N,transformer.40._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.40._sharded_weight@0,
transformer.40._assembled_grad@0,N,transformer.40.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.40.mha.dwo@0"", ""transformer.40.ffn.dwgate@0"", ""transformer.40.ffn.dwdown@0""]}"
transformer.40._mha.wqkv_backward@0,N,transformer.40._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.40._mha.wo_backward@0,N,transformer.40._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.40._ffn.wgate_backward@0,N,transformer.40._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.40._ffn.wdown_backward@0,N,transformer.40._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.40._assembled_weight_backward@0,N,transformer.40._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.41.input_norm.x@0,N,transformer.40.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.41.input_norm.y@0,N,transformer.41.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.41.input_norm.dy@0,N,transformer.41.mha.dx@0,transformer.41.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.41.input_norm.y@0,
transformer.41.input_norm.dx@0,N,transformer.41.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.41.input_norm.x@0,
transformer.41.mha.x@0,N,transformer.41.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.41.mha.wqkv@0,N,transformer.41._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.41.mha.qkv@0,N,transformer.41.mha.x@0,transformer.41.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.41.mha.q@0,N,transformer.41.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.41.mha.k@0,N,transformer.41.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.41.mha.v@0,N,transformer.41.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.41.mha.attn@0,N,transformer.41.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.41.mha.wo@0,N,transformer.41._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.41.mha.o1@0,N,transformer.41.mha.attn@0,transformer.41.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.41.mha.o@0,N,transformer.41.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.41.mha.do@0,N,transformer.41.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.41.mha.o@0,
transformer.41.mha.do1@0,N,transformer.41.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.41.mha.o1@0,
transformer.41.mha.dattn@0,N,transformer.41.mha.do1@0,transformer.41._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.41.mha.dwo@0,N,transformer.41.mha.do1@0,transformer.41.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.41.mha.wo@0,
transformer.41.mha.dv@0,N,transformer.41.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.41.mha.v@0,
transformer.41.mha.dk@0,N,transformer.41.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.41.mha.k@0,
transformer.41.mha.dq@0,N,transformer.41.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.41.mha.q@0,
transformer.41.mha.dkv@0,N,transformer.41.mha.dv@0,transformer.41.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.41.mha.dqkv@0,N,transformer.41.mha.dkv@0,transformer.41.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.41.mha.qkv@0,
transformer.41.mha.dwqkv@0,N,transformer.41.mha.dqkv@0,transformer.41.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.41.mha.wqkv@0,
transformer.41.mha.dx1@0,N,transformer.41.mha.dqkv@0,transformer.41._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.41.mha.dx@0,N,transformer.41.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.41.mha.attn_kernel.q@0,N,transformer.41.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.41.mha.attn_kernel.k@0,N,transformer.41.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.41.mha.attn_kernel.v@0,N,transformer.41.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.41.mha.attn_kernel.k1@0,N,transformer.41.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.41.mha.attn_kernel.v1@0,N,transformer.41.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.41.mha.attn_kernel.qkv@0,N,transformer.41.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.41.mha.attn_kernel.k1@0"", ""transformer.41.mha.attn_kernel.v1@0""]}"
transformer.41.mha.attn_kernel.dqkv@0,N,transformer.41.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.41.mha.attn_kernel.qkv@0,
transformer.41.mha.attn_kernel.dq@0,N,transformer.41.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.41.mha.attn_kernel.q@0,
transformer.41.mha.attn_kernel.dk@0,N,transformer.41.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.41.mha.attn_kernel.dv@0,N,transformer.41.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.41.mha_res.x1@0,N,transformer.41.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.41.mha_res.x2@0,N,transformer.41.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.41.mha_res.y@0,N,transformer.41.mha_res.x1@0,transformer.41.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.41.mha_res.dy@0,N,transformer.41.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.41.mha_res.y@0,
transformer.41.mha_res.dx1@0,N,transformer.41.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.41.mha_res.x1@0,
transformer.41.mha_res.dx2@0,N,transformer.41.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.41.mha_res.x2@0,
transformer.41.post_attn_norm.x@0,N,transformer.41.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.41.post_attn_norm.y@0,N,transformer.41.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.41.post_attn_norm.dy@0,N,transformer.41.ffn.dx0@0,transformer.41.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.41.post_attn_norm.y@0,
transformer.41.post_attn_norm.dx@0,N,transformer.41.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.41.post_attn_norm.x@0,
transformer.41.ffn.x0@0,N,transformer.41.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.41.ffn.wgate@0,N,transformer.41._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.41.ffn.wdown@0,N,transformer.41._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.41.ffn.x00@0,N,transformer.41.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.41.ffn.xgate@0,N,transformer.41.ffn.x00@0,transformer.41.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.41.ffn.xdown1@0,N,transformer.41.ffn.xgate@0,transformer.41.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.41.ffn.xdown@0,N,transformer.41.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.41.ffn.dxdown@0,N,transformer.41.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.41.ffn.xdown@0,
transformer.41.ffn.dxdown2@0,N,transformer.41.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.41.ffn.dwdown@0,N,transformer.41.ffn.dxdown2@0,transformer.41.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.41.ffn.wdown@0,
transformer.41.ffn.dxgate@0,N,transformer.41.ffn.dxdown2@0,transformer.41._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.41.ffn.xgate@0,
transformer.41.ffn.x01@0,N,transformer.41.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.41.ffn.dwgate@0,N,transformer.41.ffn.dxgate@0,transformer.41.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.41.ffn.wgate@0,
transformer.41.ffn.dx000@0,N,transformer.41.ffn.dxgate@0,transformer.41._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.41.ffn.dx0@0,N,transformer.41.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.41.ffn_res.x1@0,N,transformer.41.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.41.ffn_res.x2@0,N,transformer.41.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.41.ffn_res.y@0,N,transformer.41.ffn_res.x1@0,transformer.41.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.41.ffn_res.dy@0,N,transformer.42.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.41.ffn_res.y@0,
transformer.41.ffn_res.dx1@0,N,transformer.41.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.41.ffn_res.x1@0,
transformer.41.ffn_res.dx2@0,N,transformer.41.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.41.ffn_res.x2@0,
transformer.41._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.41._assembled_weight@0,N,transformer.41._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.41._sharded_grad@0,N,transformer.41._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.41._sharded_weight@0,
transformer.41._assembled_grad@0,N,transformer.41.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.41.mha.dwo@0"", ""transformer.41.ffn.dwgate@0"", ""transformer.41.ffn.dwdown@0""]}"
transformer.41._mha.wqkv_backward@0,N,transformer.41._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.41._mha.wo_backward@0,N,transformer.41._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.41._ffn.wgate_backward@0,N,transformer.41._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.41._ffn.wdown_backward@0,N,transformer.41._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.41._assembled_weight_backward@0,N,transformer.41._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.42.input_norm.x@0,N,transformer.41.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.42.input_norm.y@0,N,transformer.42.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.42.input_norm.dy@0,N,transformer.42.mha.dx@0,transformer.42.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.42.input_norm.y@0,
transformer.42.input_norm.dx@0,N,transformer.42.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.42.input_norm.x@0,
transformer.42.mha.x@0,N,transformer.42.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.42.mha.wqkv@0,N,transformer.42._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.42.mha.qkv@0,N,transformer.42.mha.x@0,transformer.42.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.42.mha.q@0,N,transformer.42.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.42.mha.k@0,N,transformer.42.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.42.mha.v@0,N,transformer.42.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.42.mha.attn@0,N,transformer.42.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.42.mha.wo@0,N,transformer.42._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.42.mha.o1@0,N,transformer.42.mha.attn@0,transformer.42.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.42.mha.o@0,N,transformer.42.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.42.mha.do@0,N,transformer.42.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.42.mha.o@0,
transformer.42.mha.do1@0,N,transformer.42.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.42.mha.o1@0,
transformer.42.mha.dattn@0,N,transformer.42.mha.do1@0,transformer.42._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.42.mha.dwo@0,N,transformer.42.mha.do1@0,transformer.42.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.42.mha.wo@0,
transformer.42.mha.dv@0,N,transformer.42.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.42.mha.v@0,
transformer.42.mha.dk@0,N,transformer.42.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.42.mha.k@0,
transformer.42.mha.dq@0,N,transformer.42.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.42.mha.q@0,
transformer.42.mha.dkv@0,N,transformer.42.mha.dv@0,transformer.42.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.42.mha.dqkv@0,N,transformer.42.mha.dkv@0,transformer.42.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.42.mha.qkv@0,
transformer.42.mha.dwqkv@0,N,transformer.42.mha.dqkv@0,transformer.42.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.42.mha.wqkv@0,
transformer.42.mha.dx1@0,N,transformer.42.mha.dqkv@0,transformer.42._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.42.mha.dx@0,N,transformer.42.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.42.mha.attn_kernel.q@0,N,transformer.42.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.42.mha.attn_kernel.k@0,N,transformer.42.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.42.mha.attn_kernel.v@0,N,transformer.42.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.42.mha.attn_kernel.k1@0,N,transformer.42.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.42.mha.attn_kernel.v1@0,N,transformer.42.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.42.mha.attn_kernel.qkv@0,N,transformer.42.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.42.mha.attn_kernel.k1@0"", ""transformer.42.mha.attn_kernel.v1@0""]}"
transformer.42.mha.attn_kernel.dqkv@0,N,transformer.42.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.42.mha.attn_kernel.qkv@0,
transformer.42.mha.attn_kernel.dq@0,N,transformer.42.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.42.mha.attn_kernel.q@0,
transformer.42.mha.attn_kernel.dk@0,N,transformer.42.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.42.mha.attn_kernel.dv@0,N,transformer.42.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.42.mha_res.x1@0,N,transformer.42.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.42.mha_res.x2@0,N,transformer.42.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.42.mha_res.y@0,N,transformer.42.mha_res.x1@0,transformer.42.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.42.mha_res.dy@0,N,transformer.42.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.42.mha_res.y@0,
transformer.42.mha_res.dx1@0,N,transformer.42.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.42.mha_res.x1@0,
transformer.42.mha_res.dx2@0,N,transformer.42.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.42.mha_res.x2@0,
transformer.42.post_attn_norm.x@0,N,transformer.42.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.42.post_attn_norm.y@0,N,transformer.42.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.42.post_attn_norm.dy@0,N,transformer.42.ffn.dx0@0,transformer.42.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.42.post_attn_norm.y@0,
transformer.42.post_attn_norm.dx@0,N,transformer.42.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.42.post_attn_norm.x@0,
transformer.42.ffn.x0@0,N,transformer.42.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.42.ffn.wgate@0,N,transformer.42._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.42.ffn.wdown@0,N,transformer.42._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.42.ffn.x00@0,N,transformer.42.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.42.ffn.xgate@0,N,transformer.42.ffn.x00@0,transformer.42.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.42.ffn.xdown1@0,N,transformer.42.ffn.xgate@0,transformer.42.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.42.ffn.xdown@0,N,transformer.42.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.42.ffn.dxdown@0,N,transformer.42.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.42.ffn.xdown@0,
transformer.42.ffn.dxdown2@0,N,transformer.42.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.42.ffn.dwdown@0,N,transformer.42.ffn.dxdown2@0,transformer.42.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.42.ffn.wdown@0,
transformer.42.ffn.dxgate@0,N,transformer.42.ffn.dxdown2@0,transformer.42._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.42.ffn.xgate@0,
transformer.42.ffn.x01@0,N,transformer.42.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.42.ffn.dwgate@0,N,transformer.42.ffn.dxgate@0,transformer.42.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.42.ffn.wgate@0,
transformer.42.ffn.dx000@0,N,transformer.42.ffn.dxgate@0,transformer.42._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.42.ffn.dx0@0,N,transformer.42.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.42.ffn_res.x1@0,N,transformer.42.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.42.ffn_res.x2@0,N,transformer.42.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.42.ffn_res.y@0,N,transformer.42.ffn_res.x1@0,transformer.42.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.42.ffn_res.dy@0,N,transformer.43.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.42.ffn_res.y@0,
transformer.42.ffn_res.dx1@0,N,transformer.42.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.42.ffn_res.x1@0,
transformer.42.ffn_res.dx2@0,N,transformer.42.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.42.ffn_res.x2@0,
transformer.42._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.42._assembled_weight@0,N,transformer.42._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.42._sharded_grad@0,N,transformer.42._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.42._sharded_weight@0,
transformer.42._assembled_grad@0,N,transformer.42.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.42.mha.dwo@0"", ""transformer.42.ffn.dwgate@0"", ""transformer.42.ffn.dwdown@0""]}"
transformer.42._mha.wqkv_backward@0,N,transformer.42._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.42._mha.wo_backward@0,N,transformer.42._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.42._ffn.wgate_backward@0,N,transformer.42._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.42._ffn.wdown_backward@0,N,transformer.42._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.42._assembled_weight_backward@0,N,transformer.42._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.43.input_norm.x@0,N,transformer.42.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.43.input_norm.y@0,N,transformer.43.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.43.input_norm.dy@0,N,transformer.43.mha.dx@0,transformer.43.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.43.input_norm.y@0,
transformer.43.input_norm.dx@0,N,transformer.43.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.43.input_norm.x@0,
transformer.43.mha.x@0,N,transformer.43.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.43.mha.wqkv@0,N,transformer.43._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.43.mha.qkv@0,N,transformer.43.mha.x@0,transformer.43.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.43.mha.q@0,N,transformer.43.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.43.mha.k@0,N,transformer.43.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.43.mha.v@0,N,transformer.43.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.43.mha.attn@0,N,transformer.43.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.43.mha.wo@0,N,transformer.43._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.43.mha.o1@0,N,transformer.43.mha.attn@0,transformer.43.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.43.mha.o@0,N,transformer.43.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.43.mha.do@0,N,transformer.43.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.43.mha.o@0,
transformer.43.mha.do1@0,N,transformer.43.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.43.mha.o1@0,
transformer.43.mha.dattn@0,N,transformer.43.mha.do1@0,transformer.43._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.43.mha.dwo@0,N,transformer.43.mha.do1@0,transformer.43.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.43.mha.wo@0,
transformer.43.mha.dv@0,N,transformer.43.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.43.mha.v@0,
transformer.43.mha.dk@0,N,transformer.43.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.43.mha.k@0,
transformer.43.mha.dq@0,N,transformer.43.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.43.mha.q@0,
transformer.43.mha.dkv@0,N,transformer.43.mha.dv@0,transformer.43.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.43.mha.dqkv@0,N,transformer.43.mha.dkv@0,transformer.43.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.43.mha.qkv@0,
transformer.43.mha.dwqkv@0,N,transformer.43.mha.dqkv@0,transformer.43.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.43.mha.wqkv@0,
transformer.43.mha.dx1@0,N,transformer.43.mha.dqkv@0,transformer.43._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.43.mha.dx@0,N,transformer.43.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.43.mha.attn_kernel.q@0,N,transformer.43.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.43.mha.attn_kernel.k@0,N,transformer.43.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.43.mha.attn_kernel.v@0,N,transformer.43.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.43.mha.attn_kernel.k1@0,N,transformer.43.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.43.mha.attn_kernel.v1@0,N,transformer.43.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.43.mha.attn_kernel.qkv@0,N,transformer.43.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.43.mha.attn_kernel.k1@0"", ""transformer.43.mha.attn_kernel.v1@0""]}"
transformer.43.mha.attn_kernel.dqkv@0,N,transformer.43.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.43.mha.attn_kernel.qkv@0,
transformer.43.mha.attn_kernel.dq@0,N,transformer.43.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.43.mha.attn_kernel.q@0,
transformer.43.mha.attn_kernel.dk@0,N,transformer.43.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.43.mha.attn_kernel.dv@0,N,transformer.43.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.43.mha_res.x1@0,N,transformer.43.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.43.mha_res.x2@0,N,transformer.43.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.43.mha_res.y@0,N,transformer.43.mha_res.x1@0,transformer.43.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.43.mha_res.dy@0,N,transformer.43.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.43.mha_res.y@0,
transformer.43.mha_res.dx1@0,N,transformer.43.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.43.mha_res.x1@0,
transformer.43.mha_res.dx2@0,N,transformer.43.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.43.mha_res.x2@0,
transformer.43.post_attn_norm.x@0,N,transformer.43.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.43.post_attn_norm.y@0,N,transformer.43.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.43.post_attn_norm.dy@0,N,transformer.43.ffn.dx0@0,transformer.43.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.43.post_attn_norm.y@0,
transformer.43.post_attn_norm.dx@0,N,transformer.43.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.43.post_attn_norm.x@0,
transformer.43.ffn.x0@0,N,transformer.43.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.43.ffn.wgate@0,N,transformer.43._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.43.ffn.wdown@0,N,transformer.43._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.43.ffn.x00@0,N,transformer.43.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.43.ffn.xgate@0,N,transformer.43.ffn.x00@0,transformer.43.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.43.ffn.xdown1@0,N,transformer.43.ffn.xgate@0,transformer.43.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.43.ffn.xdown@0,N,transformer.43.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.43.ffn.dxdown@0,N,transformer.43.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.43.ffn.xdown@0,
transformer.43.ffn.dxdown2@0,N,transformer.43.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.43.ffn.dwdown@0,N,transformer.43.ffn.dxdown2@0,transformer.43.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.43.ffn.wdown@0,
transformer.43.ffn.dxgate@0,N,transformer.43.ffn.dxdown2@0,transformer.43._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.43.ffn.xgate@0,
transformer.43.ffn.x01@0,N,transformer.43.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.43.ffn.dwgate@0,N,transformer.43.ffn.dxgate@0,transformer.43.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.43.ffn.wgate@0,
transformer.43.ffn.dx000@0,N,transformer.43.ffn.dxgate@0,transformer.43._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.43.ffn.dx0@0,N,transformer.43.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.43.ffn_res.x1@0,N,transformer.43.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.43.ffn_res.x2@0,N,transformer.43.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.43.ffn_res.y@0,N,transformer.43.ffn_res.x1@0,transformer.43.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.43.ffn_res.dy@0,N,transformer.44.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.43.ffn_res.y@0,
transformer.43.ffn_res.dx1@0,N,transformer.43.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.43.ffn_res.x1@0,
transformer.43.ffn_res.dx2@0,N,transformer.43.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.43.ffn_res.x2@0,
transformer.43._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.43._assembled_weight@0,N,transformer.43._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.43._sharded_grad@0,N,transformer.43._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.43._sharded_weight@0,
transformer.43._assembled_grad@0,N,transformer.43.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.43.mha.dwo@0"", ""transformer.43.ffn.dwgate@0"", ""transformer.43.ffn.dwdown@0""]}"
transformer.43._mha.wqkv_backward@0,N,transformer.43._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.43._mha.wo_backward@0,N,transformer.43._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.43._ffn.wgate_backward@0,N,transformer.43._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.43._ffn.wdown_backward@0,N,transformer.43._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.43._assembled_weight_backward@0,N,transformer.43._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.44.input_norm.x@0,N,transformer.43.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.44.input_norm.y@0,N,transformer.44.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.44.input_norm.dy@0,N,transformer.44.mha.dx@0,transformer.44.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.44.input_norm.y@0,
transformer.44.input_norm.dx@0,N,transformer.44.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.44.input_norm.x@0,
transformer.44.mha.x@0,N,transformer.44.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.44.mha.wqkv@0,N,transformer.44._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.44.mha.qkv@0,N,transformer.44.mha.x@0,transformer.44.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.44.mha.q@0,N,transformer.44.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.44.mha.k@0,N,transformer.44.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.44.mha.v@0,N,transformer.44.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.44.mha.attn@0,N,transformer.44.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.44.mha.wo@0,N,transformer.44._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.44.mha.o1@0,N,transformer.44.mha.attn@0,transformer.44.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.44.mha.o@0,N,transformer.44.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.44.mha.do@0,N,transformer.44.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.44.mha.o@0,
transformer.44.mha.do1@0,N,transformer.44.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.44.mha.o1@0,
transformer.44.mha.dattn@0,N,transformer.44.mha.do1@0,transformer.44._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.44.mha.dwo@0,N,transformer.44.mha.do1@0,transformer.44.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.44.mha.wo@0,
transformer.44.mha.dv@0,N,transformer.44.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.44.mha.v@0,
transformer.44.mha.dk@0,N,transformer.44.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.44.mha.k@0,
transformer.44.mha.dq@0,N,transformer.44.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.44.mha.q@0,
transformer.44.mha.dkv@0,N,transformer.44.mha.dv@0,transformer.44.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.44.mha.dqkv@0,N,transformer.44.mha.dkv@0,transformer.44.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.44.mha.qkv@0,
transformer.44.mha.dwqkv@0,N,transformer.44.mha.dqkv@0,transformer.44.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.44.mha.wqkv@0,
transformer.44.mha.dx1@0,N,transformer.44.mha.dqkv@0,transformer.44._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.44.mha.dx@0,N,transformer.44.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.44.mha.attn_kernel.q@0,N,transformer.44.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.44.mha.attn_kernel.k@0,N,transformer.44.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.44.mha.attn_kernel.v@0,N,transformer.44.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.44.mha.attn_kernel.k1@0,N,transformer.44.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.44.mha.attn_kernel.v1@0,N,transformer.44.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.44.mha.attn_kernel.qkv@0,N,transformer.44.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.44.mha.attn_kernel.k1@0"", ""transformer.44.mha.attn_kernel.v1@0""]}"
transformer.44.mha.attn_kernel.dqkv@0,N,transformer.44.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.44.mha.attn_kernel.qkv@0,
transformer.44.mha.attn_kernel.dq@0,N,transformer.44.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.44.mha.attn_kernel.q@0,
transformer.44.mha.attn_kernel.dk@0,N,transformer.44.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.44.mha.attn_kernel.dv@0,N,transformer.44.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.44.mha_res.x1@0,N,transformer.44.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.44.mha_res.x2@0,N,transformer.44.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.44.mha_res.y@0,N,transformer.44.mha_res.x1@0,transformer.44.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.44.mha_res.dy@0,N,transformer.44.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.44.mha_res.y@0,
transformer.44.mha_res.dx1@0,N,transformer.44.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.44.mha_res.x1@0,
transformer.44.mha_res.dx2@0,N,transformer.44.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.44.mha_res.x2@0,
transformer.44.post_attn_norm.x@0,N,transformer.44.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.44.post_attn_norm.y@0,N,transformer.44.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.44.post_attn_norm.dy@0,N,transformer.44.ffn.dx0@0,transformer.44.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.44.post_attn_norm.y@0,
transformer.44.post_attn_norm.dx@0,N,transformer.44.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.44.post_attn_norm.x@0,
transformer.44.ffn.x0@0,N,transformer.44.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.44.ffn.wgate@0,N,transformer.44._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.44.ffn.wdown@0,N,transformer.44._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.44.ffn.x00@0,N,transformer.44.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.44.ffn.xgate@0,N,transformer.44.ffn.x00@0,transformer.44.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.44.ffn.xdown1@0,N,transformer.44.ffn.xgate@0,transformer.44.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.44.ffn.xdown@0,N,transformer.44.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.44.ffn.dxdown@0,N,transformer.44.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.44.ffn.xdown@0,
transformer.44.ffn.dxdown2@0,N,transformer.44.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.44.ffn.dwdown@0,N,transformer.44.ffn.dxdown2@0,transformer.44.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.44.ffn.wdown@0,
transformer.44.ffn.dxgate@0,N,transformer.44.ffn.dxdown2@0,transformer.44._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.44.ffn.xgate@0,
transformer.44.ffn.x01@0,N,transformer.44.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.44.ffn.dwgate@0,N,transformer.44.ffn.dxgate@0,transformer.44.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.44.ffn.wgate@0,
transformer.44.ffn.dx000@0,N,transformer.44.ffn.dxgate@0,transformer.44._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.44.ffn.dx0@0,N,transformer.44.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.44.ffn_res.x1@0,N,transformer.44.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.44.ffn_res.x2@0,N,transformer.44.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.44.ffn_res.y@0,N,transformer.44.ffn_res.x1@0,transformer.44.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.44.ffn_res.dy@0,N,transformer.45.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.44.ffn_res.y@0,
transformer.44.ffn_res.dx1@0,N,transformer.44.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.44.ffn_res.x1@0,
transformer.44.ffn_res.dx2@0,N,transformer.44.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.44.ffn_res.x2@0,
transformer.44._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.44._assembled_weight@0,N,transformer.44._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.44._sharded_grad@0,N,transformer.44._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.44._sharded_weight@0,
transformer.44._assembled_grad@0,N,transformer.44.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.44.mha.dwo@0"", ""transformer.44.ffn.dwgate@0"", ""transformer.44.ffn.dwdown@0""]}"
transformer.44._mha.wqkv_backward@0,N,transformer.44._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.44._mha.wo_backward@0,N,transformer.44._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.44._ffn.wgate_backward@0,N,transformer.44._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.44._ffn.wdown_backward@0,N,transformer.44._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.44._assembled_weight_backward@0,N,transformer.44._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.45.input_norm.x@0,N,transformer.44.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.45.input_norm.y@0,N,transformer.45.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.45.input_norm.dy@0,N,transformer.45.mha.dx@0,transformer.45.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.45.input_norm.y@0,
transformer.45.input_norm.dx@0,N,transformer.45.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.45.input_norm.x@0,
transformer.45.mha.x@0,N,transformer.45.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.45.mha.wqkv@0,N,transformer.45._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.45.mha.qkv@0,N,transformer.45.mha.x@0,transformer.45.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.45.mha.q@0,N,transformer.45.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.45.mha.k@0,N,transformer.45.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.45.mha.v@0,N,transformer.45.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.45.mha.attn@0,N,transformer.45.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.45.mha.wo@0,N,transformer.45._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.45.mha.o1@0,N,transformer.45.mha.attn@0,transformer.45.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.45.mha.o@0,N,transformer.45.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.45.mha.do@0,N,transformer.45.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.45.mha.o@0,
transformer.45.mha.do1@0,N,transformer.45.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.45.mha.o1@0,
transformer.45.mha.dattn@0,N,transformer.45.mha.do1@0,transformer.45._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.45.mha.dwo@0,N,transformer.45.mha.do1@0,transformer.45.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.45.mha.wo@0,
transformer.45.mha.dv@0,N,transformer.45.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.45.mha.v@0,
transformer.45.mha.dk@0,N,transformer.45.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.45.mha.k@0,
transformer.45.mha.dq@0,N,transformer.45.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.45.mha.q@0,
transformer.45.mha.dkv@0,N,transformer.45.mha.dv@0,transformer.45.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.45.mha.dqkv@0,N,transformer.45.mha.dkv@0,transformer.45.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.45.mha.qkv@0,
transformer.45.mha.dwqkv@0,N,transformer.45.mha.dqkv@0,transformer.45.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.45.mha.wqkv@0,
transformer.45.mha.dx1@0,N,transformer.45.mha.dqkv@0,transformer.45._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.45.mha.dx@0,N,transformer.45.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.45.mha.attn_kernel.q@0,N,transformer.45.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.45.mha.attn_kernel.k@0,N,transformer.45.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.45.mha.attn_kernel.v@0,N,transformer.45.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.45.mha.attn_kernel.k1@0,N,transformer.45.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.45.mha.attn_kernel.v1@0,N,transformer.45.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.45.mha.attn_kernel.qkv@0,N,transformer.45.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.45.mha.attn_kernel.k1@0"", ""transformer.45.mha.attn_kernel.v1@0""]}"
transformer.45.mha.attn_kernel.dqkv@0,N,transformer.45.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.45.mha.attn_kernel.qkv@0,
transformer.45.mha.attn_kernel.dq@0,N,transformer.45.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.45.mha.attn_kernel.q@0,
transformer.45.mha.attn_kernel.dk@0,N,transformer.45.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.45.mha.attn_kernel.dv@0,N,transformer.45.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.45.mha_res.x1@0,N,transformer.45.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.45.mha_res.x2@0,N,transformer.45.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.45.mha_res.y@0,N,transformer.45.mha_res.x1@0,transformer.45.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.45.mha_res.dy@0,N,transformer.45.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.45.mha_res.y@0,
transformer.45.mha_res.dx1@0,N,transformer.45.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.45.mha_res.x1@0,
transformer.45.mha_res.dx2@0,N,transformer.45.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.45.mha_res.x2@0,
transformer.45.post_attn_norm.x@0,N,transformer.45.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.45.post_attn_norm.y@0,N,transformer.45.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.45.post_attn_norm.dy@0,N,transformer.45.ffn.dx0@0,transformer.45.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.45.post_attn_norm.y@0,
transformer.45.post_attn_norm.dx@0,N,transformer.45.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.45.post_attn_norm.x@0,
transformer.45.ffn.x0@0,N,transformer.45.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.45.ffn.wgate@0,N,transformer.45._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.45.ffn.wdown@0,N,transformer.45._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.45.ffn.x00@0,N,transformer.45.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.45.ffn.xgate@0,N,transformer.45.ffn.x00@0,transformer.45.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.45.ffn.xdown1@0,N,transformer.45.ffn.xgate@0,transformer.45.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.45.ffn.xdown@0,N,transformer.45.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.45.ffn.dxdown@0,N,transformer.45.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.45.ffn.xdown@0,
transformer.45.ffn.dxdown2@0,N,transformer.45.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.45.ffn.dwdown@0,N,transformer.45.ffn.dxdown2@0,transformer.45.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.45.ffn.wdown@0,
transformer.45.ffn.dxgate@0,N,transformer.45.ffn.dxdown2@0,transformer.45._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.45.ffn.xgate@0,
transformer.45.ffn.x01@0,N,transformer.45.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.45.ffn.dwgate@0,N,transformer.45.ffn.dxgate@0,transformer.45.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.45.ffn.wgate@0,
transformer.45.ffn.dx000@0,N,transformer.45.ffn.dxgate@0,transformer.45._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.45.ffn.dx0@0,N,transformer.45.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.45.ffn_res.x1@0,N,transformer.45.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.45.ffn_res.x2@0,N,transformer.45.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.45.ffn_res.y@0,N,transformer.45.ffn_res.x1@0,transformer.45.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.45.ffn_res.dy@0,N,transformer.46.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.45.ffn_res.y@0,
transformer.45.ffn_res.dx1@0,N,transformer.45.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.45.ffn_res.x1@0,
transformer.45.ffn_res.dx2@0,N,transformer.45.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.45.ffn_res.x2@0,
transformer.45._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.45._assembled_weight@0,N,transformer.45._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.45._sharded_grad@0,N,transformer.45._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.45._sharded_weight@0,
transformer.45._assembled_grad@0,N,transformer.45.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.45.mha.dwo@0"", ""transformer.45.ffn.dwgate@0"", ""transformer.45.ffn.dwdown@0""]}"
transformer.45._mha.wqkv_backward@0,N,transformer.45._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.45._mha.wo_backward@0,N,transformer.45._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.45._ffn.wgate_backward@0,N,transformer.45._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.45._ffn.wdown_backward@0,N,transformer.45._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.45._assembled_weight_backward@0,N,transformer.45._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.46.input_norm.x@0,N,transformer.45.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.46.input_norm.y@0,N,transformer.46.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.46.input_norm.dy@0,N,transformer.46.mha.dx@0,transformer.46.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.46.input_norm.y@0,
transformer.46.input_norm.dx@0,N,transformer.46.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.46.input_norm.x@0,
transformer.46.mha.x@0,N,transformer.46.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.46.mha.wqkv@0,N,transformer.46._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.46.mha.qkv@0,N,transformer.46.mha.x@0,transformer.46.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.46.mha.q@0,N,transformer.46.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.46.mha.k@0,N,transformer.46.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.46.mha.v@0,N,transformer.46.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.46.mha.attn@0,N,transformer.46.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.46.mha.wo@0,N,transformer.46._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.46.mha.o1@0,N,transformer.46.mha.attn@0,transformer.46.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.46.mha.o@0,N,transformer.46.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.46.mha.do@0,N,transformer.46.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.46.mha.o@0,
transformer.46.mha.do1@0,N,transformer.46.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.46.mha.o1@0,
transformer.46.mha.dattn@0,N,transformer.46.mha.do1@0,transformer.46._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.46.mha.dwo@0,N,transformer.46.mha.do1@0,transformer.46.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.46.mha.wo@0,
transformer.46.mha.dv@0,N,transformer.46.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.46.mha.v@0,
transformer.46.mha.dk@0,N,transformer.46.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.46.mha.k@0,
transformer.46.mha.dq@0,N,transformer.46.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.46.mha.q@0,
transformer.46.mha.dkv@0,N,transformer.46.mha.dv@0,transformer.46.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.46.mha.dqkv@0,N,transformer.46.mha.dkv@0,transformer.46.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.46.mha.qkv@0,
transformer.46.mha.dwqkv@0,N,transformer.46.mha.dqkv@0,transformer.46.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.46.mha.wqkv@0,
transformer.46.mha.dx1@0,N,transformer.46.mha.dqkv@0,transformer.46._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.46.mha.dx@0,N,transformer.46.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.46.mha.attn_kernel.q@0,N,transformer.46.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.46.mha.attn_kernel.k@0,N,transformer.46.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.46.mha.attn_kernel.v@0,N,transformer.46.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.46.mha.attn_kernel.k1@0,N,transformer.46.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.46.mha.attn_kernel.v1@0,N,transformer.46.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.46.mha.attn_kernel.qkv@0,N,transformer.46.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.46.mha.attn_kernel.k1@0"", ""transformer.46.mha.attn_kernel.v1@0""]}"
transformer.46.mha.attn_kernel.dqkv@0,N,transformer.46.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.46.mha.attn_kernel.qkv@0,
transformer.46.mha.attn_kernel.dq@0,N,transformer.46.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.46.mha.attn_kernel.q@0,
transformer.46.mha.attn_kernel.dk@0,N,transformer.46.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.46.mha.attn_kernel.dv@0,N,transformer.46.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.46.mha_res.x1@0,N,transformer.46.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.46.mha_res.x2@0,N,transformer.46.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.46.mha_res.y@0,N,transformer.46.mha_res.x1@0,transformer.46.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.46.mha_res.dy@0,N,transformer.46.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.46.mha_res.y@0,
transformer.46.mha_res.dx1@0,N,transformer.46.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.46.mha_res.x1@0,
transformer.46.mha_res.dx2@0,N,transformer.46.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.46.mha_res.x2@0,
transformer.46.post_attn_norm.x@0,N,transformer.46.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.46.post_attn_norm.y@0,N,transformer.46.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.46.post_attn_norm.dy@0,N,transformer.46.ffn.dx0@0,transformer.46.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.46.post_attn_norm.y@0,
transformer.46.post_attn_norm.dx@0,N,transformer.46.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.46.post_attn_norm.x@0,
transformer.46.ffn.x0@0,N,transformer.46.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.46.ffn.wgate@0,N,transformer.46._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.46.ffn.wdown@0,N,transformer.46._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.46.ffn.x00@0,N,transformer.46.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.46.ffn.xgate@0,N,transformer.46.ffn.x00@0,transformer.46.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.46.ffn.xdown1@0,N,transformer.46.ffn.xgate@0,transformer.46.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.46.ffn.xdown@0,N,transformer.46.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.46.ffn.dxdown@0,N,transformer.46.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.46.ffn.xdown@0,
transformer.46.ffn.dxdown2@0,N,transformer.46.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.46.ffn.dwdown@0,N,transformer.46.ffn.dxdown2@0,transformer.46.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.46.ffn.wdown@0,
transformer.46.ffn.dxgate@0,N,transformer.46.ffn.dxdown2@0,transformer.46._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.46.ffn.xgate@0,
transformer.46.ffn.x01@0,N,transformer.46.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.46.ffn.dwgate@0,N,transformer.46.ffn.dxgate@0,transformer.46.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.46.ffn.wgate@0,
transformer.46.ffn.dx000@0,N,transformer.46.ffn.dxgate@0,transformer.46._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.46.ffn.dx0@0,N,transformer.46.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.46.ffn_res.x1@0,N,transformer.46.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.46.ffn_res.x2@0,N,transformer.46.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.46.ffn_res.y@0,N,transformer.46.ffn_res.x1@0,transformer.46.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.46.ffn_res.dy@0,N,transformer.47.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.46.ffn_res.y@0,
transformer.46.ffn_res.dx1@0,N,transformer.46.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.46.ffn_res.x1@0,
transformer.46.ffn_res.dx2@0,N,transformer.46.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.46.ffn_res.x2@0,
transformer.46._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.46._assembled_weight@0,N,transformer.46._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.46._sharded_grad@0,N,transformer.46._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.46._sharded_weight@0,
transformer.46._assembled_grad@0,N,transformer.46.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.46.mha.dwo@0"", ""transformer.46.ffn.dwgate@0"", ""transformer.46.ffn.dwdown@0""]}"
transformer.46._mha.wqkv_backward@0,N,transformer.46._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.46._mha.wo_backward@0,N,transformer.46._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.46._ffn.wgate_backward@0,N,transformer.46._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.46._ffn.wdown_backward@0,N,transformer.46._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.46._assembled_weight_backward@0,N,transformer.46._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.47.input_norm.x@0,N,transformer.46.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.47.input_norm.y@0,N,transformer.47.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.47.input_norm.dy@0,N,transformer.47.mha.dx@0,transformer.47.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.47.input_norm.y@0,
transformer.47.input_norm.dx@0,N,transformer.47.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.47.input_norm.x@0,
transformer.47.mha.x@0,N,transformer.47.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.47.mha.wqkv@0,N,transformer.47._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.47.mha.qkv@0,N,transformer.47.mha.x@0,transformer.47.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.47.mha.q@0,N,transformer.47.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.47.mha.k@0,N,transformer.47.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.47.mha.v@0,N,transformer.47.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.47.mha.attn@0,N,transformer.47.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.47.mha.wo@0,N,transformer.47._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.47.mha.o1@0,N,transformer.47.mha.attn@0,transformer.47.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.47.mha.o@0,N,transformer.47.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.47.mha.do@0,N,transformer.47.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.47.mha.o@0,
transformer.47.mha.do1@0,N,transformer.47.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.47.mha.o1@0,
transformer.47.mha.dattn@0,N,transformer.47.mha.do1@0,transformer.47._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.47.mha.dwo@0,N,transformer.47.mha.do1@0,transformer.47.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.47.mha.wo@0,
transformer.47.mha.dv@0,N,transformer.47.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.47.mha.v@0,
transformer.47.mha.dk@0,N,transformer.47.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.47.mha.k@0,
transformer.47.mha.dq@0,N,transformer.47.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.47.mha.q@0,
transformer.47.mha.dkv@0,N,transformer.47.mha.dv@0,transformer.47.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.47.mha.dqkv@0,N,transformer.47.mha.dkv@0,transformer.47.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.47.mha.qkv@0,
transformer.47.mha.dwqkv@0,N,transformer.47.mha.dqkv@0,transformer.47.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.47.mha.wqkv@0,
transformer.47.mha.dx1@0,N,transformer.47.mha.dqkv@0,transformer.47._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.47.mha.dx@0,N,transformer.47.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.47.mha.attn_kernel.q@0,N,transformer.47.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.47.mha.attn_kernel.k@0,N,transformer.47.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.47.mha.attn_kernel.v@0,N,transformer.47.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.47.mha.attn_kernel.k1@0,N,transformer.47.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.47.mha.attn_kernel.v1@0,N,transformer.47.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.47.mha.attn_kernel.qkv@0,N,transformer.47.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.47.mha.attn_kernel.k1@0"", ""transformer.47.mha.attn_kernel.v1@0""]}"
transformer.47.mha.attn_kernel.dqkv@0,N,transformer.47.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.47.mha.attn_kernel.qkv@0,
transformer.47.mha.attn_kernel.dq@0,N,transformer.47.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.47.mha.attn_kernel.q@0,
transformer.47.mha.attn_kernel.dk@0,N,transformer.47.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.47.mha.attn_kernel.dv@0,N,transformer.47.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.47.mha_res.x1@0,N,transformer.47.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.47.mha_res.x2@0,N,transformer.47.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.47.mha_res.y@0,N,transformer.47.mha_res.x1@0,transformer.47.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.47.mha_res.dy@0,N,transformer.47.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.47.mha_res.y@0,
transformer.47.mha_res.dx1@0,N,transformer.47.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.47.mha_res.x1@0,
transformer.47.mha_res.dx2@0,N,transformer.47.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.47.mha_res.x2@0,
transformer.47.post_attn_norm.x@0,N,transformer.47.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.47.post_attn_norm.y@0,N,transformer.47.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.47.post_attn_norm.dy@0,N,transformer.47.ffn.dx0@0,transformer.47.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.47.post_attn_norm.y@0,
transformer.47.post_attn_norm.dx@0,N,transformer.47.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.47.post_attn_norm.x@0,
transformer.47.ffn.x0@0,N,transformer.47.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.47.ffn.wgate@0,N,transformer.47._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.47.ffn.wdown@0,N,transformer.47._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.47.ffn.x00@0,N,transformer.47.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.47.ffn.xgate@0,N,transformer.47.ffn.x00@0,transformer.47.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.47.ffn.xdown1@0,N,transformer.47.ffn.xgate@0,transformer.47.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.47.ffn.xdown@0,N,transformer.47.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.47.ffn.dxdown@0,N,transformer.47.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.47.ffn.xdown@0,
transformer.47.ffn.dxdown2@0,N,transformer.47.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.47.ffn.dwdown@0,N,transformer.47.ffn.dxdown2@0,transformer.47.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.47.ffn.wdown@0,
transformer.47.ffn.dxgate@0,N,transformer.47.ffn.dxdown2@0,transformer.47._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.47.ffn.xgate@0,
transformer.47.ffn.x01@0,N,transformer.47.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.47.ffn.dwgate@0,N,transformer.47.ffn.dxgate@0,transformer.47.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.47.ffn.wgate@0,
transformer.47.ffn.dx000@0,N,transformer.47.ffn.dxgate@0,transformer.47._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.47.ffn.dx0@0,N,transformer.47.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.47.ffn_res.x1@0,N,transformer.47.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.47.ffn_res.x2@0,N,transformer.47.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.47.ffn_res.y@0,N,transformer.47.ffn_res.x1@0,transformer.47.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.47.ffn_res.dy@0,N,transformer.48.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.47.ffn_res.y@0,
transformer.47.ffn_res.dx1@0,N,transformer.47.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.47.ffn_res.x1@0,
transformer.47.ffn_res.dx2@0,N,transformer.47.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.47.ffn_res.x2@0,
transformer.47._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.47._assembled_weight@0,N,transformer.47._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.47._sharded_grad@0,N,transformer.47._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.47._sharded_weight@0,
transformer.47._assembled_grad@0,N,transformer.47.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.47.mha.dwo@0"", ""transformer.47.ffn.dwgate@0"", ""transformer.47.ffn.dwdown@0""]}"
transformer.47._mha.wqkv_backward@0,N,transformer.47._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.47._mha.wo_backward@0,N,transformer.47._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.47._ffn.wgate_backward@0,N,transformer.47._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.47._ffn.wdown_backward@0,N,transformer.47._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.47._assembled_weight_backward@0,N,transformer.47._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.48.input_norm.x@0,N,transformer.47.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.48.input_norm.y@0,N,transformer.48.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.48.input_norm.dy@0,N,transformer.48.mha.dx@0,transformer.48.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.48.input_norm.y@0,
transformer.48.input_norm.dx@0,N,transformer.48.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.48.input_norm.x@0,
transformer.48.mha.x@0,N,transformer.48.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.48.mha.wqkv@0,N,transformer.48._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.48.mha.qkv@0,N,transformer.48.mha.x@0,transformer.48.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.48.mha.q@0,N,transformer.48.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.48.mha.k@0,N,transformer.48.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.48.mha.v@0,N,transformer.48.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.48.mha.attn@0,N,transformer.48.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.48.mha.wo@0,N,transformer.48._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.48.mha.o1@0,N,transformer.48.mha.attn@0,transformer.48.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.48.mha.o@0,N,transformer.48.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.48.mha.do@0,N,transformer.48.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.48.mha.o@0,
transformer.48.mha.do1@0,N,transformer.48.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.48.mha.o1@0,
transformer.48.mha.dattn@0,N,transformer.48.mha.do1@0,transformer.48._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.48.mha.dwo@0,N,transformer.48.mha.do1@0,transformer.48.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.48.mha.wo@0,
transformer.48.mha.dv@0,N,transformer.48.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.48.mha.v@0,
transformer.48.mha.dk@0,N,transformer.48.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.48.mha.k@0,
transformer.48.mha.dq@0,N,transformer.48.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.48.mha.q@0,
transformer.48.mha.dkv@0,N,transformer.48.mha.dv@0,transformer.48.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.48.mha.dqkv@0,N,transformer.48.mha.dkv@0,transformer.48.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.48.mha.qkv@0,
transformer.48.mha.dwqkv@0,N,transformer.48.mha.dqkv@0,transformer.48.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.48.mha.wqkv@0,
transformer.48.mha.dx1@0,N,transformer.48.mha.dqkv@0,transformer.48._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.48.mha.dx@0,N,transformer.48.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.48.mha.attn_kernel.q@0,N,transformer.48.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.48.mha.attn_kernel.k@0,N,transformer.48.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.48.mha.attn_kernel.v@0,N,transformer.48.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.48.mha.attn_kernel.k1@0,N,transformer.48.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.48.mha.attn_kernel.v1@0,N,transformer.48.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.48.mha.attn_kernel.qkv@0,N,transformer.48.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.48.mha.attn_kernel.k1@0"", ""transformer.48.mha.attn_kernel.v1@0""]}"
transformer.48.mha.attn_kernel.dqkv@0,N,transformer.48.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.48.mha.attn_kernel.qkv@0,
transformer.48.mha.attn_kernel.dq@0,N,transformer.48.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.48.mha.attn_kernel.q@0,
transformer.48.mha.attn_kernel.dk@0,N,transformer.48.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.48.mha.attn_kernel.dv@0,N,transformer.48.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.48.mha_res.x1@0,N,transformer.48.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.48.mha_res.x2@0,N,transformer.48.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.48.mha_res.y@0,N,transformer.48.mha_res.x1@0,transformer.48.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.48.mha_res.dy@0,N,transformer.48.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.48.mha_res.y@0,
transformer.48.mha_res.dx1@0,N,transformer.48.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.48.mha_res.x1@0,
transformer.48.mha_res.dx2@0,N,transformer.48.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.48.mha_res.x2@0,
transformer.48.post_attn_norm.x@0,N,transformer.48.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.48.post_attn_norm.y@0,N,transformer.48.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.48.post_attn_norm.dy@0,N,transformer.48.ffn.dx0@0,transformer.48.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.48.post_attn_norm.y@0,
transformer.48.post_attn_norm.dx@0,N,transformer.48.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.48.post_attn_norm.x@0,
transformer.48.ffn.x0@0,N,transformer.48.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.48.ffn.wgate@0,N,transformer.48._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.48.ffn.wdown@0,N,transformer.48._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.48.ffn.x00@0,N,transformer.48.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.48.ffn.xgate@0,N,transformer.48.ffn.x00@0,transformer.48.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.48.ffn.xdown1@0,N,transformer.48.ffn.xgate@0,transformer.48.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.48.ffn.xdown@0,N,transformer.48.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.48.ffn.dxdown@0,N,transformer.48.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.48.ffn.xdown@0,
transformer.48.ffn.dxdown2@0,N,transformer.48.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.48.ffn.dwdown@0,N,transformer.48.ffn.dxdown2@0,transformer.48.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.48.ffn.wdown@0,
transformer.48.ffn.dxgate@0,N,transformer.48.ffn.dxdown2@0,transformer.48._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.48.ffn.xgate@0,
transformer.48.ffn.x01@0,N,transformer.48.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.48.ffn.dwgate@0,N,transformer.48.ffn.dxgate@0,transformer.48.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.48.ffn.wgate@0,
transformer.48.ffn.dx000@0,N,transformer.48.ffn.dxgate@0,transformer.48._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.48.ffn.dx0@0,N,transformer.48.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.48.ffn_res.x1@0,N,transformer.48.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.48.ffn_res.x2@0,N,transformer.48.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.48.ffn_res.y@0,N,transformer.48.ffn_res.x1@0,transformer.48.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.48.ffn_res.dy@0,N,transformer.49.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.48.ffn_res.y@0,
transformer.48.ffn_res.dx1@0,N,transformer.48.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.48.ffn_res.x1@0,
transformer.48.ffn_res.dx2@0,N,transformer.48.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.48.ffn_res.x2@0,
transformer.48._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.48._assembled_weight@0,N,transformer.48._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.48._sharded_grad@0,N,transformer.48._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.48._sharded_weight@0,
transformer.48._assembled_grad@0,N,transformer.48.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.48.mha.dwo@0"", ""transformer.48.ffn.dwgate@0"", ""transformer.48.ffn.dwdown@0""]}"
transformer.48._mha.wqkv_backward@0,N,transformer.48._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.48._mha.wo_backward@0,N,transformer.48._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.48._ffn.wgate_backward@0,N,transformer.48._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.48._ffn.wdown_backward@0,N,transformer.48._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.48._assembled_weight_backward@0,N,transformer.48._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.49.input_norm.x@0,N,transformer.48.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.49.input_norm.y@0,N,transformer.49.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.49.input_norm.dy@0,N,transformer.49.mha.dx@0,transformer.49.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.49.input_norm.y@0,
transformer.49.input_norm.dx@0,N,transformer.49.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.49.input_norm.x@0,
transformer.49.mha.x@0,N,transformer.49.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.49.mha.wqkv@0,N,transformer.49._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.49.mha.qkv@0,N,transformer.49.mha.x@0,transformer.49.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.49.mha.q@0,N,transformer.49.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.49.mha.k@0,N,transformer.49.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.49.mha.v@0,N,transformer.49.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.49.mha.attn@0,N,transformer.49.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.49.mha.wo@0,N,transformer.49._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.49.mha.o1@0,N,transformer.49.mha.attn@0,transformer.49.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.49.mha.o@0,N,transformer.49.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.49.mha.do@0,N,transformer.49.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.49.mha.o@0,
transformer.49.mha.do1@0,N,transformer.49.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.49.mha.o1@0,
transformer.49.mha.dattn@0,N,transformer.49.mha.do1@0,transformer.49._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.49.mha.dwo@0,N,transformer.49.mha.do1@0,transformer.49.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.49.mha.wo@0,
transformer.49.mha.dv@0,N,transformer.49.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.49.mha.v@0,
transformer.49.mha.dk@0,N,transformer.49.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.49.mha.k@0,
transformer.49.mha.dq@0,N,transformer.49.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.49.mha.q@0,
transformer.49.mha.dkv@0,N,transformer.49.mha.dv@0,transformer.49.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.49.mha.dqkv@0,N,transformer.49.mha.dkv@0,transformer.49.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.49.mha.qkv@0,
transformer.49.mha.dwqkv@0,N,transformer.49.mha.dqkv@0,transformer.49.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.49.mha.wqkv@0,
transformer.49.mha.dx1@0,N,transformer.49.mha.dqkv@0,transformer.49._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.49.mha.dx@0,N,transformer.49.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.49.mha.attn_kernel.q@0,N,transformer.49.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.49.mha.attn_kernel.k@0,N,transformer.49.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.49.mha.attn_kernel.v@0,N,transformer.49.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.49.mha.attn_kernel.k1@0,N,transformer.49.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.49.mha.attn_kernel.v1@0,N,transformer.49.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.49.mha.attn_kernel.qkv@0,N,transformer.49.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.49.mha.attn_kernel.k1@0"", ""transformer.49.mha.attn_kernel.v1@0""]}"
transformer.49.mha.attn_kernel.dqkv@0,N,transformer.49.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.49.mha.attn_kernel.qkv@0,
transformer.49.mha.attn_kernel.dq@0,N,transformer.49.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.49.mha.attn_kernel.q@0,
transformer.49.mha.attn_kernel.dk@0,N,transformer.49.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.49.mha.attn_kernel.dv@0,N,transformer.49.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.49.mha_res.x1@0,N,transformer.49.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.49.mha_res.x2@0,N,transformer.49.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.49.mha_res.y@0,N,transformer.49.mha_res.x1@0,transformer.49.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.49.mha_res.dy@0,N,transformer.49.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.49.mha_res.y@0,
transformer.49.mha_res.dx1@0,N,transformer.49.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.49.mha_res.x1@0,
transformer.49.mha_res.dx2@0,N,transformer.49.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.49.mha_res.x2@0,
transformer.49.post_attn_norm.x@0,N,transformer.49.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.49.post_attn_norm.y@0,N,transformer.49.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.49.post_attn_norm.dy@0,N,transformer.49.ffn.dx0@0,transformer.49.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.49.post_attn_norm.y@0,
transformer.49.post_attn_norm.dx@0,N,transformer.49.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.49.post_attn_norm.x@0,
transformer.49.ffn.x0@0,N,transformer.49.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.49.ffn.wgate@0,N,transformer.49._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.49.ffn.wdown@0,N,transformer.49._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.49.ffn.x00@0,N,transformer.49.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.49.ffn.xgate@0,N,transformer.49.ffn.x00@0,transformer.49.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.49.ffn.xdown1@0,N,transformer.49.ffn.xgate@0,transformer.49.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.49.ffn.xdown@0,N,transformer.49.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.49.ffn.dxdown@0,N,transformer.49.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.49.ffn.xdown@0,
transformer.49.ffn.dxdown2@0,N,transformer.49.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.49.ffn.dwdown@0,N,transformer.49.ffn.dxdown2@0,transformer.49.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.49.ffn.wdown@0,
transformer.49.ffn.dxgate@0,N,transformer.49.ffn.dxdown2@0,transformer.49._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.49.ffn.xgate@0,
transformer.49.ffn.x01@0,N,transformer.49.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.49.ffn.dwgate@0,N,transformer.49.ffn.dxgate@0,transformer.49.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.49.ffn.wgate@0,
transformer.49.ffn.dx000@0,N,transformer.49.ffn.dxgate@0,transformer.49._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.49.ffn.dx0@0,N,transformer.49.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.49.ffn_res.x1@0,N,transformer.49.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.49.ffn_res.x2@0,N,transformer.49.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.49.ffn_res.y@0,N,transformer.49.ffn_res.x1@0,transformer.49.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.49.ffn_res.dy@0,N,transformer.50.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.49.ffn_res.y@0,
transformer.49.ffn_res.dx1@0,N,transformer.49.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.49.ffn_res.x1@0,
transformer.49.ffn_res.dx2@0,N,transformer.49.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.49.ffn_res.x2@0,
transformer.49._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.49._assembled_weight@0,N,transformer.49._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.49._sharded_grad@0,N,transformer.49._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.49._sharded_weight@0,
transformer.49._assembled_grad@0,N,transformer.49.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.49.mha.dwo@0"", ""transformer.49.ffn.dwgate@0"", ""transformer.49.ffn.dwdown@0""]}"
transformer.49._mha.wqkv_backward@0,N,transformer.49._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.49._mha.wo_backward@0,N,transformer.49._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.49._ffn.wgate_backward@0,N,transformer.49._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.49._ffn.wdown_backward@0,N,transformer.49._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.49._assembled_weight_backward@0,N,transformer.49._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.50.input_norm.x@0,N,transformer.49.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.50.input_norm.y@0,N,transformer.50.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.50.input_norm.dy@0,N,transformer.50.mha.dx@0,transformer.50.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.50.input_norm.y@0,
transformer.50.input_norm.dx@0,N,transformer.50.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.50.input_norm.x@0,
transformer.50.mha.x@0,N,transformer.50.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.50.mha.wqkv@0,N,transformer.50._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.50.mha.qkv@0,N,transformer.50.mha.x@0,transformer.50.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.50.mha.q@0,N,transformer.50.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.50.mha.k@0,N,transformer.50.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.50.mha.v@0,N,transformer.50.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.50.mha.attn@0,N,transformer.50.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.50.mha.wo@0,N,transformer.50._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.50.mha.o1@0,N,transformer.50.mha.attn@0,transformer.50.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.50.mha.o@0,N,transformer.50.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.50.mha.do@0,N,transformer.50.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.50.mha.o@0,
transformer.50.mha.do1@0,N,transformer.50.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.50.mha.o1@0,
transformer.50.mha.dattn@0,N,transformer.50.mha.do1@0,transformer.50._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.50.mha.dwo@0,N,transformer.50.mha.do1@0,transformer.50.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.50.mha.wo@0,
transformer.50.mha.dv@0,N,transformer.50.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.50.mha.v@0,
transformer.50.mha.dk@0,N,transformer.50.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.50.mha.k@0,
transformer.50.mha.dq@0,N,transformer.50.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.50.mha.q@0,
transformer.50.mha.dkv@0,N,transformer.50.mha.dv@0,transformer.50.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.50.mha.dqkv@0,N,transformer.50.mha.dkv@0,transformer.50.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.50.mha.qkv@0,
transformer.50.mha.dwqkv@0,N,transformer.50.mha.dqkv@0,transformer.50.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.50.mha.wqkv@0,
transformer.50.mha.dx1@0,N,transformer.50.mha.dqkv@0,transformer.50._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.50.mha.dx@0,N,transformer.50.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.50.mha.attn_kernel.q@0,N,transformer.50.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.50.mha.attn_kernel.k@0,N,transformer.50.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.50.mha.attn_kernel.v@0,N,transformer.50.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.50.mha.attn_kernel.k1@0,N,transformer.50.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.50.mha.attn_kernel.v1@0,N,transformer.50.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.50.mha.attn_kernel.qkv@0,N,transformer.50.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.50.mha.attn_kernel.k1@0"", ""transformer.50.mha.attn_kernel.v1@0""]}"
transformer.50.mha.attn_kernel.dqkv@0,N,transformer.50.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.50.mha.attn_kernel.qkv@0,
transformer.50.mha.attn_kernel.dq@0,N,transformer.50.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.50.mha.attn_kernel.q@0,
transformer.50.mha.attn_kernel.dk@0,N,transformer.50.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.50.mha.attn_kernel.dv@0,N,transformer.50.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.50.mha_res.x1@0,N,transformer.50.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.50.mha_res.x2@0,N,transformer.50.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.50.mha_res.y@0,N,transformer.50.mha_res.x1@0,transformer.50.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.50.mha_res.dy@0,N,transformer.50.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.50.mha_res.y@0,
transformer.50.mha_res.dx1@0,N,transformer.50.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.50.mha_res.x1@0,
transformer.50.mha_res.dx2@0,N,transformer.50.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.50.mha_res.x2@0,
transformer.50.post_attn_norm.x@0,N,transformer.50.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.50.post_attn_norm.y@0,N,transformer.50.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.50.post_attn_norm.dy@0,N,transformer.50.ffn.dx0@0,transformer.50.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.50.post_attn_norm.y@0,
transformer.50.post_attn_norm.dx@0,N,transformer.50.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.50.post_attn_norm.x@0,
transformer.50.ffn.x0@0,N,transformer.50.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.50.ffn.wgate@0,N,transformer.50._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.50.ffn.wdown@0,N,transformer.50._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.50.ffn.x00@0,N,transformer.50.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.50.ffn.xgate@0,N,transformer.50.ffn.x00@0,transformer.50.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.50.ffn.xdown1@0,N,transformer.50.ffn.xgate@0,transformer.50.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.50.ffn.xdown@0,N,transformer.50.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.50.ffn.dxdown@0,N,transformer.50.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.50.ffn.xdown@0,
transformer.50.ffn.dxdown2@0,N,transformer.50.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.50.ffn.dwdown@0,N,transformer.50.ffn.dxdown2@0,transformer.50.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.50.ffn.wdown@0,
transformer.50.ffn.dxgate@0,N,transformer.50.ffn.dxdown2@0,transformer.50._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.50.ffn.xgate@0,
transformer.50.ffn.x01@0,N,transformer.50.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.50.ffn.dwgate@0,N,transformer.50.ffn.dxgate@0,transformer.50.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.50.ffn.wgate@0,
transformer.50.ffn.dx000@0,N,transformer.50.ffn.dxgate@0,transformer.50._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.50.ffn.dx0@0,N,transformer.50.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.50.ffn_res.x1@0,N,transformer.50.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.50.ffn_res.x2@0,N,transformer.50.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.50.ffn_res.y@0,N,transformer.50.ffn_res.x1@0,transformer.50.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.50.ffn_res.dy@0,N,transformer.51.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.50.ffn_res.y@0,
transformer.50.ffn_res.dx1@0,N,transformer.50.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.50.ffn_res.x1@0,
transformer.50.ffn_res.dx2@0,N,transformer.50.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.50.ffn_res.x2@0,
transformer.50._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.50._assembled_weight@0,N,transformer.50._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.50._sharded_grad@0,N,transformer.50._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.50._sharded_weight@0,
transformer.50._assembled_grad@0,N,transformer.50.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.50.mha.dwo@0"", ""transformer.50.ffn.dwgate@0"", ""transformer.50.ffn.dwdown@0""]}"
transformer.50._mha.wqkv_backward@0,N,transformer.50._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.50._mha.wo_backward@0,N,transformer.50._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.50._ffn.wgate_backward@0,N,transformer.50._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.50._ffn.wdown_backward@0,N,transformer.50._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.50._assembled_weight_backward@0,N,transformer.50._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.51.input_norm.x@0,N,transformer.50.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.51.input_norm.y@0,N,transformer.51.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.51.input_norm.dy@0,N,transformer.51.mha.dx@0,transformer.51.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.51.input_norm.y@0,
transformer.51.input_norm.dx@0,N,transformer.51.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.51.input_norm.x@0,
transformer.51.mha.x@0,N,transformer.51.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.51.mha.wqkv@0,N,transformer.51._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.51.mha.qkv@0,N,transformer.51.mha.x@0,transformer.51.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.51.mha.q@0,N,transformer.51.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.51.mha.k@0,N,transformer.51.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.51.mha.v@0,N,transformer.51.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.51.mha.attn@0,N,transformer.51.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.51.mha.wo@0,N,transformer.51._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.51.mha.o1@0,N,transformer.51.mha.attn@0,transformer.51.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.51.mha.o@0,N,transformer.51.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.51.mha.do@0,N,transformer.51.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.51.mha.o@0,
transformer.51.mha.do1@0,N,transformer.51.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.51.mha.o1@0,
transformer.51.mha.dattn@0,N,transformer.51.mha.do1@0,transformer.51._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.51.mha.dwo@0,N,transformer.51.mha.do1@0,transformer.51.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.51.mha.wo@0,
transformer.51.mha.dv@0,N,transformer.51.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.51.mha.v@0,
transformer.51.mha.dk@0,N,transformer.51.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.51.mha.k@0,
transformer.51.mha.dq@0,N,transformer.51.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.51.mha.q@0,
transformer.51.mha.dkv@0,N,transformer.51.mha.dv@0,transformer.51.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.51.mha.dqkv@0,N,transformer.51.mha.dkv@0,transformer.51.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.51.mha.qkv@0,
transformer.51.mha.dwqkv@0,N,transformer.51.mha.dqkv@0,transformer.51.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.51.mha.wqkv@0,
transformer.51.mha.dx1@0,N,transformer.51.mha.dqkv@0,transformer.51._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.51.mha.dx@0,N,transformer.51.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.51.mha.attn_kernel.q@0,N,transformer.51.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.51.mha.attn_kernel.k@0,N,transformer.51.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.51.mha.attn_kernel.v@0,N,transformer.51.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.51.mha.attn_kernel.k1@0,N,transformer.51.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.51.mha.attn_kernel.v1@0,N,transformer.51.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.51.mha.attn_kernel.qkv@0,N,transformer.51.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.51.mha.attn_kernel.k1@0"", ""transformer.51.mha.attn_kernel.v1@0""]}"
transformer.51.mha.attn_kernel.dqkv@0,N,transformer.51.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.51.mha.attn_kernel.qkv@0,
transformer.51.mha.attn_kernel.dq@0,N,transformer.51.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.51.mha.attn_kernel.q@0,
transformer.51.mha.attn_kernel.dk@0,N,transformer.51.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.51.mha.attn_kernel.dv@0,N,transformer.51.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.51.mha_res.x1@0,N,transformer.51.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.51.mha_res.x2@0,N,transformer.51.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.51.mha_res.y@0,N,transformer.51.mha_res.x1@0,transformer.51.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.51.mha_res.dy@0,N,transformer.51.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.51.mha_res.y@0,
transformer.51.mha_res.dx1@0,N,transformer.51.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.51.mha_res.x1@0,
transformer.51.mha_res.dx2@0,N,transformer.51.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.51.mha_res.x2@0,
transformer.51.post_attn_norm.x@0,N,transformer.51.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.51.post_attn_norm.y@0,N,transformer.51.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.51.post_attn_norm.dy@0,N,transformer.51.ffn.dx0@0,transformer.51.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.51.post_attn_norm.y@0,
transformer.51.post_attn_norm.dx@0,N,transformer.51.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.51.post_attn_norm.x@0,
transformer.51.ffn.x0@0,N,transformer.51.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.51.ffn.wgate@0,N,transformer.51._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.51.ffn.wdown@0,N,transformer.51._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.51.ffn.x00@0,N,transformer.51.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.51.ffn.xgate@0,N,transformer.51.ffn.x00@0,transformer.51.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.51.ffn.xdown1@0,N,transformer.51.ffn.xgate@0,transformer.51.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.51.ffn.xdown@0,N,transformer.51.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.51.ffn.dxdown@0,N,transformer.51.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.51.ffn.xdown@0,
transformer.51.ffn.dxdown2@0,N,transformer.51.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.51.ffn.dwdown@0,N,transformer.51.ffn.dxdown2@0,transformer.51.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.51.ffn.wdown@0,
transformer.51.ffn.dxgate@0,N,transformer.51.ffn.dxdown2@0,transformer.51._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.51.ffn.xgate@0,
transformer.51.ffn.x01@0,N,transformer.51.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.51.ffn.dwgate@0,N,transformer.51.ffn.dxgate@0,transformer.51.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.51.ffn.wgate@0,
transformer.51.ffn.dx000@0,N,transformer.51.ffn.dxgate@0,transformer.51._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.51.ffn.dx0@0,N,transformer.51.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.51.ffn_res.x1@0,N,transformer.51.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.51.ffn_res.x2@0,N,transformer.51.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.51.ffn_res.y@0,N,transformer.51.ffn_res.x1@0,transformer.51.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.51.ffn_res.dy@0,N,transformer.52.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.51.ffn_res.y@0,
transformer.51.ffn_res.dx1@0,N,transformer.51.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.51.ffn_res.x1@0,
transformer.51.ffn_res.dx2@0,N,transformer.51.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.51.ffn_res.x2@0,
transformer.51._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.51._assembled_weight@0,N,transformer.51._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.51._sharded_grad@0,N,transformer.51._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.51._sharded_weight@0,
transformer.51._assembled_grad@0,N,transformer.51.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.51.mha.dwo@0"", ""transformer.51.ffn.dwgate@0"", ""transformer.51.ffn.dwdown@0""]}"
transformer.51._mha.wqkv_backward@0,N,transformer.51._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.51._mha.wo_backward@0,N,transformer.51._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.51._ffn.wgate_backward@0,N,transformer.51._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.51._ffn.wdown_backward@0,N,transformer.51._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.51._assembled_weight_backward@0,N,transformer.51._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.52.input_norm.x@0,N,transformer.51.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.52.input_norm.y@0,N,transformer.52.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.52.input_norm.dy@0,N,transformer.52.mha.dx@0,transformer.52.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.52.input_norm.y@0,
transformer.52.input_norm.dx@0,N,transformer.52.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.52.input_norm.x@0,
transformer.52.mha.x@0,N,transformer.52.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.52.mha.wqkv@0,N,transformer.52._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.52.mha.qkv@0,N,transformer.52.mha.x@0,transformer.52.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.52.mha.q@0,N,transformer.52.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.52.mha.k@0,N,transformer.52.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.52.mha.v@0,N,transformer.52.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.52.mha.attn@0,N,transformer.52.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.52.mha.wo@0,N,transformer.52._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.52.mha.o1@0,N,transformer.52.mha.attn@0,transformer.52.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.52.mha.o@0,N,transformer.52.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.52.mha.do@0,N,transformer.52.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.52.mha.o@0,
transformer.52.mha.do1@0,N,transformer.52.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.52.mha.o1@0,
transformer.52.mha.dattn@0,N,transformer.52.mha.do1@0,transformer.52._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.52.mha.dwo@0,N,transformer.52.mha.do1@0,transformer.52.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.52.mha.wo@0,
transformer.52.mha.dv@0,N,transformer.52.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.52.mha.v@0,
transformer.52.mha.dk@0,N,transformer.52.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.52.mha.k@0,
transformer.52.mha.dq@0,N,transformer.52.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.52.mha.q@0,
transformer.52.mha.dkv@0,N,transformer.52.mha.dv@0,transformer.52.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.52.mha.dqkv@0,N,transformer.52.mha.dkv@0,transformer.52.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.52.mha.qkv@0,
transformer.52.mha.dwqkv@0,N,transformer.52.mha.dqkv@0,transformer.52.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.52.mha.wqkv@0,
transformer.52.mha.dx1@0,N,transformer.52.mha.dqkv@0,transformer.52._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.52.mha.dx@0,N,transformer.52.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.52.mha.attn_kernel.q@0,N,transformer.52.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.52.mha.attn_kernel.k@0,N,transformer.52.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.52.mha.attn_kernel.v@0,N,transformer.52.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.52.mha.attn_kernel.k1@0,N,transformer.52.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.52.mha.attn_kernel.v1@0,N,transformer.52.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.52.mha.attn_kernel.qkv@0,N,transformer.52.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.52.mha.attn_kernel.k1@0"", ""transformer.52.mha.attn_kernel.v1@0""]}"
transformer.52.mha.attn_kernel.dqkv@0,N,transformer.52.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.52.mha.attn_kernel.qkv@0,
transformer.52.mha.attn_kernel.dq@0,N,transformer.52.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.52.mha.attn_kernel.q@0,
transformer.52.mha.attn_kernel.dk@0,N,transformer.52.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.52.mha.attn_kernel.dv@0,N,transformer.52.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.52.mha_res.x1@0,N,transformer.52.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.52.mha_res.x2@0,N,transformer.52.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.52.mha_res.y@0,N,transformer.52.mha_res.x1@0,transformer.52.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.52.mha_res.dy@0,N,transformer.52.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.52.mha_res.y@0,
transformer.52.mha_res.dx1@0,N,transformer.52.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.52.mha_res.x1@0,
transformer.52.mha_res.dx2@0,N,transformer.52.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.52.mha_res.x2@0,
transformer.52.post_attn_norm.x@0,N,transformer.52.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.52.post_attn_norm.y@0,N,transformer.52.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.52.post_attn_norm.dy@0,N,transformer.52.ffn.dx0@0,transformer.52.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.52.post_attn_norm.y@0,
transformer.52.post_attn_norm.dx@0,N,transformer.52.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.52.post_attn_norm.x@0,
transformer.52.ffn.x0@0,N,transformer.52.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.52.ffn.wgate@0,N,transformer.52._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.52.ffn.wdown@0,N,transformer.52._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.52.ffn.x00@0,N,transformer.52.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.52.ffn.xgate@0,N,transformer.52.ffn.x00@0,transformer.52.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.52.ffn.xdown1@0,N,transformer.52.ffn.xgate@0,transformer.52.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.52.ffn.xdown@0,N,transformer.52.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.52.ffn.dxdown@0,N,transformer.52.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.52.ffn.xdown@0,
transformer.52.ffn.dxdown2@0,N,transformer.52.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.52.ffn.dwdown@0,N,transformer.52.ffn.dxdown2@0,transformer.52.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.52.ffn.wdown@0,
transformer.52.ffn.dxgate@0,N,transformer.52.ffn.dxdown2@0,transformer.52._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.52.ffn.xgate@0,
transformer.52.ffn.x01@0,N,transformer.52.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.52.ffn.dwgate@0,N,transformer.52.ffn.dxgate@0,transformer.52.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.52.ffn.wgate@0,
transformer.52.ffn.dx000@0,N,transformer.52.ffn.dxgate@0,transformer.52._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.52.ffn.dx0@0,N,transformer.52.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.52.ffn_res.x1@0,N,transformer.52.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.52.ffn_res.x2@0,N,transformer.52.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.52.ffn_res.y@0,N,transformer.52.ffn_res.x1@0,transformer.52.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.52.ffn_res.dy@0,N,transformer.53.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.52.ffn_res.y@0,
transformer.52.ffn_res.dx1@0,N,transformer.52.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.52.ffn_res.x1@0,
transformer.52.ffn_res.dx2@0,N,transformer.52.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.52.ffn_res.x2@0,
transformer.52._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.52._assembled_weight@0,N,transformer.52._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.52._sharded_grad@0,N,transformer.52._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.52._sharded_weight@0,
transformer.52._assembled_grad@0,N,transformer.52.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.52.mha.dwo@0"", ""transformer.52.ffn.dwgate@0"", ""transformer.52.ffn.dwdown@0""]}"
transformer.52._mha.wqkv_backward@0,N,transformer.52._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.52._mha.wo_backward@0,N,transformer.52._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.52._ffn.wgate_backward@0,N,transformer.52._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.52._ffn.wdown_backward@0,N,transformer.52._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.52._assembled_weight_backward@0,N,transformer.52._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.53.input_norm.x@0,N,transformer.52.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.53.input_norm.y@0,N,transformer.53.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.53.input_norm.dy@0,N,transformer.53.mha.dx@0,transformer.53.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.53.input_norm.y@0,
transformer.53.input_norm.dx@0,N,transformer.53.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.53.input_norm.x@0,
transformer.53.mha.x@0,N,transformer.53.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.53.mha.wqkv@0,N,transformer.53._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.53.mha.qkv@0,N,transformer.53.mha.x@0,transformer.53.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.53.mha.q@0,N,transformer.53.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.53.mha.k@0,N,transformer.53.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.53.mha.v@0,N,transformer.53.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.53.mha.attn@0,N,transformer.53.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.53.mha.wo@0,N,transformer.53._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.53.mha.o1@0,N,transformer.53.mha.attn@0,transformer.53.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.53.mha.o@0,N,transformer.53.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.53.mha.do@0,N,transformer.53.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.53.mha.o@0,
transformer.53.mha.do1@0,N,transformer.53.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.53.mha.o1@0,
transformer.53.mha.dattn@0,N,transformer.53.mha.do1@0,transformer.53._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.53.mha.dwo@0,N,transformer.53.mha.do1@0,transformer.53.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.53.mha.wo@0,
transformer.53.mha.dv@0,N,transformer.53.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.53.mha.v@0,
transformer.53.mha.dk@0,N,transformer.53.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.53.mha.k@0,
transformer.53.mha.dq@0,N,transformer.53.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.53.mha.q@0,
transformer.53.mha.dkv@0,N,transformer.53.mha.dv@0,transformer.53.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.53.mha.dqkv@0,N,transformer.53.mha.dkv@0,transformer.53.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.53.mha.qkv@0,
transformer.53.mha.dwqkv@0,N,transformer.53.mha.dqkv@0,transformer.53.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.53.mha.wqkv@0,
transformer.53.mha.dx1@0,N,transformer.53.mha.dqkv@0,transformer.53._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.53.mha.dx@0,N,transformer.53.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.53.mha.attn_kernel.q@0,N,transformer.53.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.53.mha.attn_kernel.k@0,N,transformer.53.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.53.mha.attn_kernel.v@0,N,transformer.53.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.53.mha.attn_kernel.k1@0,N,transformer.53.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.53.mha.attn_kernel.v1@0,N,transformer.53.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.53.mha.attn_kernel.qkv@0,N,transformer.53.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.53.mha.attn_kernel.k1@0"", ""transformer.53.mha.attn_kernel.v1@0""]}"
transformer.53.mha.attn_kernel.dqkv@0,N,transformer.53.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.53.mha.attn_kernel.qkv@0,
transformer.53.mha.attn_kernel.dq@0,N,transformer.53.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.53.mha.attn_kernel.q@0,
transformer.53.mha.attn_kernel.dk@0,N,transformer.53.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.53.mha.attn_kernel.dv@0,N,transformer.53.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.53.mha_res.x1@0,N,transformer.53.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.53.mha_res.x2@0,N,transformer.53.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.53.mha_res.y@0,N,transformer.53.mha_res.x1@0,transformer.53.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.53.mha_res.dy@0,N,transformer.53.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.53.mha_res.y@0,
transformer.53.mha_res.dx1@0,N,transformer.53.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.53.mha_res.x1@0,
transformer.53.mha_res.dx2@0,N,transformer.53.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.53.mha_res.x2@0,
transformer.53.post_attn_norm.x@0,N,transformer.53.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.53.post_attn_norm.y@0,N,transformer.53.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.53.post_attn_norm.dy@0,N,transformer.53.ffn.dx0@0,transformer.53.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.53.post_attn_norm.y@0,
transformer.53.post_attn_norm.dx@0,N,transformer.53.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.53.post_attn_norm.x@0,
transformer.53.ffn.x0@0,N,transformer.53.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.53.ffn.wgate@0,N,transformer.53._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.53.ffn.wdown@0,N,transformer.53._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.53.ffn.x00@0,N,transformer.53.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.53.ffn.xgate@0,N,transformer.53.ffn.x00@0,transformer.53.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.53.ffn.xdown1@0,N,transformer.53.ffn.xgate@0,transformer.53.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.53.ffn.xdown@0,N,transformer.53.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.53.ffn.dxdown@0,N,transformer.53.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.53.ffn.xdown@0,
transformer.53.ffn.dxdown2@0,N,transformer.53.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.53.ffn.dwdown@0,N,transformer.53.ffn.dxdown2@0,transformer.53.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.53.ffn.wdown@0,
transformer.53.ffn.dxgate@0,N,transformer.53.ffn.dxdown2@0,transformer.53._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.53.ffn.xgate@0,
transformer.53.ffn.x01@0,N,transformer.53.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.53.ffn.dwgate@0,N,transformer.53.ffn.dxgate@0,transformer.53.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.53.ffn.wgate@0,
transformer.53.ffn.dx000@0,N,transformer.53.ffn.dxgate@0,transformer.53._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.53.ffn.dx0@0,N,transformer.53.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.53.ffn_res.x1@0,N,transformer.53.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.53.ffn_res.x2@0,N,transformer.53.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.53.ffn_res.y@0,N,transformer.53.ffn_res.x1@0,transformer.53.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.53.ffn_res.dy@0,N,transformer.54.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.53.ffn_res.y@0,
transformer.53.ffn_res.dx1@0,N,transformer.53.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.53.ffn_res.x1@0,
transformer.53.ffn_res.dx2@0,N,transformer.53.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.53.ffn_res.x2@0,
transformer.53._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.53._assembled_weight@0,N,transformer.53._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.53._sharded_grad@0,N,transformer.53._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.53._sharded_weight@0,
transformer.53._assembled_grad@0,N,transformer.53.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.53.mha.dwo@0"", ""transformer.53.ffn.dwgate@0"", ""transformer.53.ffn.dwdown@0""]}"
transformer.53._mha.wqkv_backward@0,N,transformer.53._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.53._mha.wo_backward@0,N,transformer.53._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.53._ffn.wgate_backward@0,N,transformer.53._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.53._ffn.wdown_backward@0,N,transformer.53._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.53._assembled_weight_backward@0,N,transformer.53._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.54.input_norm.x@0,N,transformer.53.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.54.input_norm.y@0,N,transformer.54.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.54.input_norm.dy@0,N,transformer.54.mha.dx@0,transformer.54.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.54.input_norm.y@0,
transformer.54.input_norm.dx@0,N,transformer.54.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.54.input_norm.x@0,
transformer.54.mha.x@0,N,transformer.54.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.54.mha.wqkv@0,N,transformer.54._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.54.mha.qkv@0,N,transformer.54.mha.x@0,transformer.54.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.54.mha.q@0,N,transformer.54.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.54.mha.k@0,N,transformer.54.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.54.mha.v@0,N,transformer.54.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.54.mha.attn@0,N,transformer.54.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.54.mha.wo@0,N,transformer.54._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.54.mha.o1@0,N,transformer.54.mha.attn@0,transformer.54.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.54.mha.o@0,N,transformer.54.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.54.mha.do@0,N,transformer.54.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.54.mha.o@0,
transformer.54.mha.do1@0,N,transformer.54.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.54.mha.o1@0,
transformer.54.mha.dattn@0,N,transformer.54.mha.do1@0,transformer.54._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.54.mha.dwo@0,N,transformer.54.mha.do1@0,transformer.54.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.54.mha.wo@0,
transformer.54.mha.dv@0,N,transformer.54.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.54.mha.v@0,
transformer.54.mha.dk@0,N,transformer.54.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.54.mha.k@0,
transformer.54.mha.dq@0,N,transformer.54.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.54.mha.q@0,
transformer.54.mha.dkv@0,N,transformer.54.mha.dv@0,transformer.54.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.54.mha.dqkv@0,N,transformer.54.mha.dkv@0,transformer.54.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.54.mha.qkv@0,
transformer.54.mha.dwqkv@0,N,transformer.54.mha.dqkv@0,transformer.54.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.54.mha.wqkv@0,
transformer.54.mha.dx1@0,N,transformer.54.mha.dqkv@0,transformer.54._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.54.mha.dx@0,N,transformer.54.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.54.mha.attn_kernel.q@0,N,transformer.54.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.54.mha.attn_kernel.k@0,N,transformer.54.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.54.mha.attn_kernel.v@0,N,transformer.54.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.54.mha.attn_kernel.k1@0,N,transformer.54.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.54.mha.attn_kernel.v1@0,N,transformer.54.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.54.mha.attn_kernel.qkv@0,N,transformer.54.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.54.mha.attn_kernel.k1@0"", ""transformer.54.mha.attn_kernel.v1@0""]}"
transformer.54.mha.attn_kernel.dqkv@0,N,transformer.54.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.54.mha.attn_kernel.qkv@0,
transformer.54.mha.attn_kernel.dq@0,N,transformer.54.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.54.mha.attn_kernel.q@0,
transformer.54.mha.attn_kernel.dk@0,N,transformer.54.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.54.mha.attn_kernel.dv@0,N,transformer.54.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.54.mha_res.x1@0,N,transformer.54.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.54.mha_res.x2@0,N,transformer.54.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.54.mha_res.y@0,N,transformer.54.mha_res.x1@0,transformer.54.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.54.mha_res.dy@0,N,transformer.54.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.54.mha_res.y@0,
transformer.54.mha_res.dx1@0,N,transformer.54.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.54.mha_res.x1@0,
transformer.54.mha_res.dx2@0,N,transformer.54.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.54.mha_res.x2@0,
transformer.54.post_attn_norm.x@0,N,transformer.54.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.54.post_attn_norm.y@0,N,transformer.54.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.54.post_attn_norm.dy@0,N,transformer.54.ffn.dx0@0,transformer.54.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.54.post_attn_norm.y@0,
transformer.54.post_attn_norm.dx@0,N,transformer.54.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.54.post_attn_norm.x@0,
transformer.54.ffn.x0@0,N,transformer.54.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.54.ffn.wgate@0,N,transformer.54._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.54.ffn.wdown@0,N,transformer.54._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.54.ffn.x00@0,N,transformer.54.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.54.ffn.xgate@0,N,transformer.54.ffn.x00@0,transformer.54.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.54.ffn.xdown1@0,N,transformer.54.ffn.xgate@0,transformer.54.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.54.ffn.xdown@0,N,transformer.54.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.54.ffn.dxdown@0,N,transformer.54.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.54.ffn.xdown@0,
transformer.54.ffn.dxdown2@0,N,transformer.54.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.54.ffn.dwdown@0,N,transformer.54.ffn.dxdown2@0,transformer.54.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.54.ffn.wdown@0,
transformer.54.ffn.dxgate@0,N,transformer.54.ffn.dxdown2@0,transformer.54._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.54.ffn.xgate@0,
transformer.54.ffn.x01@0,N,transformer.54.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.54.ffn.dwgate@0,N,transformer.54.ffn.dxgate@0,transformer.54.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.54.ffn.wgate@0,
transformer.54.ffn.dx000@0,N,transformer.54.ffn.dxgate@0,transformer.54._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.54.ffn.dx0@0,N,transformer.54.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.54.ffn_res.x1@0,N,transformer.54.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.54.ffn_res.x2@0,N,transformer.54.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.54.ffn_res.y@0,N,transformer.54.ffn_res.x1@0,transformer.54.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.54.ffn_res.dy@0,N,transformer.55.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.54.ffn_res.y@0,
transformer.54.ffn_res.dx1@0,N,transformer.54.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.54.ffn_res.x1@0,
transformer.54.ffn_res.dx2@0,N,transformer.54.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.54.ffn_res.x2@0,
transformer.54._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.54._assembled_weight@0,N,transformer.54._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.54._sharded_grad@0,N,transformer.54._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.54._sharded_weight@0,
transformer.54._assembled_grad@0,N,transformer.54.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.54.mha.dwo@0"", ""transformer.54.ffn.dwgate@0"", ""transformer.54.ffn.dwdown@0""]}"
transformer.54._mha.wqkv_backward@0,N,transformer.54._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.54._mha.wo_backward@0,N,transformer.54._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.54._ffn.wgate_backward@0,N,transformer.54._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.54._ffn.wdown_backward@0,N,transformer.54._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.54._assembled_weight_backward@0,N,transformer.54._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.55.input_norm.x@0,N,transformer.54.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.55.input_norm.y@0,N,transformer.55.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.55.input_norm.dy@0,N,transformer.55.mha.dx@0,transformer.55.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.55.input_norm.y@0,
transformer.55.input_norm.dx@0,N,transformer.55.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.55.input_norm.x@0,
transformer.55.mha.x@0,N,transformer.55.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.55.mha.wqkv@0,N,transformer.55._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.55.mha.qkv@0,N,transformer.55.mha.x@0,transformer.55.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.55.mha.q@0,N,transformer.55.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.55.mha.k@0,N,transformer.55.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.55.mha.v@0,N,transformer.55.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.55.mha.attn@0,N,transformer.55.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.55.mha.wo@0,N,transformer.55._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.55.mha.o1@0,N,transformer.55.mha.attn@0,transformer.55.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.55.mha.o@0,N,transformer.55.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.55.mha.do@0,N,transformer.55.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.55.mha.o@0,
transformer.55.mha.do1@0,N,transformer.55.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.55.mha.o1@0,
transformer.55.mha.dattn@0,N,transformer.55.mha.do1@0,transformer.55._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.55.mha.dwo@0,N,transformer.55.mha.do1@0,transformer.55.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.55.mha.wo@0,
transformer.55.mha.dv@0,N,transformer.55.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.55.mha.v@0,
transformer.55.mha.dk@0,N,transformer.55.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.55.mha.k@0,
transformer.55.mha.dq@0,N,transformer.55.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.55.mha.q@0,
transformer.55.mha.dkv@0,N,transformer.55.mha.dv@0,transformer.55.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.55.mha.dqkv@0,N,transformer.55.mha.dkv@0,transformer.55.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.55.mha.qkv@0,
transformer.55.mha.dwqkv@0,N,transformer.55.mha.dqkv@0,transformer.55.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.55.mha.wqkv@0,
transformer.55.mha.dx1@0,N,transformer.55.mha.dqkv@0,transformer.55._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.55.mha.dx@0,N,transformer.55.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.55.mha.attn_kernel.q@0,N,transformer.55.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.55.mha.attn_kernel.k@0,N,transformer.55.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.55.mha.attn_kernel.v@0,N,transformer.55.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.55.mha.attn_kernel.k1@0,N,transformer.55.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.55.mha.attn_kernel.v1@0,N,transformer.55.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.55.mha.attn_kernel.qkv@0,N,transformer.55.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.55.mha.attn_kernel.k1@0"", ""transformer.55.mha.attn_kernel.v1@0""]}"
transformer.55.mha.attn_kernel.dqkv@0,N,transformer.55.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.55.mha.attn_kernel.qkv@0,
transformer.55.mha.attn_kernel.dq@0,N,transformer.55.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.55.mha.attn_kernel.q@0,
transformer.55.mha.attn_kernel.dk@0,N,transformer.55.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.55.mha.attn_kernel.dv@0,N,transformer.55.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.55.mha_res.x1@0,N,transformer.55.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.55.mha_res.x2@0,N,transformer.55.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.55.mha_res.y@0,N,transformer.55.mha_res.x1@0,transformer.55.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.55.mha_res.dy@0,N,transformer.55.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.55.mha_res.y@0,
transformer.55.mha_res.dx1@0,N,transformer.55.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.55.mha_res.x1@0,
transformer.55.mha_res.dx2@0,N,transformer.55.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.55.mha_res.x2@0,
transformer.55.post_attn_norm.x@0,N,transformer.55.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.55.post_attn_norm.y@0,N,transformer.55.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.55.post_attn_norm.dy@0,N,transformer.55.ffn.dx0@0,transformer.55.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.55.post_attn_norm.y@0,
transformer.55.post_attn_norm.dx@0,N,transformer.55.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.55.post_attn_norm.x@0,
transformer.55.ffn.x0@0,N,transformer.55.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.55.ffn.wgate@0,N,transformer.55._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.55.ffn.wdown@0,N,transformer.55._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.55.ffn.x00@0,N,transformer.55.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.55.ffn.xgate@0,N,transformer.55.ffn.x00@0,transformer.55.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.55.ffn.xdown1@0,N,transformer.55.ffn.xgate@0,transformer.55.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.55.ffn.xdown@0,N,transformer.55.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.55.ffn.dxdown@0,N,transformer.55.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.55.ffn.xdown@0,
transformer.55.ffn.dxdown2@0,N,transformer.55.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.55.ffn.dwdown@0,N,transformer.55.ffn.dxdown2@0,transformer.55.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.55.ffn.wdown@0,
transformer.55.ffn.dxgate@0,N,transformer.55.ffn.dxdown2@0,transformer.55._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.55.ffn.xgate@0,
transformer.55.ffn.x01@0,N,transformer.55.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.55.ffn.dwgate@0,N,transformer.55.ffn.dxgate@0,transformer.55.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.55.ffn.wgate@0,
transformer.55.ffn.dx000@0,N,transformer.55.ffn.dxgate@0,transformer.55._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.55.ffn.dx0@0,N,transformer.55.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.55.ffn_res.x1@0,N,transformer.55.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.55.ffn_res.x2@0,N,transformer.55.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.55.ffn_res.y@0,N,transformer.55.ffn_res.x1@0,transformer.55.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.55.ffn_res.dy@0,N,transformer.56.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.55.ffn_res.y@0,
transformer.55.ffn_res.dx1@0,N,transformer.55.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.55.ffn_res.x1@0,
transformer.55.ffn_res.dx2@0,N,transformer.55.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.55.ffn_res.x2@0,
transformer.55._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.55._assembled_weight@0,N,transformer.55._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.55._sharded_grad@0,N,transformer.55._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.55._sharded_weight@0,
transformer.55._assembled_grad@0,N,transformer.55.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.55.mha.dwo@0"", ""transformer.55.ffn.dwgate@0"", ""transformer.55.ffn.dwdown@0""]}"
transformer.55._mha.wqkv_backward@0,N,transformer.55._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.55._mha.wo_backward@0,N,transformer.55._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.55._ffn.wgate_backward@0,N,transformer.55._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.55._ffn.wdown_backward@0,N,transformer.55._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.55._assembled_weight_backward@0,N,transformer.55._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.56.input_norm.x@0,N,transformer.55.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.56.input_norm.y@0,N,transformer.56.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.56.input_norm.dy@0,N,transformer.56.mha.dx@0,transformer.56.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.56.input_norm.y@0,
transformer.56.input_norm.dx@0,N,transformer.56.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.56.input_norm.x@0,
transformer.56.mha.x@0,N,transformer.56.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.56.mha.wqkv@0,N,transformer.56._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.56.mha.qkv@0,N,transformer.56.mha.x@0,transformer.56.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.56.mha.q@0,N,transformer.56.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.56.mha.k@0,N,transformer.56.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.56.mha.v@0,N,transformer.56.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.56.mha.attn@0,N,transformer.56.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.56.mha.wo@0,N,transformer.56._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.56.mha.o1@0,N,transformer.56.mha.attn@0,transformer.56.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.56.mha.o@0,N,transformer.56.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.56.mha.do@0,N,transformer.56.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.56.mha.o@0,
transformer.56.mha.do1@0,N,transformer.56.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.56.mha.o1@0,
transformer.56.mha.dattn@0,N,transformer.56.mha.do1@0,transformer.56._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.56.mha.dwo@0,N,transformer.56.mha.do1@0,transformer.56.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.56.mha.wo@0,
transformer.56.mha.dv@0,N,transformer.56.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.56.mha.v@0,
transformer.56.mha.dk@0,N,transformer.56.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.56.mha.k@0,
transformer.56.mha.dq@0,N,transformer.56.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.56.mha.q@0,
transformer.56.mha.dkv@0,N,transformer.56.mha.dv@0,transformer.56.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.56.mha.dqkv@0,N,transformer.56.mha.dkv@0,transformer.56.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.56.mha.qkv@0,
transformer.56.mha.dwqkv@0,N,transformer.56.mha.dqkv@0,transformer.56.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.56.mha.wqkv@0,
transformer.56.mha.dx1@0,N,transformer.56.mha.dqkv@0,transformer.56._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.56.mha.dx@0,N,transformer.56.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.56.mha.attn_kernel.q@0,N,transformer.56.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.56.mha.attn_kernel.k@0,N,transformer.56.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.56.mha.attn_kernel.v@0,N,transformer.56.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.56.mha.attn_kernel.k1@0,N,transformer.56.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.56.mha.attn_kernel.v1@0,N,transformer.56.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.56.mha.attn_kernel.qkv@0,N,transformer.56.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.56.mha.attn_kernel.k1@0"", ""transformer.56.mha.attn_kernel.v1@0""]}"
transformer.56.mha.attn_kernel.dqkv@0,N,transformer.56.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.56.mha.attn_kernel.qkv@0,
transformer.56.mha.attn_kernel.dq@0,N,transformer.56.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.56.mha.attn_kernel.q@0,
transformer.56.mha.attn_kernel.dk@0,N,transformer.56.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.56.mha.attn_kernel.dv@0,N,transformer.56.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.56.mha_res.x1@0,N,transformer.56.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.56.mha_res.x2@0,N,transformer.56.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.56.mha_res.y@0,N,transformer.56.mha_res.x1@0,transformer.56.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.56.mha_res.dy@0,N,transformer.56.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.56.mha_res.y@0,
transformer.56.mha_res.dx1@0,N,transformer.56.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.56.mha_res.x1@0,
transformer.56.mha_res.dx2@0,N,transformer.56.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.56.mha_res.x2@0,
transformer.56.post_attn_norm.x@0,N,transformer.56.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.56.post_attn_norm.y@0,N,transformer.56.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.56.post_attn_norm.dy@0,N,transformer.56.ffn.dx0@0,transformer.56.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.56.post_attn_norm.y@0,
transformer.56.post_attn_norm.dx@0,N,transformer.56.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.56.post_attn_norm.x@0,
transformer.56.ffn.x0@0,N,transformer.56.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.56.ffn.wgate@0,N,transformer.56._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.56.ffn.wdown@0,N,transformer.56._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.56.ffn.x00@0,N,transformer.56.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.56.ffn.xgate@0,N,transformer.56.ffn.x00@0,transformer.56.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.56.ffn.xdown1@0,N,transformer.56.ffn.xgate@0,transformer.56.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.56.ffn.xdown@0,N,transformer.56.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.56.ffn.dxdown@0,N,transformer.56.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.56.ffn.xdown@0,
transformer.56.ffn.dxdown2@0,N,transformer.56.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.56.ffn.dwdown@0,N,transformer.56.ffn.dxdown2@0,transformer.56.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.56.ffn.wdown@0,
transformer.56.ffn.dxgate@0,N,transformer.56.ffn.dxdown2@0,transformer.56._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.56.ffn.xgate@0,
transformer.56.ffn.x01@0,N,transformer.56.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.56.ffn.dwgate@0,N,transformer.56.ffn.dxgate@0,transformer.56.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.56.ffn.wgate@0,
transformer.56.ffn.dx000@0,N,transformer.56.ffn.dxgate@0,transformer.56._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.56.ffn.dx0@0,N,transformer.56.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.56.ffn_res.x1@0,N,transformer.56.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.56.ffn_res.x2@0,N,transformer.56.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.56.ffn_res.y@0,N,transformer.56.ffn_res.x1@0,transformer.56.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.56.ffn_res.dy@0,N,transformer.57.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.56.ffn_res.y@0,
transformer.56.ffn_res.dx1@0,N,transformer.56.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.56.ffn_res.x1@0,
transformer.56.ffn_res.dx2@0,N,transformer.56.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.56.ffn_res.x2@0,
transformer.56._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.56._assembled_weight@0,N,transformer.56._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.56._sharded_grad@0,N,transformer.56._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.56._sharded_weight@0,
transformer.56._assembled_grad@0,N,transformer.56.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.56.mha.dwo@0"", ""transformer.56.ffn.dwgate@0"", ""transformer.56.ffn.dwdown@0""]}"
transformer.56._mha.wqkv_backward@0,N,transformer.56._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.56._mha.wo_backward@0,N,transformer.56._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.56._ffn.wgate_backward@0,N,transformer.56._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.56._ffn.wdown_backward@0,N,transformer.56._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.56._assembled_weight_backward@0,N,transformer.56._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.57.input_norm.x@0,N,transformer.56.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.57.input_norm.y@0,N,transformer.57.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.57.input_norm.dy@0,N,transformer.57.mha.dx@0,transformer.57.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.57.input_norm.y@0,
transformer.57.input_norm.dx@0,N,transformer.57.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.57.input_norm.x@0,
transformer.57.mha.x@0,N,transformer.57.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.57.mha.wqkv@0,N,transformer.57._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.57.mha.qkv@0,N,transformer.57.mha.x@0,transformer.57.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.57.mha.q@0,N,transformer.57.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.57.mha.k@0,N,transformer.57.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.57.mha.v@0,N,transformer.57.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.57.mha.attn@0,N,transformer.57.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.57.mha.wo@0,N,transformer.57._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.57.mha.o1@0,N,transformer.57.mha.attn@0,transformer.57.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.57.mha.o@0,N,transformer.57.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.57.mha.do@0,N,transformer.57.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.57.mha.o@0,
transformer.57.mha.do1@0,N,transformer.57.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.57.mha.o1@0,
transformer.57.mha.dattn@0,N,transformer.57.mha.do1@0,transformer.57._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.57.mha.dwo@0,N,transformer.57.mha.do1@0,transformer.57.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.57.mha.wo@0,
transformer.57.mha.dv@0,N,transformer.57.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.57.mha.v@0,
transformer.57.mha.dk@0,N,transformer.57.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.57.mha.k@0,
transformer.57.mha.dq@0,N,transformer.57.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.57.mha.q@0,
transformer.57.mha.dkv@0,N,transformer.57.mha.dv@0,transformer.57.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.57.mha.dqkv@0,N,transformer.57.mha.dkv@0,transformer.57.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.57.mha.qkv@0,
transformer.57.mha.dwqkv@0,N,transformer.57.mha.dqkv@0,transformer.57.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.57.mha.wqkv@0,
transformer.57.mha.dx1@0,N,transformer.57.mha.dqkv@0,transformer.57._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.57.mha.dx@0,N,transformer.57.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.57.mha.attn_kernel.q@0,N,transformer.57.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.57.mha.attn_kernel.k@0,N,transformer.57.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.57.mha.attn_kernel.v@0,N,transformer.57.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.57.mha.attn_kernel.k1@0,N,transformer.57.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.57.mha.attn_kernel.v1@0,N,transformer.57.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.57.mha.attn_kernel.qkv@0,N,transformer.57.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.57.mha.attn_kernel.k1@0"", ""transformer.57.mha.attn_kernel.v1@0""]}"
transformer.57.mha.attn_kernel.dqkv@0,N,transformer.57.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.57.mha.attn_kernel.qkv@0,
transformer.57.mha.attn_kernel.dq@0,N,transformer.57.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.57.mha.attn_kernel.q@0,
transformer.57.mha.attn_kernel.dk@0,N,transformer.57.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.57.mha.attn_kernel.dv@0,N,transformer.57.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.57.mha_res.x1@0,N,transformer.57.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.57.mha_res.x2@0,N,transformer.57.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.57.mha_res.y@0,N,transformer.57.mha_res.x1@0,transformer.57.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.57.mha_res.dy@0,N,transformer.57.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.57.mha_res.y@0,
transformer.57.mha_res.dx1@0,N,transformer.57.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.57.mha_res.x1@0,
transformer.57.mha_res.dx2@0,N,transformer.57.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.57.mha_res.x2@0,
transformer.57.post_attn_norm.x@0,N,transformer.57.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.57.post_attn_norm.y@0,N,transformer.57.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.57.post_attn_norm.dy@0,N,transformer.57.ffn.dx0@0,transformer.57.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.57.post_attn_norm.y@0,
transformer.57.post_attn_norm.dx@0,N,transformer.57.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.57.post_attn_norm.x@0,
transformer.57.ffn.x0@0,N,transformer.57.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.57.ffn.wgate@0,N,transformer.57._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.57.ffn.wdown@0,N,transformer.57._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.57.ffn.x00@0,N,transformer.57.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.57.ffn.xgate@0,N,transformer.57.ffn.x00@0,transformer.57.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.57.ffn.xdown1@0,N,transformer.57.ffn.xgate@0,transformer.57.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.57.ffn.xdown@0,N,transformer.57.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.57.ffn.dxdown@0,N,transformer.57.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.57.ffn.xdown@0,
transformer.57.ffn.dxdown2@0,N,transformer.57.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.57.ffn.dwdown@0,N,transformer.57.ffn.dxdown2@0,transformer.57.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.57.ffn.wdown@0,
transformer.57.ffn.dxgate@0,N,transformer.57.ffn.dxdown2@0,transformer.57._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.57.ffn.xgate@0,
transformer.57.ffn.x01@0,N,transformer.57.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.57.ffn.dwgate@0,N,transformer.57.ffn.dxgate@0,transformer.57.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.57.ffn.wgate@0,
transformer.57.ffn.dx000@0,N,transformer.57.ffn.dxgate@0,transformer.57._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.57.ffn.dx0@0,N,transformer.57.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.57.ffn_res.x1@0,N,transformer.57.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.57.ffn_res.x2@0,N,transformer.57.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.57.ffn_res.y@0,N,transformer.57.ffn_res.x1@0,transformer.57.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.57.ffn_res.dy@0,N,transformer.58.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.57.ffn_res.y@0,
transformer.57.ffn_res.dx1@0,N,transformer.57.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.57.ffn_res.x1@0,
transformer.57.ffn_res.dx2@0,N,transformer.57.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.57.ffn_res.x2@0,
transformer.57._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.57._assembled_weight@0,N,transformer.57._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.57._sharded_grad@0,N,transformer.57._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.57._sharded_weight@0,
transformer.57._assembled_grad@0,N,transformer.57.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.57.mha.dwo@0"", ""transformer.57.ffn.dwgate@0"", ""transformer.57.ffn.dwdown@0""]}"
transformer.57._mha.wqkv_backward@0,N,transformer.57._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.57._mha.wo_backward@0,N,transformer.57._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.57._ffn.wgate_backward@0,N,transformer.57._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.57._ffn.wdown_backward@0,N,transformer.57._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.57._assembled_weight_backward@0,N,transformer.57._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.58.input_norm.x@0,N,transformer.57.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.58.input_norm.y@0,N,transformer.58.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.58.input_norm.dy@0,N,transformer.58.mha.dx@0,transformer.58.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.58.input_norm.y@0,
transformer.58.input_norm.dx@0,N,transformer.58.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.58.input_norm.x@0,
transformer.58.mha.x@0,N,transformer.58.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.58.mha.wqkv@0,N,transformer.58._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.58.mha.qkv@0,N,transformer.58.mha.x@0,transformer.58.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.58.mha.q@0,N,transformer.58.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.58.mha.k@0,N,transformer.58.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.58.mha.v@0,N,transformer.58.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.58.mha.attn@0,N,transformer.58.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.58.mha.wo@0,N,transformer.58._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.58.mha.o1@0,N,transformer.58.mha.attn@0,transformer.58.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.58.mha.o@0,N,transformer.58.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.58.mha.do@0,N,transformer.58.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.58.mha.o@0,
transformer.58.mha.do1@0,N,transformer.58.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.58.mha.o1@0,
transformer.58.mha.dattn@0,N,transformer.58.mha.do1@0,transformer.58._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.58.mha.dwo@0,N,transformer.58.mha.do1@0,transformer.58.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.58.mha.wo@0,
transformer.58.mha.dv@0,N,transformer.58.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.58.mha.v@0,
transformer.58.mha.dk@0,N,transformer.58.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.58.mha.k@0,
transformer.58.mha.dq@0,N,transformer.58.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.58.mha.q@0,
transformer.58.mha.dkv@0,N,transformer.58.mha.dv@0,transformer.58.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.58.mha.dqkv@0,N,transformer.58.mha.dkv@0,transformer.58.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.58.mha.qkv@0,
transformer.58.mha.dwqkv@0,N,transformer.58.mha.dqkv@0,transformer.58.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.58.mha.wqkv@0,
transformer.58.mha.dx1@0,N,transformer.58.mha.dqkv@0,transformer.58._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.58.mha.dx@0,N,transformer.58.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.58.mha.attn_kernel.q@0,N,transformer.58.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.58.mha.attn_kernel.k@0,N,transformer.58.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.58.mha.attn_kernel.v@0,N,transformer.58.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.58.mha.attn_kernel.k1@0,N,transformer.58.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.58.mha.attn_kernel.v1@0,N,transformer.58.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.58.mha.attn_kernel.qkv@0,N,transformer.58.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.58.mha.attn_kernel.k1@0"", ""transformer.58.mha.attn_kernel.v1@0""]}"
transformer.58.mha.attn_kernel.dqkv@0,N,transformer.58.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.58.mha.attn_kernel.qkv@0,
transformer.58.mha.attn_kernel.dq@0,N,transformer.58.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.58.mha.attn_kernel.q@0,
transformer.58.mha.attn_kernel.dk@0,N,transformer.58.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.58.mha.attn_kernel.dv@0,N,transformer.58.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.58.mha_res.x1@0,N,transformer.58.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.58.mha_res.x2@0,N,transformer.58.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.58.mha_res.y@0,N,transformer.58.mha_res.x1@0,transformer.58.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.58.mha_res.dy@0,N,transformer.58.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.58.mha_res.y@0,
transformer.58.mha_res.dx1@0,N,transformer.58.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.58.mha_res.x1@0,
transformer.58.mha_res.dx2@0,N,transformer.58.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.58.mha_res.x2@0,
transformer.58.post_attn_norm.x@0,N,transformer.58.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.58.post_attn_norm.y@0,N,transformer.58.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.58.post_attn_norm.dy@0,N,transformer.58.ffn.dx0@0,transformer.58.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.58.post_attn_norm.y@0,
transformer.58.post_attn_norm.dx@0,N,transformer.58.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.58.post_attn_norm.x@0,
transformer.58.ffn.x0@0,N,transformer.58.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.58.ffn.wgate@0,N,transformer.58._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.58.ffn.wdown@0,N,transformer.58._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.58.ffn.x00@0,N,transformer.58.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.58.ffn.xgate@0,N,transformer.58.ffn.x00@0,transformer.58.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.58.ffn.xdown1@0,N,transformer.58.ffn.xgate@0,transformer.58.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.58.ffn.xdown@0,N,transformer.58.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.58.ffn.dxdown@0,N,transformer.58.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.58.ffn.xdown@0,
transformer.58.ffn.dxdown2@0,N,transformer.58.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.58.ffn.dwdown@0,N,transformer.58.ffn.dxdown2@0,transformer.58.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.58.ffn.wdown@0,
transformer.58.ffn.dxgate@0,N,transformer.58.ffn.dxdown2@0,transformer.58._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.58.ffn.xgate@0,
transformer.58.ffn.x01@0,N,transformer.58.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.58.ffn.dwgate@0,N,transformer.58.ffn.dxgate@0,transformer.58.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.58.ffn.wgate@0,
transformer.58.ffn.dx000@0,N,transformer.58.ffn.dxgate@0,transformer.58._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.58.ffn.dx0@0,N,transformer.58.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.58.ffn_res.x1@0,N,transformer.58.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.58.ffn_res.x2@0,N,transformer.58.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.58.ffn_res.y@0,N,transformer.58.ffn_res.x1@0,transformer.58.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.58.ffn_res.dy@0,N,transformer.59.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.58.ffn_res.y@0,
transformer.58.ffn_res.dx1@0,N,transformer.58.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.58.ffn_res.x1@0,
transformer.58.ffn_res.dx2@0,N,transformer.58.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.58.ffn_res.x2@0,
transformer.58._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.58._assembled_weight@0,N,transformer.58._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.58._sharded_grad@0,N,transformer.58._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.58._sharded_weight@0,
transformer.58._assembled_grad@0,N,transformer.58.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.58.mha.dwo@0"", ""transformer.58.ffn.dwgate@0"", ""transformer.58.ffn.dwdown@0""]}"
transformer.58._mha.wqkv_backward@0,N,transformer.58._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.58._mha.wo_backward@0,N,transformer.58._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.58._ffn.wgate_backward@0,N,transformer.58._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.58._ffn.wdown_backward@0,N,transformer.58._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.58._assembled_weight_backward@0,N,transformer.58._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.59.input_norm.x@0,N,transformer.58.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.59.input_norm.y@0,N,transformer.59.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.59.input_norm.dy@0,N,transformer.59.mha.dx@0,transformer.59.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.59.input_norm.y@0,
transformer.59.input_norm.dx@0,N,transformer.59.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.59.input_norm.x@0,
transformer.59.mha.x@0,N,transformer.59.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.59.mha.wqkv@0,N,transformer.59._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.59.mha.qkv@0,N,transformer.59.mha.x@0,transformer.59.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.59.mha.q@0,N,transformer.59.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.59.mha.k@0,N,transformer.59.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.59.mha.v@0,N,transformer.59.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.59.mha.attn@0,N,transformer.59.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.59.mha.wo@0,N,transformer.59._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.59.mha.o1@0,N,transformer.59.mha.attn@0,transformer.59.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.59.mha.o@0,N,transformer.59.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.59.mha.do@0,N,transformer.59.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.59.mha.o@0,
transformer.59.mha.do1@0,N,transformer.59.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.59.mha.o1@0,
transformer.59.mha.dattn@0,N,transformer.59.mha.do1@0,transformer.59._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.59.mha.dwo@0,N,transformer.59.mha.do1@0,transformer.59.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.59.mha.wo@0,
transformer.59.mha.dv@0,N,transformer.59.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.59.mha.v@0,
transformer.59.mha.dk@0,N,transformer.59.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.59.mha.k@0,
transformer.59.mha.dq@0,N,transformer.59.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.59.mha.q@0,
transformer.59.mha.dkv@0,N,transformer.59.mha.dv@0,transformer.59.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.59.mha.dqkv@0,N,transformer.59.mha.dkv@0,transformer.59.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.59.mha.qkv@0,
transformer.59.mha.dwqkv@0,N,transformer.59.mha.dqkv@0,transformer.59.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.59.mha.wqkv@0,
transformer.59.mha.dx1@0,N,transformer.59.mha.dqkv@0,transformer.59._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.59.mha.dx@0,N,transformer.59.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.59.mha.attn_kernel.q@0,N,transformer.59.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.59.mha.attn_kernel.k@0,N,transformer.59.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.59.mha.attn_kernel.v@0,N,transformer.59.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.59.mha.attn_kernel.k1@0,N,transformer.59.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.59.mha.attn_kernel.v1@0,N,transformer.59.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.59.mha.attn_kernel.qkv@0,N,transformer.59.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.59.mha.attn_kernel.k1@0"", ""transformer.59.mha.attn_kernel.v1@0""]}"
transformer.59.mha.attn_kernel.dqkv@0,N,transformer.59.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.59.mha.attn_kernel.qkv@0,
transformer.59.mha.attn_kernel.dq@0,N,transformer.59.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.59.mha.attn_kernel.q@0,
transformer.59.mha.attn_kernel.dk@0,N,transformer.59.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.59.mha.attn_kernel.dv@0,N,transformer.59.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.59.mha_res.x1@0,N,transformer.59.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.59.mha_res.x2@0,N,transformer.59.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.59.mha_res.y@0,N,transformer.59.mha_res.x1@0,transformer.59.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.59.mha_res.dy@0,N,transformer.59.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.59.mha_res.y@0,
transformer.59.mha_res.dx1@0,N,transformer.59.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.59.mha_res.x1@0,
transformer.59.mha_res.dx2@0,N,transformer.59.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.59.mha_res.x2@0,
transformer.59.post_attn_norm.x@0,N,transformer.59.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.59.post_attn_norm.y@0,N,transformer.59.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.59.post_attn_norm.dy@0,N,transformer.59.ffn.dx0@0,transformer.59.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.59.post_attn_norm.y@0,
transformer.59.post_attn_norm.dx@0,N,transformer.59.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.59.post_attn_norm.x@0,
transformer.59.ffn.x0@0,N,transformer.59.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.59.ffn.wgate@0,N,transformer.59._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.59.ffn.wdown@0,N,transformer.59._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.59.ffn.x00@0,N,transformer.59.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.59.ffn.xgate@0,N,transformer.59.ffn.x00@0,transformer.59.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.59.ffn.xdown1@0,N,transformer.59.ffn.xgate@0,transformer.59.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.59.ffn.xdown@0,N,transformer.59.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.59.ffn.dxdown@0,N,transformer.59.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.59.ffn.xdown@0,
transformer.59.ffn.dxdown2@0,N,transformer.59.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.59.ffn.dwdown@0,N,transformer.59.ffn.dxdown2@0,transformer.59.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.59.ffn.wdown@0,
transformer.59.ffn.dxgate@0,N,transformer.59.ffn.dxdown2@0,transformer.59._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.59.ffn.xgate@0,
transformer.59.ffn.x01@0,N,transformer.59.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.59.ffn.dwgate@0,N,transformer.59.ffn.dxgate@0,transformer.59.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.59.ffn.wgate@0,
transformer.59.ffn.dx000@0,N,transformer.59.ffn.dxgate@0,transformer.59._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.59.ffn.dx0@0,N,transformer.59.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.59.ffn_res.x1@0,N,transformer.59.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.59.ffn_res.x2@0,N,transformer.59.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.59.ffn_res.y@0,N,transformer.59.ffn_res.x1@0,transformer.59.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.59.ffn_res.dy@0,N,transformer.60.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.59.ffn_res.y@0,
transformer.59.ffn_res.dx1@0,N,transformer.59.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.59.ffn_res.x1@0,
transformer.59.ffn_res.dx2@0,N,transformer.59.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.59.ffn_res.x2@0,
transformer.59._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.59._assembled_weight@0,N,transformer.59._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.59._sharded_grad@0,N,transformer.59._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.59._sharded_weight@0,
transformer.59._assembled_grad@0,N,transformer.59.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.59.mha.dwo@0"", ""transformer.59.ffn.dwgate@0"", ""transformer.59.ffn.dwdown@0""]}"
transformer.59._mha.wqkv_backward@0,N,transformer.59._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.59._mha.wo_backward@0,N,transformer.59._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.59._ffn.wgate_backward@0,N,transformer.59._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.59._ffn.wdown_backward@0,N,transformer.59._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.59._assembled_weight_backward@0,N,transformer.59._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.60.input_norm.x@0,N,transformer.59.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.60.input_norm.y@0,N,transformer.60.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.60.input_norm.dy@0,N,transformer.60.mha.dx@0,transformer.60.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.60.input_norm.y@0,
transformer.60.input_norm.dx@0,N,transformer.60.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.60.input_norm.x@0,
transformer.60.mha.x@0,N,transformer.60.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.60.mha.wqkv@0,N,transformer.60._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.60.mha.qkv@0,N,transformer.60.mha.x@0,transformer.60.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.60.mha.q@0,N,transformer.60.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.60.mha.k@0,N,transformer.60.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.60.mha.v@0,N,transformer.60.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.60.mha.attn@0,N,transformer.60.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.60.mha.wo@0,N,transformer.60._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.60.mha.o1@0,N,transformer.60.mha.attn@0,transformer.60.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.60.mha.o@0,N,transformer.60.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.60.mha.do@0,N,transformer.60.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.60.mha.o@0,
transformer.60.mha.do1@0,N,transformer.60.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.60.mha.o1@0,
transformer.60.mha.dattn@0,N,transformer.60.mha.do1@0,transformer.60._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.60.mha.dwo@0,N,transformer.60.mha.do1@0,transformer.60.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.60.mha.wo@0,
transformer.60.mha.dv@0,N,transformer.60.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.60.mha.v@0,
transformer.60.mha.dk@0,N,transformer.60.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.60.mha.k@0,
transformer.60.mha.dq@0,N,transformer.60.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.60.mha.q@0,
transformer.60.mha.dkv@0,N,transformer.60.mha.dv@0,transformer.60.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.60.mha.dqkv@0,N,transformer.60.mha.dkv@0,transformer.60.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.60.mha.qkv@0,
transformer.60.mha.dwqkv@0,N,transformer.60.mha.dqkv@0,transformer.60.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.60.mha.wqkv@0,
transformer.60.mha.dx1@0,N,transformer.60.mha.dqkv@0,transformer.60._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.60.mha.dx@0,N,transformer.60.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.60.mha.attn_kernel.q@0,N,transformer.60.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.60.mha.attn_kernel.k@0,N,transformer.60.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.60.mha.attn_kernel.v@0,N,transformer.60.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.60.mha.attn_kernel.k1@0,N,transformer.60.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.60.mha.attn_kernel.v1@0,N,transformer.60.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.60.mha.attn_kernel.qkv@0,N,transformer.60.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.60.mha.attn_kernel.k1@0"", ""transformer.60.mha.attn_kernel.v1@0""]}"
transformer.60.mha.attn_kernel.dqkv@0,N,transformer.60.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.60.mha.attn_kernel.qkv@0,
transformer.60.mha.attn_kernel.dq@0,N,transformer.60.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.60.mha.attn_kernel.q@0,
transformer.60.mha.attn_kernel.dk@0,N,transformer.60.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.60.mha.attn_kernel.dv@0,N,transformer.60.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.60.mha_res.x1@0,N,transformer.60.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.60.mha_res.x2@0,N,transformer.60.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.60.mha_res.y@0,N,transformer.60.mha_res.x1@0,transformer.60.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.60.mha_res.dy@0,N,transformer.60.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.60.mha_res.y@0,
transformer.60.mha_res.dx1@0,N,transformer.60.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.60.mha_res.x1@0,
transformer.60.mha_res.dx2@0,N,transformer.60.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.60.mha_res.x2@0,
transformer.60.post_attn_norm.x@0,N,transformer.60.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.60.post_attn_norm.y@0,N,transformer.60.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.60.post_attn_norm.dy@0,N,transformer.60.ffn.dx0@0,transformer.60.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.60.post_attn_norm.y@0,
transformer.60.post_attn_norm.dx@0,N,transformer.60.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.60.post_attn_norm.x@0,
transformer.60.ffn.x0@0,N,transformer.60.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.60.ffn.wgate@0,N,transformer.60._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.60.ffn.wdown@0,N,transformer.60._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.60.ffn.x00@0,N,transformer.60.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.60.ffn.xgate@0,N,transformer.60.ffn.x00@0,transformer.60.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.60.ffn.xdown1@0,N,transformer.60.ffn.xgate@0,transformer.60.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.60.ffn.xdown@0,N,transformer.60.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.60.ffn.dxdown@0,N,transformer.60.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.60.ffn.xdown@0,
transformer.60.ffn.dxdown2@0,N,transformer.60.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.60.ffn.dwdown@0,N,transformer.60.ffn.dxdown2@0,transformer.60.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.60.ffn.wdown@0,
transformer.60.ffn.dxgate@0,N,transformer.60.ffn.dxdown2@0,transformer.60._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.60.ffn.xgate@0,
transformer.60.ffn.x01@0,N,transformer.60.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.60.ffn.dwgate@0,N,transformer.60.ffn.dxgate@0,transformer.60.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.60.ffn.wgate@0,
transformer.60.ffn.dx000@0,N,transformer.60.ffn.dxgate@0,transformer.60._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.60.ffn.dx0@0,N,transformer.60.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.60.ffn_res.x1@0,N,transformer.60.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.60.ffn_res.x2@0,N,transformer.60.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.60.ffn_res.y@0,N,transformer.60.ffn_res.x1@0,transformer.60.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.60.ffn_res.dy@0,N,transformer.61.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.60.ffn_res.y@0,
transformer.60.ffn_res.dx1@0,N,transformer.60.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.60.ffn_res.x1@0,
transformer.60.ffn_res.dx2@0,N,transformer.60.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.60.ffn_res.x2@0,
transformer.60._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.60._assembled_weight@0,N,transformer.60._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.60._sharded_grad@0,N,transformer.60._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.60._sharded_weight@0,
transformer.60._assembled_grad@0,N,transformer.60.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.60.mha.dwo@0"", ""transformer.60.ffn.dwgate@0"", ""transformer.60.ffn.dwdown@0""]}"
transformer.60._mha.wqkv_backward@0,N,transformer.60._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.60._mha.wo_backward@0,N,transformer.60._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.60._ffn.wgate_backward@0,N,transformer.60._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.60._ffn.wdown_backward@0,N,transformer.60._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.60._assembled_weight_backward@0,N,transformer.60._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.61.input_norm.x@0,N,transformer.60.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.61.input_norm.y@0,N,transformer.61.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.61.input_norm.dy@0,N,transformer.61.mha.dx@0,transformer.61.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.61.input_norm.y@0,
transformer.61.input_norm.dx@0,N,transformer.61.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.61.input_norm.x@0,
transformer.61.mha.x@0,N,transformer.61.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.61.mha.wqkv@0,N,transformer.61._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.61.mha.qkv@0,N,transformer.61.mha.x@0,transformer.61.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.61.mha.q@0,N,transformer.61.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.61.mha.k@0,N,transformer.61.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.61.mha.v@0,N,transformer.61.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.61.mha.attn@0,N,transformer.61.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.61.mha.wo@0,N,transformer.61._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.61.mha.o1@0,N,transformer.61.mha.attn@0,transformer.61.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.61.mha.o@0,N,transformer.61.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.61.mha.do@0,N,transformer.61.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.61.mha.o@0,
transformer.61.mha.do1@0,N,transformer.61.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.61.mha.o1@0,
transformer.61.mha.dattn@0,N,transformer.61.mha.do1@0,transformer.61._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.61.mha.dwo@0,N,transformer.61.mha.do1@0,transformer.61.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.61.mha.wo@0,
transformer.61.mha.dv@0,N,transformer.61.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.61.mha.v@0,
transformer.61.mha.dk@0,N,transformer.61.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.61.mha.k@0,
transformer.61.mha.dq@0,N,transformer.61.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.61.mha.q@0,
transformer.61.mha.dkv@0,N,transformer.61.mha.dv@0,transformer.61.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.61.mha.dqkv@0,N,transformer.61.mha.dkv@0,transformer.61.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.61.mha.qkv@0,
transformer.61.mha.dwqkv@0,N,transformer.61.mha.dqkv@0,transformer.61.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.61.mha.wqkv@0,
transformer.61.mha.dx1@0,N,transformer.61.mha.dqkv@0,transformer.61._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.61.mha.dx@0,N,transformer.61.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.61.mha.attn_kernel.q@0,N,transformer.61.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.61.mha.attn_kernel.k@0,N,transformer.61.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.61.mha.attn_kernel.v@0,N,transformer.61.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.61.mha.attn_kernel.k1@0,N,transformer.61.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.61.mha.attn_kernel.v1@0,N,transformer.61.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.61.mha.attn_kernel.qkv@0,N,transformer.61.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.61.mha.attn_kernel.k1@0"", ""transformer.61.mha.attn_kernel.v1@0""]}"
transformer.61.mha.attn_kernel.dqkv@0,N,transformer.61.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.61.mha.attn_kernel.qkv@0,
transformer.61.mha.attn_kernel.dq@0,N,transformer.61.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.61.mha.attn_kernel.q@0,
transformer.61.mha.attn_kernel.dk@0,N,transformer.61.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.61.mha.attn_kernel.dv@0,N,transformer.61.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.61.mha_res.x1@0,N,transformer.61.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.61.mha_res.x2@0,N,transformer.61.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.61.mha_res.y@0,N,transformer.61.mha_res.x1@0,transformer.61.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.61.mha_res.dy@0,N,transformer.61.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.61.mha_res.y@0,
transformer.61.mha_res.dx1@0,N,transformer.61.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.61.mha_res.x1@0,
transformer.61.mha_res.dx2@0,N,transformer.61.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.61.mha_res.x2@0,
transformer.61.post_attn_norm.x@0,N,transformer.61.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.61.post_attn_norm.y@0,N,transformer.61.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.61.post_attn_norm.dy@0,N,transformer.61.ffn.dx0@0,transformer.61.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.61.post_attn_norm.y@0,
transformer.61.post_attn_norm.dx@0,N,transformer.61.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.61.post_attn_norm.x@0,
transformer.61.ffn.x0@0,N,transformer.61.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.61.ffn.wgate@0,N,transformer.61._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.61.ffn.wdown@0,N,transformer.61._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.61.ffn.x00@0,N,transformer.61.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.61.ffn.xgate@0,N,transformer.61.ffn.x00@0,transformer.61.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.61.ffn.xdown1@0,N,transformer.61.ffn.xgate@0,transformer.61.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.61.ffn.xdown@0,N,transformer.61.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.61.ffn.dxdown@0,N,transformer.61.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.61.ffn.xdown@0,
transformer.61.ffn.dxdown2@0,N,transformer.61.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.61.ffn.dwdown@0,N,transformer.61.ffn.dxdown2@0,transformer.61.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.61.ffn.wdown@0,
transformer.61.ffn.dxgate@0,N,transformer.61.ffn.dxdown2@0,transformer.61._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.61.ffn.xgate@0,
transformer.61.ffn.x01@0,N,transformer.61.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.61.ffn.dwgate@0,N,transformer.61.ffn.dxgate@0,transformer.61.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.61.ffn.wgate@0,
transformer.61.ffn.dx000@0,N,transformer.61.ffn.dxgate@0,transformer.61._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.61.ffn.dx0@0,N,transformer.61.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.61.ffn_res.x1@0,N,transformer.61.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.61.ffn_res.x2@0,N,transformer.61.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.61.ffn_res.y@0,N,transformer.61.ffn_res.x1@0,transformer.61.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.61.ffn_res.dy@0,N,transformer.62.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.61.ffn_res.y@0,
transformer.61.ffn_res.dx1@0,N,transformer.61.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.61.ffn_res.x1@0,
transformer.61.ffn_res.dx2@0,N,transformer.61.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.61.ffn_res.x2@0,
transformer.61._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.61._assembled_weight@0,N,transformer.61._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.61._sharded_grad@0,N,transformer.61._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.61._sharded_weight@0,
transformer.61._assembled_grad@0,N,transformer.61.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.61.mha.dwo@0"", ""transformer.61.ffn.dwgate@0"", ""transformer.61.ffn.dwdown@0""]}"
transformer.61._mha.wqkv_backward@0,N,transformer.61._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.61._mha.wo_backward@0,N,transformer.61._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.61._ffn.wgate_backward@0,N,transformer.61._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.61._ffn.wdown_backward@0,N,transformer.61._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.61._assembled_weight_backward@0,N,transformer.61._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.62.input_norm.x@0,N,transformer.61.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.62.input_norm.y@0,N,transformer.62.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.62.input_norm.dy@0,N,transformer.62.mha.dx@0,transformer.62.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.62.input_norm.y@0,
transformer.62.input_norm.dx@0,N,transformer.62.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.62.input_norm.x@0,
transformer.62.mha.x@0,N,transformer.62.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.62.mha.wqkv@0,N,transformer.62._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.62.mha.qkv@0,N,transformer.62.mha.x@0,transformer.62.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.62.mha.q@0,N,transformer.62.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.62.mha.k@0,N,transformer.62.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.62.mha.v@0,N,transformer.62.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.62.mha.attn@0,N,transformer.62.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.62.mha.wo@0,N,transformer.62._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.62.mha.o1@0,N,transformer.62.mha.attn@0,transformer.62.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.62.mha.o@0,N,transformer.62.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.62.mha.do@0,N,transformer.62.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.62.mha.o@0,
transformer.62.mha.do1@0,N,transformer.62.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.62.mha.o1@0,
transformer.62.mha.dattn@0,N,transformer.62.mha.do1@0,transformer.62._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.62.mha.dwo@0,N,transformer.62.mha.do1@0,transformer.62.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.62.mha.wo@0,
transformer.62.mha.dv@0,N,transformer.62.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.62.mha.v@0,
transformer.62.mha.dk@0,N,transformer.62.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.62.mha.k@0,
transformer.62.mha.dq@0,N,transformer.62.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.62.mha.q@0,
transformer.62.mha.dkv@0,N,transformer.62.mha.dv@0,transformer.62.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.62.mha.dqkv@0,N,transformer.62.mha.dkv@0,transformer.62.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.62.mha.qkv@0,
transformer.62.mha.dwqkv@0,N,transformer.62.mha.dqkv@0,transformer.62.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.62.mha.wqkv@0,
transformer.62.mha.dx1@0,N,transformer.62.mha.dqkv@0,transformer.62._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.62.mha.dx@0,N,transformer.62.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.62.mha.attn_kernel.q@0,N,transformer.62.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.62.mha.attn_kernel.k@0,N,transformer.62.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.62.mha.attn_kernel.v@0,N,transformer.62.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.62.mha.attn_kernel.k1@0,N,transformer.62.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.62.mha.attn_kernel.v1@0,N,transformer.62.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.62.mha.attn_kernel.qkv@0,N,transformer.62.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.62.mha.attn_kernel.k1@0"", ""transformer.62.mha.attn_kernel.v1@0""]}"
transformer.62.mha.attn_kernel.dqkv@0,N,transformer.62.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.62.mha.attn_kernel.qkv@0,
transformer.62.mha.attn_kernel.dq@0,N,transformer.62.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.62.mha.attn_kernel.q@0,
transformer.62.mha.attn_kernel.dk@0,N,transformer.62.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.62.mha.attn_kernel.dv@0,N,transformer.62.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.62.mha_res.x1@0,N,transformer.62.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.62.mha_res.x2@0,N,transformer.62.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.62.mha_res.y@0,N,transformer.62.mha_res.x1@0,transformer.62.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.62.mha_res.dy@0,N,transformer.62.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.62.mha_res.y@0,
transformer.62.mha_res.dx1@0,N,transformer.62.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.62.mha_res.x1@0,
transformer.62.mha_res.dx2@0,N,transformer.62.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.62.mha_res.x2@0,
transformer.62.post_attn_norm.x@0,N,transformer.62.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.62.post_attn_norm.y@0,N,transformer.62.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.62.post_attn_norm.dy@0,N,transformer.62.ffn.dx0@0,transformer.62.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.62.post_attn_norm.y@0,
transformer.62.post_attn_norm.dx@0,N,transformer.62.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.62.post_attn_norm.x@0,
transformer.62.ffn.x0@0,N,transformer.62.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.62.ffn.wgate@0,N,transformer.62._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.62.ffn.wdown@0,N,transformer.62._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.62.ffn.x00@0,N,transformer.62.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.62.ffn.xgate@0,N,transformer.62.ffn.x00@0,transformer.62.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.62.ffn.xdown1@0,N,transformer.62.ffn.xgate@0,transformer.62.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.62.ffn.xdown@0,N,transformer.62.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.62.ffn.dxdown@0,N,transformer.62.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.62.ffn.xdown@0,
transformer.62.ffn.dxdown2@0,N,transformer.62.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.62.ffn.dwdown@0,N,transformer.62.ffn.dxdown2@0,transformer.62.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.62.ffn.wdown@0,
transformer.62.ffn.dxgate@0,N,transformer.62.ffn.dxdown2@0,transformer.62._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.62.ffn.xgate@0,
transformer.62.ffn.x01@0,N,transformer.62.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.62.ffn.dwgate@0,N,transformer.62.ffn.dxgate@0,transformer.62.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.62.ffn.wgate@0,
transformer.62.ffn.dx000@0,N,transformer.62.ffn.dxgate@0,transformer.62._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.62.ffn.dx0@0,N,transformer.62.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.62.ffn_res.x1@0,N,transformer.62.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.62.ffn_res.x2@0,N,transformer.62.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.62.ffn_res.y@0,N,transformer.62.ffn_res.x1@0,transformer.62.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.62.ffn_res.dy@0,N,transformer.63.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.62.ffn_res.y@0,
transformer.62.ffn_res.dx1@0,N,transformer.62.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.62.ffn_res.x1@0,
transformer.62.ffn_res.dx2@0,N,transformer.62.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.62.ffn_res.x2@0,
transformer.62._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.62._assembled_weight@0,N,transformer.62._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.62._sharded_grad@0,N,transformer.62._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.62._sharded_weight@0,
transformer.62._assembled_grad@0,N,transformer.62.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.62.mha.dwo@0"", ""transformer.62.ffn.dwgate@0"", ""transformer.62.ffn.dwdown@0""]}"
transformer.62._mha.wqkv_backward@0,N,transformer.62._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.62._mha.wo_backward@0,N,transformer.62._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.62._ffn.wgate_backward@0,N,transformer.62._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.62._ffn.wdown_backward@0,N,transformer.62._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.62._assembled_weight_backward@0,N,transformer.62._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.63.input_norm.x@0,N,transformer.62.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.63.input_norm.y@0,N,transformer.63.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.63.input_norm.dy@0,N,transformer.63.mha.dx@0,transformer.63.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.63.input_norm.y@0,
transformer.63.input_norm.dx@0,N,transformer.63.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.63.input_norm.x@0,
transformer.63.mha.x@0,N,transformer.63.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.63.mha.wqkv@0,N,transformer.63._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.63.mha.qkv@0,N,transformer.63.mha.x@0,transformer.63.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.63.mha.q@0,N,transformer.63.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.63.mha.k@0,N,transformer.63.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.63.mha.v@0,N,transformer.63.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.63.mha.attn@0,N,transformer.63.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.63.mha.wo@0,N,transformer.63._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.63.mha.o1@0,N,transformer.63.mha.attn@0,transformer.63.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.63.mha.o@0,N,transformer.63.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.63.mha.do@0,N,transformer.63.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.63.mha.o@0,
transformer.63.mha.do1@0,N,transformer.63.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.63.mha.o1@0,
transformer.63.mha.dattn@0,N,transformer.63.mha.do1@0,transformer.63._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.63.mha.dwo@0,N,transformer.63.mha.do1@0,transformer.63.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.63.mha.wo@0,
transformer.63.mha.dv@0,N,transformer.63.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.63.mha.v@0,
transformer.63.mha.dk@0,N,transformer.63.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.63.mha.k@0,
transformer.63.mha.dq@0,N,transformer.63.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.63.mha.q@0,
transformer.63.mha.dkv@0,N,transformer.63.mha.dv@0,transformer.63.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.63.mha.dqkv@0,N,transformer.63.mha.dkv@0,transformer.63.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.63.mha.qkv@0,
transformer.63.mha.dwqkv@0,N,transformer.63.mha.dqkv@0,transformer.63.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.63.mha.wqkv@0,
transformer.63.mha.dx1@0,N,transformer.63.mha.dqkv@0,transformer.63._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.63.mha.dx@0,N,transformer.63.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.63.mha.attn_kernel.q@0,N,transformer.63.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.63.mha.attn_kernel.k@0,N,transformer.63.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.63.mha.attn_kernel.v@0,N,transformer.63.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.63.mha.attn_kernel.k1@0,N,transformer.63.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.63.mha.attn_kernel.v1@0,N,transformer.63.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.63.mha.attn_kernel.qkv@0,N,transformer.63.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.63.mha.attn_kernel.k1@0"", ""transformer.63.mha.attn_kernel.v1@0""]}"
transformer.63.mha.attn_kernel.dqkv@0,N,transformer.63.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.63.mha.attn_kernel.qkv@0,
transformer.63.mha.attn_kernel.dq@0,N,transformer.63.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.63.mha.attn_kernel.q@0,
transformer.63.mha.attn_kernel.dk@0,N,transformer.63.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.63.mha.attn_kernel.dv@0,N,transformer.63.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.63.mha_res.x1@0,N,transformer.63.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.63.mha_res.x2@0,N,transformer.63.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.63.mha_res.y@0,N,transformer.63.mha_res.x1@0,transformer.63.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.63.mha_res.dy@0,N,transformer.63.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.63.mha_res.y@0,
transformer.63.mha_res.dx1@0,N,transformer.63.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.63.mha_res.x1@0,
transformer.63.mha_res.dx2@0,N,transformer.63.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.63.mha_res.x2@0,
transformer.63.post_attn_norm.x@0,N,transformer.63.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.63.post_attn_norm.y@0,N,transformer.63.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.63.post_attn_norm.dy@0,N,transformer.63.ffn.dx0@0,transformer.63.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.63.post_attn_norm.y@0,
transformer.63.post_attn_norm.dx@0,N,transformer.63.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.63.post_attn_norm.x@0,
transformer.63.ffn.x0@0,N,transformer.63.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.63.ffn.wgate@0,N,transformer.63._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.63.ffn.wdown@0,N,transformer.63._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.63.ffn.x00@0,N,transformer.63.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.63.ffn.xgate@0,N,transformer.63.ffn.x00@0,transformer.63.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.63.ffn.xdown1@0,N,transformer.63.ffn.xgate@0,transformer.63.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.63.ffn.xdown@0,N,transformer.63.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.63.ffn.dxdown@0,N,transformer.63.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.63.ffn.xdown@0,
transformer.63.ffn.dxdown2@0,N,transformer.63.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.63.ffn.dwdown@0,N,transformer.63.ffn.dxdown2@0,transformer.63.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.63.ffn.wdown@0,
transformer.63.ffn.dxgate@0,N,transformer.63.ffn.dxdown2@0,transformer.63._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.63.ffn.xgate@0,
transformer.63.ffn.x01@0,N,transformer.63.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.63.ffn.dwgate@0,N,transformer.63.ffn.dxgate@0,transformer.63.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.63.ffn.wgate@0,
transformer.63.ffn.dx000@0,N,transformer.63.ffn.dxgate@0,transformer.63._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.63.ffn.dx0@0,N,transformer.63.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.63.ffn_res.x1@0,N,transformer.63.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.63.ffn_res.x2@0,N,transformer.63.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.63.ffn_res.y@0,N,transformer.63.ffn_res.x1@0,transformer.63.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.63.ffn_res.dy@0,N,transformer.64.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.63.ffn_res.y@0,
transformer.63.ffn_res.dx1@0,N,transformer.63.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.63.ffn_res.x1@0,
transformer.63.ffn_res.dx2@0,N,transformer.63.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.63.ffn_res.x2@0,
transformer.63._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.63._assembled_weight@0,N,transformer.63._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.63._sharded_grad@0,N,transformer.63._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.63._sharded_weight@0,
transformer.63._assembled_grad@0,N,transformer.63.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.63.mha.dwo@0"", ""transformer.63.ffn.dwgate@0"", ""transformer.63.ffn.dwdown@0""]}"
transformer.63._mha.wqkv_backward@0,N,transformer.63._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.63._mha.wo_backward@0,N,transformer.63._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.63._ffn.wgate_backward@0,N,transformer.63._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.63._ffn.wdown_backward@0,N,transformer.63._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.63._assembled_weight_backward@0,N,transformer.63._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.64.input_norm.x@0,N,transformer.63.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.64.input_norm.y@0,N,transformer.64.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.64.input_norm.dy@0,N,transformer.64.mha.dx@0,transformer.64.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.64.input_norm.y@0,
transformer.64.input_norm.dx@0,N,transformer.64.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.64.input_norm.x@0,
transformer.64.mha.x@0,N,transformer.64.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.64.mha.wqkv@0,N,transformer.64._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.64.mha.qkv@0,N,transformer.64.mha.x@0,transformer.64.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.64.mha.q@0,N,transformer.64.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.64.mha.k@0,N,transformer.64.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.64.mha.v@0,N,transformer.64.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.64.mha.attn@0,N,transformer.64.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.64.mha.wo@0,N,transformer.64._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.64.mha.o1@0,N,transformer.64.mha.attn@0,transformer.64.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.64.mha.o@0,N,transformer.64.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.64.mha.do@0,N,transformer.64.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.64.mha.o@0,
transformer.64.mha.do1@0,N,transformer.64.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.64.mha.o1@0,
transformer.64.mha.dattn@0,N,transformer.64.mha.do1@0,transformer.64._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.64.mha.dwo@0,N,transformer.64.mha.do1@0,transformer.64.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.64.mha.wo@0,
transformer.64.mha.dv@0,N,transformer.64.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.64.mha.v@0,
transformer.64.mha.dk@0,N,transformer.64.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.64.mha.k@0,
transformer.64.mha.dq@0,N,transformer.64.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.64.mha.q@0,
transformer.64.mha.dkv@0,N,transformer.64.mha.dv@0,transformer.64.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.64.mha.dqkv@0,N,transformer.64.mha.dkv@0,transformer.64.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.64.mha.qkv@0,
transformer.64.mha.dwqkv@0,N,transformer.64.mha.dqkv@0,transformer.64.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.64.mha.wqkv@0,
transformer.64.mha.dx1@0,N,transformer.64.mha.dqkv@0,transformer.64._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.64.mha.dx@0,N,transformer.64.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.64.mha.attn_kernel.q@0,N,transformer.64.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.64.mha.attn_kernel.k@0,N,transformer.64.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.64.mha.attn_kernel.v@0,N,transformer.64.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.64.mha.attn_kernel.k1@0,N,transformer.64.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.64.mha.attn_kernel.v1@0,N,transformer.64.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.64.mha.attn_kernel.qkv@0,N,transformer.64.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.64.mha.attn_kernel.k1@0"", ""transformer.64.mha.attn_kernel.v1@0""]}"
transformer.64.mha.attn_kernel.dqkv@0,N,transformer.64.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.64.mha.attn_kernel.qkv@0,
transformer.64.mha.attn_kernel.dq@0,N,transformer.64.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.64.mha.attn_kernel.q@0,
transformer.64.mha.attn_kernel.dk@0,N,transformer.64.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.64.mha.attn_kernel.dv@0,N,transformer.64.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.64.mha_res.x1@0,N,transformer.64.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.64.mha_res.x2@0,N,transformer.64.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.64.mha_res.y@0,N,transformer.64.mha_res.x1@0,transformer.64.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.64.mha_res.dy@0,N,transformer.64.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.64.mha_res.y@0,
transformer.64.mha_res.dx1@0,N,transformer.64.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.64.mha_res.x1@0,
transformer.64.mha_res.dx2@0,N,transformer.64.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.64.mha_res.x2@0,
transformer.64.post_attn_norm.x@0,N,transformer.64.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.64.post_attn_norm.y@0,N,transformer.64.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.64.post_attn_norm.dy@0,N,transformer.64.ffn.dx0@0,transformer.64.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.64.post_attn_norm.y@0,
transformer.64.post_attn_norm.dx@0,N,transformer.64.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.64.post_attn_norm.x@0,
transformer.64.ffn.x0@0,N,transformer.64.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.64.ffn.wgate@0,N,transformer.64._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.64.ffn.wdown@0,N,transformer.64._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.64.ffn.x00@0,N,transformer.64.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.64.ffn.xgate@0,N,transformer.64.ffn.x00@0,transformer.64.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.64.ffn.xdown1@0,N,transformer.64.ffn.xgate@0,transformer.64.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.64.ffn.xdown@0,N,transformer.64.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.64.ffn.dxdown@0,N,transformer.64.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.64.ffn.xdown@0,
transformer.64.ffn.dxdown2@0,N,transformer.64.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.64.ffn.dwdown@0,N,transformer.64.ffn.dxdown2@0,transformer.64.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.64.ffn.wdown@0,
transformer.64.ffn.dxgate@0,N,transformer.64.ffn.dxdown2@0,transformer.64._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.64.ffn.xgate@0,
transformer.64.ffn.x01@0,N,transformer.64.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.64.ffn.dwgate@0,N,transformer.64.ffn.dxgate@0,transformer.64.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.64.ffn.wgate@0,
transformer.64.ffn.dx000@0,N,transformer.64.ffn.dxgate@0,transformer.64._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.64.ffn.dx0@0,N,transformer.64.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.64.ffn_res.x1@0,N,transformer.64.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.64.ffn_res.x2@0,N,transformer.64.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.64.ffn_res.y@0,N,transformer.64.ffn_res.x1@0,transformer.64.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.64.ffn_res.dy@0,N,transformer.65.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.64.ffn_res.y@0,
transformer.64.ffn_res.dx1@0,N,transformer.64.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.64.ffn_res.x1@0,
transformer.64.ffn_res.dx2@0,N,transformer.64.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.64.ffn_res.x2@0,
transformer.64._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.64._assembled_weight@0,N,transformer.64._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.64._sharded_grad@0,N,transformer.64._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.64._sharded_weight@0,
transformer.64._assembled_grad@0,N,transformer.64.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.64.mha.dwo@0"", ""transformer.64.ffn.dwgate@0"", ""transformer.64.ffn.dwdown@0""]}"
transformer.64._mha.wqkv_backward@0,N,transformer.64._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.64._mha.wo_backward@0,N,transformer.64._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.64._ffn.wgate_backward@0,N,transformer.64._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.64._ffn.wdown_backward@0,N,transformer.64._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.64._assembled_weight_backward@0,N,transformer.64._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.65.input_norm.x@0,N,transformer.64.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.65.input_norm.y@0,N,transformer.65.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.65.input_norm.dy@0,N,transformer.65.mha.dx@0,transformer.65.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.65.input_norm.y@0,
transformer.65.input_norm.dx@0,N,transformer.65.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.65.input_norm.x@0,
transformer.65.mha.x@0,N,transformer.65.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.65.mha.wqkv@0,N,transformer.65._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.65.mha.qkv@0,N,transformer.65.mha.x@0,transformer.65.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.65.mha.q@0,N,transformer.65.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.65.mha.k@0,N,transformer.65.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.65.mha.v@0,N,transformer.65.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.65.mha.attn@0,N,transformer.65.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.65.mha.wo@0,N,transformer.65._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.65.mha.o1@0,N,transformer.65.mha.attn@0,transformer.65.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.65.mha.o@0,N,transformer.65.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.65.mha.do@0,N,transformer.65.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.65.mha.o@0,
transformer.65.mha.do1@0,N,transformer.65.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.65.mha.o1@0,
transformer.65.mha.dattn@0,N,transformer.65.mha.do1@0,transformer.65._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.65.mha.dwo@0,N,transformer.65.mha.do1@0,transformer.65.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.65.mha.wo@0,
transformer.65.mha.dv@0,N,transformer.65.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.65.mha.v@0,
transformer.65.mha.dk@0,N,transformer.65.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.65.mha.k@0,
transformer.65.mha.dq@0,N,transformer.65.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.65.mha.q@0,
transformer.65.mha.dkv@0,N,transformer.65.mha.dv@0,transformer.65.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.65.mha.dqkv@0,N,transformer.65.mha.dkv@0,transformer.65.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.65.mha.qkv@0,
transformer.65.mha.dwqkv@0,N,transformer.65.mha.dqkv@0,transformer.65.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.65.mha.wqkv@0,
transformer.65.mha.dx1@0,N,transformer.65.mha.dqkv@0,transformer.65._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.65.mha.dx@0,N,transformer.65.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.65.mha.attn_kernel.q@0,N,transformer.65.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.65.mha.attn_kernel.k@0,N,transformer.65.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.65.mha.attn_kernel.v@0,N,transformer.65.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.65.mha.attn_kernel.k1@0,N,transformer.65.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.65.mha.attn_kernel.v1@0,N,transformer.65.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.65.mha.attn_kernel.qkv@0,N,transformer.65.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.65.mha.attn_kernel.k1@0"", ""transformer.65.mha.attn_kernel.v1@0""]}"
transformer.65.mha.attn_kernel.dqkv@0,N,transformer.65.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.65.mha.attn_kernel.qkv@0,
transformer.65.mha.attn_kernel.dq@0,N,transformer.65.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.65.mha.attn_kernel.q@0,
transformer.65.mha.attn_kernel.dk@0,N,transformer.65.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.65.mha.attn_kernel.dv@0,N,transformer.65.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.65.mha_res.x1@0,N,transformer.65.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.65.mha_res.x2@0,N,transformer.65.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.65.mha_res.y@0,N,transformer.65.mha_res.x1@0,transformer.65.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.65.mha_res.dy@0,N,transformer.65.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.65.mha_res.y@0,
transformer.65.mha_res.dx1@0,N,transformer.65.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.65.mha_res.x1@0,
transformer.65.mha_res.dx2@0,N,transformer.65.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.65.mha_res.x2@0,
transformer.65.post_attn_norm.x@0,N,transformer.65.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.65.post_attn_norm.y@0,N,transformer.65.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.65.post_attn_norm.dy@0,N,transformer.65.ffn.dx0@0,transformer.65.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.65.post_attn_norm.y@0,
transformer.65.post_attn_norm.dx@0,N,transformer.65.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.65.post_attn_norm.x@0,
transformer.65.ffn.x0@0,N,transformer.65.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.65.ffn.wgate@0,N,transformer.65._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.65.ffn.wdown@0,N,transformer.65._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.65.ffn.x00@0,N,transformer.65.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.65.ffn.xgate@0,N,transformer.65.ffn.x00@0,transformer.65.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.65.ffn.xdown1@0,N,transformer.65.ffn.xgate@0,transformer.65.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.65.ffn.xdown@0,N,transformer.65.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.65.ffn.dxdown@0,N,transformer.65.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.65.ffn.xdown@0,
transformer.65.ffn.dxdown2@0,N,transformer.65.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.65.ffn.dwdown@0,N,transformer.65.ffn.dxdown2@0,transformer.65.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.65.ffn.wdown@0,
transformer.65.ffn.dxgate@0,N,transformer.65.ffn.dxdown2@0,transformer.65._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.65.ffn.xgate@0,
transformer.65.ffn.x01@0,N,transformer.65.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.65.ffn.dwgate@0,N,transformer.65.ffn.dxgate@0,transformer.65.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.65.ffn.wgate@0,
transformer.65.ffn.dx000@0,N,transformer.65.ffn.dxgate@0,transformer.65._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.65.ffn.dx0@0,N,transformer.65.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.65.ffn_res.x1@0,N,transformer.65.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.65.ffn_res.x2@0,N,transformer.65.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.65.ffn_res.y@0,N,transformer.65.ffn_res.x1@0,transformer.65.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.65.ffn_res.dy@0,N,transformer.66.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.65.ffn_res.y@0,
transformer.65.ffn_res.dx1@0,N,transformer.65.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.65.ffn_res.x1@0,
transformer.65.ffn_res.dx2@0,N,transformer.65.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.65.ffn_res.x2@0,
transformer.65._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.65._assembled_weight@0,N,transformer.65._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.65._sharded_grad@0,N,transformer.65._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.65._sharded_weight@0,
transformer.65._assembled_grad@0,N,transformer.65.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.65.mha.dwo@0"", ""transformer.65.ffn.dwgate@0"", ""transformer.65.ffn.dwdown@0""]}"
transformer.65._mha.wqkv_backward@0,N,transformer.65._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.65._mha.wo_backward@0,N,transformer.65._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.65._ffn.wgate_backward@0,N,transformer.65._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.65._ffn.wdown_backward@0,N,transformer.65._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.65._assembled_weight_backward@0,N,transformer.65._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.66.input_norm.x@0,N,transformer.65.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.66.input_norm.y@0,N,transformer.66.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.66.input_norm.dy@0,N,transformer.66.mha.dx@0,transformer.66.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.66.input_norm.y@0,
transformer.66.input_norm.dx@0,N,transformer.66.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.66.input_norm.x@0,
transformer.66.mha.x@0,N,transformer.66.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.66.mha.wqkv@0,N,transformer.66._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.66.mha.qkv@0,N,transformer.66.mha.x@0,transformer.66.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.66.mha.q@0,N,transformer.66.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.66.mha.k@0,N,transformer.66.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.66.mha.v@0,N,transformer.66.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.66.mha.attn@0,N,transformer.66.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.66.mha.wo@0,N,transformer.66._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.66.mha.o1@0,N,transformer.66.mha.attn@0,transformer.66.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.66.mha.o@0,N,transformer.66.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.66.mha.do@0,N,transformer.66.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.66.mha.o@0,
transformer.66.mha.do1@0,N,transformer.66.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.66.mha.o1@0,
transformer.66.mha.dattn@0,N,transformer.66.mha.do1@0,transformer.66._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.66.mha.dwo@0,N,transformer.66.mha.do1@0,transformer.66.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.66.mha.wo@0,
transformer.66.mha.dv@0,N,transformer.66.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.66.mha.v@0,
transformer.66.mha.dk@0,N,transformer.66.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.66.mha.k@0,
transformer.66.mha.dq@0,N,transformer.66.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.66.mha.q@0,
transformer.66.mha.dkv@0,N,transformer.66.mha.dv@0,transformer.66.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.66.mha.dqkv@0,N,transformer.66.mha.dkv@0,transformer.66.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.66.mha.qkv@0,
transformer.66.mha.dwqkv@0,N,transformer.66.mha.dqkv@0,transformer.66.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.66.mha.wqkv@0,
transformer.66.mha.dx1@0,N,transformer.66.mha.dqkv@0,transformer.66._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.66.mha.dx@0,N,transformer.66.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.66.mha.attn_kernel.q@0,N,transformer.66.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.66.mha.attn_kernel.k@0,N,transformer.66.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.66.mha.attn_kernel.v@0,N,transformer.66.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.66.mha.attn_kernel.k1@0,N,transformer.66.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.66.mha.attn_kernel.v1@0,N,transformer.66.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.66.mha.attn_kernel.qkv@0,N,transformer.66.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.66.mha.attn_kernel.k1@0"", ""transformer.66.mha.attn_kernel.v1@0""]}"
transformer.66.mha.attn_kernel.dqkv@0,N,transformer.66.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.66.mha.attn_kernel.qkv@0,
transformer.66.mha.attn_kernel.dq@0,N,transformer.66.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.66.mha.attn_kernel.q@0,
transformer.66.mha.attn_kernel.dk@0,N,transformer.66.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.66.mha.attn_kernel.dv@0,N,transformer.66.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.66.mha_res.x1@0,N,transformer.66.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.66.mha_res.x2@0,N,transformer.66.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.66.mha_res.y@0,N,transformer.66.mha_res.x1@0,transformer.66.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.66.mha_res.dy@0,N,transformer.66.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.66.mha_res.y@0,
transformer.66.mha_res.dx1@0,N,transformer.66.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.66.mha_res.x1@0,
transformer.66.mha_res.dx2@0,N,transformer.66.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.66.mha_res.x2@0,
transformer.66.post_attn_norm.x@0,N,transformer.66.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.66.post_attn_norm.y@0,N,transformer.66.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.66.post_attn_norm.dy@0,N,transformer.66.ffn.dx0@0,transformer.66.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.66.post_attn_norm.y@0,
transformer.66.post_attn_norm.dx@0,N,transformer.66.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.66.post_attn_norm.x@0,
transformer.66.ffn.x0@0,N,transformer.66.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.66.ffn.wgate@0,N,transformer.66._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.66.ffn.wdown@0,N,transformer.66._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.66.ffn.x00@0,N,transformer.66.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.66.ffn.xgate@0,N,transformer.66.ffn.x00@0,transformer.66.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.66.ffn.xdown1@0,N,transformer.66.ffn.xgate@0,transformer.66.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.66.ffn.xdown@0,N,transformer.66.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.66.ffn.dxdown@0,N,transformer.66.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.66.ffn.xdown@0,
transformer.66.ffn.dxdown2@0,N,transformer.66.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.66.ffn.dwdown@0,N,transformer.66.ffn.dxdown2@0,transformer.66.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.66.ffn.wdown@0,
transformer.66.ffn.dxgate@0,N,transformer.66.ffn.dxdown2@0,transformer.66._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.66.ffn.xgate@0,
transformer.66.ffn.x01@0,N,transformer.66.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.66.ffn.dwgate@0,N,transformer.66.ffn.dxgate@0,transformer.66.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.66.ffn.wgate@0,
transformer.66.ffn.dx000@0,N,transformer.66.ffn.dxgate@0,transformer.66._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.66.ffn.dx0@0,N,transformer.66.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.66.ffn_res.x1@0,N,transformer.66.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.66.ffn_res.x2@0,N,transformer.66.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.66.ffn_res.y@0,N,transformer.66.ffn_res.x1@0,transformer.66.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.66.ffn_res.dy@0,N,transformer.67.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.66.ffn_res.y@0,
transformer.66.ffn_res.dx1@0,N,transformer.66.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.66.ffn_res.x1@0,
transformer.66.ffn_res.dx2@0,N,transformer.66.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.66.ffn_res.x2@0,
transformer.66._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.66._assembled_weight@0,N,transformer.66._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.66._sharded_grad@0,N,transformer.66._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.66._sharded_weight@0,
transformer.66._assembled_grad@0,N,transformer.66.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.66.mha.dwo@0"", ""transformer.66.ffn.dwgate@0"", ""transformer.66.ffn.dwdown@0""]}"
transformer.66._mha.wqkv_backward@0,N,transformer.66._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.66._mha.wo_backward@0,N,transformer.66._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.66._ffn.wgate_backward@0,N,transformer.66._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.66._ffn.wdown_backward@0,N,transformer.66._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.66._assembled_weight_backward@0,N,transformer.66._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.67.input_norm.x@0,N,transformer.66.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.67.input_norm.y@0,N,transformer.67.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.67.input_norm.dy@0,N,transformer.67.mha.dx@0,transformer.67.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.67.input_norm.y@0,
transformer.67.input_norm.dx@0,N,transformer.67.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.67.input_norm.x@0,
transformer.67.mha.x@0,N,transformer.67.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.67.mha.wqkv@0,N,transformer.67._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.67.mha.qkv@0,N,transformer.67.mha.x@0,transformer.67.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.67.mha.q@0,N,transformer.67.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.67.mha.k@0,N,transformer.67.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.67.mha.v@0,N,transformer.67.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.67.mha.attn@0,N,transformer.67.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.67.mha.wo@0,N,transformer.67._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.67.mha.o1@0,N,transformer.67.mha.attn@0,transformer.67.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.67.mha.o@0,N,transformer.67.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.67.mha.do@0,N,transformer.67.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.67.mha.o@0,
transformer.67.mha.do1@0,N,transformer.67.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.67.mha.o1@0,
transformer.67.mha.dattn@0,N,transformer.67.mha.do1@0,transformer.67._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.67.mha.dwo@0,N,transformer.67.mha.do1@0,transformer.67.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.67.mha.wo@0,
transformer.67.mha.dv@0,N,transformer.67.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.67.mha.v@0,
transformer.67.mha.dk@0,N,transformer.67.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.67.mha.k@0,
transformer.67.mha.dq@0,N,transformer.67.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.67.mha.q@0,
transformer.67.mha.dkv@0,N,transformer.67.mha.dv@0,transformer.67.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.67.mha.dqkv@0,N,transformer.67.mha.dkv@0,transformer.67.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.67.mha.qkv@0,
transformer.67.mha.dwqkv@0,N,transformer.67.mha.dqkv@0,transformer.67.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.67.mha.wqkv@0,
transformer.67.mha.dx1@0,N,transformer.67.mha.dqkv@0,transformer.67._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.67.mha.dx@0,N,transformer.67.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.67.mha.attn_kernel.q@0,N,transformer.67.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.67.mha.attn_kernel.k@0,N,transformer.67.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.67.mha.attn_kernel.v@0,N,transformer.67.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.67.mha.attn_kernel.k1@0,N,transformer.67.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.67.mha.attn_kernel.v1@0,N,transformer.67.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.67.mha.attn_kernel.qkv@0,N,transformer.67.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.67.mha.attn_kernel.k1@0"", ""transformer.67.mha.attn_kernel.v1@0""]}"
transformer.67.mha.attn_kernel.dqkv@0,N,transformer.67.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.67.mha.attn_kernel.qkv@0,
transformer.67.mha.attn_kernel.dq@0,N,transformer.67.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.67.mha.attn_kernel.q@0,
transformer.67.mha.attn_kernel.dk@0,N,transformer.67.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.67.mha.attn_kernel.dv@0,N,transformer.67.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.67.mha_res.x1@0,N,transformer.67.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.67.mha_res.x2@0,N,transformer.67.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.67.mha_res.y@0,N,transformer.67.mha_res.x1@0,transformer.67.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.67.mha_res.dy@0,N,transformer.67.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.67.mha_res.y@0,
transformer.67.mha_res.dx1@0,N,transformer.67.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.67.mha_res.x1@0,
transformer.67.mha_res.dx2@0,N,transformer.67.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.67.mha_res.x2@0,
transformer.67.post_attn_norm.x@0,N,transformer.67.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.67.post_attn_norm.y@0,N,transformer.67.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.67.post_attn_norm.dy@0,N,transformer.67.ffn.dx0@0,transformer.67.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.67.post_attn_norm.y@0,
transformer.67.post_attn_norm.dx@0,N,transformer.67.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.67.post_attn_norm.x@0,
transformer.67.ffn.x0@0,N,transformer.67.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.67.ffn.wgate@0,N,transformer.67._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.67.ffn.wdown@0,N,transformer.67._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.67.ffn.x00@0,N,transformer.67.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.67.ffn.xgate@0,N,transformer.67.ffn.x00@0,transformer.67.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.67.ffn.xdown1@0,N,transformer.67.ffn.xgate@0,transformer.67.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.67.ffn.xdown@0,N,transformer.67.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.67.ffn.dxdown@0,N,transformer.67.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.67.ffn.xdown@0,
transformer.67.ffn.dxdown2@0,N,transformer.67.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.67.ffn.dwdown@0,N,transformer.67.ffn.dxdown2@0,transformer.67.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.67.ffn.wdown@0,
transformer.67.ffn.dxgate@0,N,transformer.67.ffn.dxdown2@0,transformer.67._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.67.ffn.xgate@0,
transformer.67.ffn.x01@0,N,transformer.67.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.67.ffn.dwgate@0,N,transformer.67.ffn.dxgate@0,transformer.67.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.67.ffn.wgate@0,
transformer.67.ffn.dx000@0,N,transformer.67.ffn.dxgate@0,transformer.67._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.67.ffn.dx0@0,N,transformer.67.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.67.ffn_res.x1@0,N,transformer.67.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.67.ffn_res.x2@0,N,transformer.67.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.67.ffn_res.y@0,N,transformer.67.ffn_res.x1@0,transformer.67.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.67.ffn_res.dy@0,N,transformer.68.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.67.ffn_res.y@0,
transformer.67.ffn_res.dx1@0,N,transformer.67.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.67.ffn_res.x1@0,
transformer.67.ffn_res.dx2@0,N,transformer.67.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.67.ffn_res.x2@0,
transformer.67._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.67._assembled_weight@0,N,transformer.67._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.67._sharded_grad@0,N,transformer.67._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.67._sharded_weight@0,
transformer.67._assembled_grad@0,N,transformer.67.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.67.mha.dwo@0"", ""transformer.67.ffn.dwgate@0"", ""transformer.67.ffn.dwdown@0""]}"
transformer.67._mha.wqkv_backward@0,N,transformer.67._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.67._mha.wo_backward@0,N,transformer.67._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.67._ffn.wgate_backward@0,N,transformer.67._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.67._ffn.wdown_backward@0,N,transformer.67._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.67._assembled_weight_backward@0,N,transformer.67._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.68.input_norm.x@0,N,transformer.67.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.68.input_norm.y@0,N,transformer.68.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.68.input_norm.dy@0,N,transformer.68.mha.dx@0,transformer.68.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.68.input_norm.y@0,
transformer.68.input_norm.dx@0,N,transformer.68.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.68.input_norm.x@0,
transformer.68.mha.x@0,N,transformer.68.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.68.mha.wqkv@0,N,transformer.68._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.68.mha.qkv@0,N,transformer.68.mha.x@0,transformer.68.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.68.mha.q@0,N,transformer.68.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.68.mha.k@0,N,transformer.68.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.68.mha.v@0,N,transformer.68.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.68.mha.attn@0,N,transformer.68.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.68.mha.wo@0,N,transformer.68._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.68.mha.o1@0,N,transformer.68.mha.attn@0,transformer.68.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.68.mha.o@0,N,transformer.68.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.68.mha.do@0,N,transformer.68.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.68.mha.o@0,
transformer.68.mha.do1@0,N,transformer.68.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.68.mha.o1@0,
transformer.68.mha.dattn@0,N,transformer.68.mha.do1@0,transformer.68._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.68.mha.dwo@0,N,transformer.68.mha.do1@0,transformer.68.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.68.mha.wo@0,
transformer.68.mha.dv@0,N,transformer.68.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.68.mha.v@0,
transformer.68.mha.dk@0,N,transformer.68.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.68.mha.k@0,
transformer.68.mha.dq@0,N,transformer.68.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.68.mha.q@0,
transformer.68.mha.dkv@0,N,transformer.68.mha.dv@0,transformer.68.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.68.mha.dqkv@0,N,transformer.68.mha.dkv@0,transformer.68.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.68.mha.qkv@0,
transformer.68.mha.dwqkv@0,N,transformer.68.mha.dqkv@0,transformer.68.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.68.mha.wqkv@0,
transformer.68.mha.dx1@0,N,transformer.68.mha.dqkv@0,transformer.68._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.68.mha.dx@0,N,transformer.68.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.68.mha.attn_kernel.q@0,N,transformer.68.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.68.mha.attn_kernel.k@0,N,transformer.68.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.68.mha.attn_kernel.v@0,N,transformer.68.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.68.mha.attn_kernel.k1@0,N,transformer.68.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.68.mha.attn_kernel.v1@0,N,transformer.68.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.68.mha.attn_kernel.qkv@0,N,transformer.68.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.68.mha.attn_kernel.k1@0"", ""transformer.68.mha.attn_kernel.v1@0""]}"
transformer.68.mha.attn_kernel.dqkv@0,N,transformer.68.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.68.mha.attn_kernel.qkv@0,
transformer.68.mha.attn_kernel.dq@0,N,transformer.68.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.68.mha.attn_kernel.q@0,
transformer.68.mha.attn_kernel.dk@0,N,transformer.68.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.68.mha.attn_kernel.dv@0,N,transformer.68.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.68.mha_res.x1@0,N,transformer.68.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.68.mha_res.x2@0,N,transformer.68.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.68.mha_res.y@0,N,transformer.68.mha_res.x1@0,transformer.68.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.68.mha_res.dy@0,N,transformer.68.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.68.mha_res.y@0,
transformer.68.mha_res.dx1@0,N,transformer.68.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.68.mha_res.x1@0,
transformer.68.mha_res.dx2@0,N,transformer.68.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.68.mha_res.x2@0,
transformer.68.post_attn_norm.x@0,N,transformer.68.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.68.post_attn_norm.y@0,N,transformer.68.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.68.post_attn_norm.dy@0,N,transformer.68.ffn.dx0@0,transformer.68.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.68.post_attn_norm.y@0,
transformer.68.post_attn_norm.dx@0,N,transformer.68.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.68.post_attn_norm.x@0,
transformer.68.ffn.x0@0,N,transformer.68.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.68.ffn.wgate@0,N,transformer.68._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.68.ffn.wdown@0,N,transformer.68._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.68.ffn.x00@0,N,transformer.68.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.68.ffn.xgate@0,N,transformer.68.ffn.x00@0,transformer.68.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.68.ffn.xdown1@0,N,transformer.68.ffn.xgate@0,transformer.68.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.68.ffn.xdown@0,N,transformer.68.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.68.ffn.dxdown@0,N,transformer.68.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.68.ffn.xdown@0,
transformer.68.ffn.dxdown2@0,N,transformer.68.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.68.ffn.dwdown@0,N,transformer.68.ffn.dxdown2@0,transformer.68.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.68.ffn.wdown@0,
transformer.68.ffn.dxgate@0,N,transformer.68.ffn.dxdown2@0,transformer.68._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.68.ffn.xgate@0,
transformer.68.ffn.x01@0,N,transformer.68.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.68.ffn.dwgate@0,N,transformer.68.ffn.dxgate@0,transformer.68.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.68.ffn.wgate@0,
transformer.68.ffn.dx000@0,N,transformer.68.ffn.dxgate@0,transformer.68._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.68.ffn.dx0@0,N,transformer.68.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.68.ffn_res.x1@0,N,transformer.68.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.68.ffn_res.x2@0,N,transformer.68.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.68.ffn_res.y@0,N,transformer.68.ffn_res.x1@0,transformer.68.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.68.ffn_res.dy@0,N,transformer.69.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.68.ffn_res.y@0,
transformer.68.ffn_res.dx1@0,N,transformer.68.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.68.ffn_res.x1@0,
transformer.68.ffn_res.dx2@0,N,transformer.68.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.68.ffn_res.x2@0,
transformer.68._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.68._assembled_weight@0,N,transformer.68._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.68._sharded_grad@0,N,transformer.68._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.68._sharded_weight@0,
transformer.68._assembled_grad@0,N,transformer.68.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.68.mha.dwo@0"", ""transformer.68.ffn.dwgate@0"", ""transformer.68.ffn.dwdown@0""]}"
transformer.68._mha.wqkv_backward@0,N,transformer.68._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.68._mha.wo_backward@0,N,transformer.68._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.68._ffn.wgate_backward@0,N,transformer.68._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.68._ffn.wdown_backward@0,N,transformer.68._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.68._assembled_weight_backward@0,N,transformer.68._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.69.input_norm.x@0,N,transformer.68.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.69.input_norm.y@0,N,transformer.69.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.69.input_norm.dy@0,N,transformer.69.mha.dx@0,transformer.69.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.69.input_norm.y@0,
transformer.69.input_norm.dx@0,N,transformer.69.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.69.input_norm.x@0,
transformer.69.mha.x@0,N,transformer.69.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.69.mha.wqkv@0,N,transformer.69._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.69.mha.qkv@0,N,transformer.69.mha.x@0,transformer.69.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.69.mha.q@0,N,transformer.69.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.69.mha.k@0,N,transformer.69.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.69.mha.v@0,N,transformer.69.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.69.mha.attn@0,N,transformer.69.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.69.mha.wo@0,N,transformer.69._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.69.mha.o1@0,N,transformer.69.mha.attn@0,transformer.69.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.69.mha.o@0,N,transformer.69.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.69.mha.do@0,N,transformer.69.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.69.mha.o@0,
transformer.69.mha.do1@0,N,transformer.69.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.69.mha.o1@0,
transformer.69.mha.dattn@0,N,transformer.69.mha.do1@0,transformer.69._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.69.mha.dwo@0,N,transformer.69.mha.do1@0,transformer.69.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.69.mha.wo@0,
transformer.69.mha.dv@0,N,transformer.69.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.69.mha.v@0,
transformer.69.mha.dk@0,N,transformer.69.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.69.mha.k@0,
transformer.69.mha.dq@0,N,transformer.69.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.69.mha.q@0,
transformer.69.mha.dkv@0,N,transformer.69.mha.dv@0,transformer.69.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.69.mha.dqkv@0,N,transformer.69.mha.dkv@0,transformer.69.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.69.mha.qkv@0,
transformer.69.mha.dwqkv@0,N,transformer.69.mha.dqkv@0,transformer.69.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.69.mha.wqkv@0,
transformer.69.mha.dx1@0,N,transformer.69.mha.dqkv@0,transformer.69._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.69.mha.dx@0,N,transformer.69.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.69.mha.attn_kernel.q@0,N,transformer.69.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.69.mha.attn_kernel.k@0,N,transformer.69.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.69.mha.attn_kernel.v@0,N,transformer.69.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.69.mha.attn_kernel.k1@0,N,transformer.69.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.69.mha.attn_kernel.v1@0,N,transformer.69.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.69.mha.attn_kernel.qkv@0,N,transformer.69.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.69.mha.attn_kernel.k1@0"", ""transformer.69.mha.attn_kernel.v1@0""]}"
transformer.69.mha.attn_kernel.dqkv@0,N,transformer.69.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.69.mha.attn_kernel.qkv@0,
transformer.69.mha.attn_kernel.dq@0,N,transformer.69.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.69.mha.attn_kernel.q@0,
transformer.69.mha.attn_kernel.dk@0,N,transformer.69.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.69.mha.attn_kernel.dv@0,N,transformer.69.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.69.mha_res.x1@0,N,transformer.69.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.69.mha_res.x2@0,N,transformer.69.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.69.mha_res.y@0,N,transformer.69.mha_res.x1@0,transformer.69.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.69.mha_res.dy@0,N,transformer.69.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.69.mha_res.y@0,
transformer.69.mha_res.dx1@0,N,transformer.69.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.69.mha_res.x1@0,
transformer.69.mha_res.dx2@0,N,transformer.69.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.69.mha_res.x2@0,
transformer.69.post_attn_norm.x@0,N,transformer.69.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.69.post_attn_norm.y@0,N,transformer.69.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.69.post_attn_norm.dy@0,N,transformer.69.ffn.dx0@0,transformer.69.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.69.post_attn_norm.y@0,
transformer.69.post_attn_norm.dx@0,N,transformer.69.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.69.post_attn_norm.x@0,
transformer.69.ffn.x0@0,N,transformer.69.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.69.ffn.wgate@0,N,transformer.69._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.69.ffn.wdown@0,N,transformer.69._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.69.ffn.x00@0,N,transformer.69.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.69.ffn.xgate@0,N,transformer.69.ffn.x00@0,transformer.69.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.69.ffn.xdown1@0,N,transformer.69.ffn.xgate@0,transformer.69.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.69.ffn.xdown@0,N,transformer.69.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.69.ffn.dxdown@0,N,transformer.69.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.69.ffn.xdown@0,
transformer.69.ffn.dxdown2@0,N,transformer.69.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.69.ffn.dwdown@0,N,transformer.69.ffn.dxdown2@0,transformer.69.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.69.ffn.wdown@0,
transformer.69.ffn.dxgate@0,N,transformer.69.ffn.dxdown2@0,transformer.69._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.69.ffn.xgate@0,
transformer.69.ffn.x01@0,N,transformer.69.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.69.ffn.dwgate@0,N,transformer.69.ffn.dxgate@0,transformer.69.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.69.ffn.wgate@0,
transformer.69.ffn.dx000@0,N,transformer.69.ffn.dxgate@0,transformer.69._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.69.ffn.dx0@0,N,transformer.69.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.69.ffn_res.x1@0,N,transformer.69.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.69.ffn_res.x2@0,N,transformer.69.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.69.ffn_res.y@0,N,transformer.69.ffn_res.x1@0,transformer.69.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.69.ffn_res.dy@0,N,transformer.70.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.69.ffn_res.y@0,
transformer.69.ffn_res.dx1@0,N,transformer.69.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.69.ffn_res.x1@0,
transformer.69.ffn_res.dx2@0,N,transformer.69.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.69.ffn_res.x2@0,
transformer.69._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.69._assembled_weight@0,N,transformer.69._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.69._sharded_grad@0,N,transformer.69._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.69._sharded_weight@0,
transformer.69._assembled_grad@0,N,transformer.69.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.69.mha.dwo@0"", ""transformer.69.ffn.dwgate@0"", ""transformer.69.ffn.dwdown@0""]}"
transformer.69._mha.wqkv_backward@0,N,transformer.69._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.69._mha.wo_backward@0,N,transformer.69._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.69._ffn.wgate_backward@0,N,transformer.69._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.69._ffn.wdown_backward@0,N,transformer.69._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.69._assembled_weight_backward@0,N,transformer.69._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.70.input_norm.x@0,N,transformer.69.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.70.input_norm.y@0,N,transformer.70.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.70.input_norm.dy@0,N,transformer.70.mha.dx@0,transformer.70.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.70.input_norm.y@0,
transformer.70.input_norm.dx@0,N,transformer.70.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.70.input_norm.x@0,
transformer.70.mha.x@0,N,transformer.70.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.70.mha.wqkv@0,N,transformer.70._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.70.mha.qkv@0,N,transformer.70.mha.x@0,transformer.70.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.70.mha.q@0,N,transformer.70.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.70.mha.k@0,N,transformer.70.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.70.mha.v@0,N,transformer.70.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.70.mha.attn@0,N,transformer.70.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.70.mha.wo@0,N,transformer.70._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.70.mha.o1@0,N,transformer.70.mha.attn@0,transformer.70.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.70.mha.o@0,N,transformer.70.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.70.mha.do@0,N,transformer.70.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.70.mha.o@0,
transformer.70.mha.do1@0,N,transformer.70.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.70.mha.o1@0,
transformer.70.mha.dattn@0,N,transformer.70.mha.do1@0,transformer.70._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.70.mha.dwo@0,N,transformer.70.mha.do1@0,transformer.70.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.70.mha.wo@0,
transformer.70.mha.dv@0,N,transformer.70.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.70.mha.v@0,
transformer.70.mha.dk@0,N,transformer.70.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.70.mha.k@0,
transformer.70.mha.dq@0,N,transformer.70.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.70.mha.q@0,
transformer.70.mha.dkv@0,N,transformer.70.mha.dv@0,transformer.70.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.70.mha.dqkv@0,N,transformer.70.mha.dkv@0,transformer.70.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.70.mha.qkv@0,
transformer.70.mha.dwqkv@0,N,transformer.70.mha.dqkv@0,transformer.70.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.70.mha.wqkv@0,
transformer.70.mha.dx1@0,N,transformer.70.mha.dqkv@0,transformer.70._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.70.mha.dx@0,N,transformer.70.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.70.mha.attn_kernel.q@0,N,transformer.70.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.70.mha.attn_kernel.k@0,N,transformer.70.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.70.mha.attn_kernel.v@0,N,transformer.70.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.70.mha.attn_kernel.k1@0,N,transformer.70.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.70.mha.attn_kernel.v1@0,N,transformer.70.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.70.mha.attn_kernel.qkv@0,N,transformer.70.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.70.mha.attn_kernel.k1@0"", ""transformer.70.mha.attn_kernel.v1@0""]}"
transformer.70.mha.attn_kernel.dqkv@0,N,transformer.70.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.70.mha.attn_kernel.qkv@0,
transformer.70.mha.attn_kernel.dq@0,N,transformer.70.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.70.mha.attn_kernel.q@0,
transformer.70.mha.attn_kernel.dk@0,N,transformer.70.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.70.mha.attn_kernel.dv@0,N,transformer.70.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.70.mha_res.x1@0,N,transformer.70.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.70.mha_res.x2@0,N,transformer.70.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.70.mha_res.y@0,N,transformer.70.mha_res.x1@0,transformer.70.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.70.mha_res.dy@0,N,transformer.70.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.70.mha_res.y@0,
transformer.70.mha_res.dx1@0,N,transformer.70.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.70.mha_res.x1@0,
transformer.70.mha_res.dx2@0,N,transformer.70.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.70.mha_res.x2@0,
transformer.70.post_attn_norm.x@0,N,transformer.70.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.70.post_attn_norm.y@0,N,transformer.70.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.70.post_attn_norm.dy@0,N,transformer.70.ffn.dx0@0,transformer.70.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.70.post_attn_norm.y@0,
transformer.70.post_attn_norm.dx@0,N,transformer.70.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.70.post_attn_norm.x@0,
transformer.70.ffn.x0@0,N,transformer.70.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.70.ffn.wgate@0,N,transformer.70._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.70.ffn.wdown@0,N,transformer.70._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.70.ffn.x00@0,N,transformer.70.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.70.ffn.xgate@0,N,transformer.70.ffn.x00@0,transformer.70.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.70.ffn.xdown1@0,N,transformer.70.ffn.xgate@0,transformer.70.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.70.ffn.xdown@0,N,transformer.70.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.70.ffn.dxdown@0,N,transformer.70.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.70.ffn.xdown@0,
transformer.70.ffn.dxdown2@0,N,transformer.70.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.70.ffn.dwdown@0,N,transformer.70.ffn.dxdown2@0,transformer.70.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.70.ffn.wdown@0,
transformer.70.ffn.dxgate@0,N,transformer.70.ffn.dxdown2@0,transformer.70._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.70.ffn.xgate@0,
transformer.70.ffn.x01@0,N,transformer.70.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.70.ffn.dwgate@0,N,transformer.70.ffn.dxgate@0,transformer.70.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.70.ffn.wgate@0,
transformer.70.ffn.dx000@0,N,transformer.70.ffn.dxgate@0,transformer.70._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.70.ffn.dx0@0,N,transformer.70.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.70.ffn_res.x1@0,N,transformer.70.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.70.ffn_res.x2@0,N,transformer.70.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.70.ffn_res.y@0,N,transformer.70.ffn_res.x1@0,transformer.70.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.70.ffn_res.dy@0,N,transformer.71.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.70.ffn_res.y@0,
transformer.70.ffn_res.dx1@0,N,transformer.70.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.70.ffn_res.x1@0,
transformer.70.ffn_res.dx2@0,N,transformer.70.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.70.ffn_res.x2@0,
transformer.70._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.70._assembled_weight@0,N,transformer.70._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.70._sharded_grad@0,N,transformer.70._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.70._sharded_weight@0,
transformer.70._assembled_grad@0,N,transformer.70.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.70.mha.dwo@0"", ""transformer.70.ffn.dwgate@0"", ""transformer.70.ffn.dwdown@0""]}"
transformer.70._mha.wqkv_backward@0,N,transformer.70._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.70._mha.wo_backward@0,N,transformer.70._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.70._ffn.wgate_backward@0,N,transformer.70._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.70._ffn.wdown_backward@0,N,transformer.70._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.70._assembled_weight_backward@0,N,transformer.70._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.71.input_norm.x@0,N,transformer.70.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.71.input_norm.y@0,N,transformer.71.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.71.input_norm.dy@0,N,transformer.71.mha.dx@0,transformer.71.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.71.input_norm.y@0,
transformer.71.input_norm.dx@0,N,transformer.71.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.71.input_norm.x@0,
transformer.71.mha.x@0,N,transformer.71.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.71.mha.wqkv@0,N,transformer.71._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.71.mha.qkv@0,N,transformer.71.mha.x@0,transformer.71.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.71.mha.q@0,N,transformer.71.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.71.mha.k@0,N,transformer.71.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.71.mha.v@0,N,transformer.71.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.71.mha.attn@0,N,transformer.71.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.71.mha.wo@0,N,transformer.71._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.71.mha.o1@0,N,transformer.71.mha.attn@0,transformer.71.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.71.mha.o@0,N,transformer.71.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.71.mha.do@0,N,transformer.71.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.71.mha.o@0,
transformer.71.mha.do1@0,N,transformer.71.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.71.mha.o1@0,
transformer.71.mha.dattn@0,N,transformer.71.mha.do1@0,transformer.71._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.71.mha.dwo@0,N,transformer.71.mha.do1@0,transformer.71.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.71.mha.wo@0,
transformer.71.mha.dv@0,N,transformer.71.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.71.mha.v@0,
transformer.71.mha.dk@0,N,transformer.71.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.71.mha.k@0,
transformer.71.mha.dq@0,N,transformer.71.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.71.mha.q@0,
transformer.71.mha.dkv@0,N,transformer.71.mha.dv@0,transformer.71.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.71.mha.dqkv@0,N,transformer.71.mha.dkv@0,transformer.71.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.71.mha.qkv@0,
transformer.71.mha.dwqkv@0,N,transformer.71.mha.dqkv@0,transformer.71.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.71.mha.wqkv@0,
transformer.71.mha.dx1@0,N,transformer.71.mha.dqkv@0,transformer.71._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.71.mha.dx@0,N,transformer.71.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.71.mha.attn_kernel.q@0,N,transformer.71.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.71.mha.attn_kernel.k@0,N,transformer.71.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.71.mha.attn_kernel.v@0,N,transformer.71.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.71.mha.attn_kernel.k1@0,N,transformer.71.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.71.mha.attn_kernel.v1@0,N,transformer.71.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.71.mha.attn_kernel.qkv@0,N,transformer.71.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.71.mha.attn_kernel.k1@0"", ""transformer.71.mha.attn_kernel.v1@0""]}"
transformer.71.mha.attn_kernel.dqkv@0,N,transformer.71.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.71.mha.attn_kernel.qkv@0,
transformer.71.mha.attn_kernel.dq@0,N,transformer.71.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.71.mha.attn_kernel.q@0,
transformer.71.mha.attn_kernel.dk@0,N,transformer.71.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.71.mha.attn_kernel.dv@0,N,transformer.71.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.71.mha_res.x1@0,N,transformer.71.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.71.mha_res.x2@0,N,transformer.71.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.71.mha_res.y@0,N,transformer.71.mha_res.x1@0,transformer.71.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.71.mha_res.dy@0,N,transformer.71.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.71.mha_res.y@0,
transformer.71.mha_res.dx1@0,N,transformer.71.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.71.mha_res.x1@0,
transformer.71.mha_res.dx2@0,N,transformer.71.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.71.mha_res.x2@0,
transformer.71.post_attn_norm.x@0,N,transformer.71.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.71.post_attn_norm.y@0,N,transformer.71.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.71.post_attn_norm.dy@0,N,transformer.71.ffn.dx0@0,transformer.71.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.71.post_attn_norm.y@0,
transformer.71.post_attn_norm.dx@0,N,transformer.71.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.71.post_attn_norm.x@0,
transformer.71.ffn.x0@0,N,transformer.71.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.71.ffn.wgate@0,N,transformer.71._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.71.ffn.wdown@0,N,transformer.71._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.71.ffn.x00@0,N,transformer.71.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.71.ffn.xgate@0,N,transformer.71.ffn.x00@0,transformer.71.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.71.ffn.xdown1@0,N,transformer.71.ffn.xgate@0,transformer.71.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.71.ffn.xdown@0,N,transformer.71.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.71.ffn.dxdown@0,N,transformer.71.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.71.ffn.xdown@0,
transformer.71.ffn.dxdown2@0,N,transformer.71.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.71.ffn.dwdown@0,N,transformer.71.ffn.dxdown2@0,transformer.71.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.71.ffn.wdown@0,
transformer.71.ffn.dxgate@0,N,transformer.71.ffn.dxdown2@0,transformer.71._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.71.ffn.xgate@0,
transformer.71.ffn.x01@0,N,transformer.71.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.71.ffn.dwgate@0,N,transformer.71.ffn.dxgate@0,transformer.71.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.71.ffn.wgate@0,
transformer.71.ffn.dx000@0,N,transformer.71.ffn.dxgate@0,transformer.71._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.71.ffn.dx0@0,N,transformer.71.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.71.ffn_res.x1@0,N,transformer.71.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.71.ffn_res.x2@0,N,transformer.71.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.71.ffn_res.y@0,N,transformer.71.ffn_res.x1@0,transformer.71.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.71.ffn_res.dy@0,N,transformer.72.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.71.ffn_res.y@0,
transformer.71.ffn_res.dx1@0,N,transformer.71.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.71.ffn_res.x1@0,
transformer.71.ffn_res.dx2@0,N,transformer.71.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.71.ffn_res.x2@0,
transformer.71._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.71._assembled_weight@0,N,transformer.71._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.71._sharded_grad@0,N,transformer.71._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.71._sharded_weight@0,
transformer.71._assembled_grad@0,N,transformer.71.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.71.mha.dwo@0"", ""transformer.71.ffn.dwgate@0"", ""transformer.71.ffn.dwdown@0""]}"
transformer.71._mha.wqkv_backward@0,N,transformer.71._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.71._mha.wo_backward@0,N,transformer.71._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.71._ffn.wgate_backward@0,N,transformer.71._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.71._ffn.wdown_backward@0,N,transformer.71._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.71._assembled_weight_backward@0,N,transformer.71._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.72.input_norm.x@0,N,transformer.71.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.72.input_norm.y@0,N,transformer.72.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.72.input_norm.dy@0,N,transformer.72.mha.dx@0,transformer.72.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.72.input_norm.y@0,
transformer.72.input_norm.dx@0,N,transformer.72.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.72.input_norm.x@0,
transformer.72.mha.x@0,N,transformer.72.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.72.mha.wqkv@0,N,transformer.72._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.72.mha.qkv@0,N,transformer.72.mha.x@0,transformer.72.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.72.mha.q@0,N,transformer.72.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.72.mha.k@0,N,transformer.72.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.72.mha.v@0,N,transformer.72.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.72.mha.attn@0,N,transformer.72.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.72.mha.wo@0,N,transformer.72._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.72.mha.o1@0,N,transformer.72.mha.attn@0,transformer.72.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.72.mha.o@0,N,transformer.72.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.72.mha.do@0,N,transformer.72.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.72.mha.o@0,
transformer.72.mha.do1@0,N,transformer.72.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.72.mha.o1@0,
transformer.72.mha.dattn@0,N,transformer.72.mha.do1@0,transformer.72._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.72.mha.dwo@0,N,transformer.72.mha.do1@0,transformer.72.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.72.mha.wo@0,
transformer.72.mha.dv@0,N,transformer.72.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.72.mha.v@0,
transformer.72.mha.dk@0,N,transformer.72.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.72.mha.k@0,
transformer.72.mha.dq@0,N,transformer.72.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.72.mha.q@0,
transformer.72.mha.dkv@0,N,transformer.72.mha.dv@0,transformer.72.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.72.mha.dqkv@0,N,transformer.72.mha.dkv@0,transformer.72.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.72.mha.qkv@0,
transformer.72.mha.dwqkv@0,N,transformer.72.mha.dqkv@0,transformer.72.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.72.mha.wqkv@0,
transformer.72.mha.dx1@0,N,transformer.72.mha.dqkv@0,transformer.72._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.72.mha.dx@0,N,transformer.72.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.72.mha.attn_kernel.q@0,N,transformer.72.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.72.mha.attn_kernel.k@0,N,transformer.72.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.72.mha.attn_kernel.v@0,N,transformer.72.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.72.mha.attn_kernel.k1@0,N,transformer.72.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.72.mha.attn_kernel.v1@0,N,transformer.72.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.72.mha.attn_kernel.qkv@0,N,transformer.72.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.72.mha.attn_kernel.k1@0"", ""transformer.72.mha.attn_kernel.v1@0""]}"
transformer.72.mha.attn_kernel.dqkv@0,N,transformer.72.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.72.mha.attn_kernel.qkv@0,
transformer.72.mha.attn_kernel.dq@0,N,transformer.72.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.72.mha.attn_kernel.q@0,
transformer.72.mha.attn_kernel.dk@0,N,transformer.72.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.72.mha.attn_kernel.dv@0,N,transformer.72.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.72.mha_res.x1@0,N,transformer.72.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.72.mha_res.x2@0,N,transformer.72.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.72.mha_res.y@0,N,transformer.72.mha_res.x1@0,transformer.72.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.72.mha_res.dy@0,N,transformer.72.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.72.mha_res.y@0,
transformer.72.mha_res.dx1@0,N,transformer.72.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.72.mha_res.x1@0,
transformer.72.mha_res.dx2@0,N,transformer.72.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.72.mha_res.x2@0,
transformer.72.post_attn_norm.x@0,N,transformer.72.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.72.post_attn_norm.y@0,N,transformer.72.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.72.post_attn_norm.dy@0,N,transformer.72.ffn.dx0@0,transformer.72.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.72.post_attn_norm.y@0,
transformer.72.post_attn_norm.dx@0,N,transformer.72.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.72.post_attn_norm.x@0,
transformer.72.ffn.x0@0,N,transformer.72.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.72.ffn.wgate@0,N,transformer.72._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.72.ffn.wdown@0,N,transformer.72._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.72.ffn.x00@0,N,transformer.72.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.72.ffn.xgate@0,N,transformer.72.ffn.x00@0,transformer.72.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.72.ffn.xdown1@0,N,transformer.72.ffn.xgate@0,transformer.72.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.72.ffn.xdown@0,N,transformer.72.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.72.ffn.dxdown@0,N,transformer.72.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.72.ffn.xdown@0,
transformer.72.ffn.dxdown2@0,N,transformer.72.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.72.ffn.dwdown@0,N,transformer.72.ffn.dxdown2@0,transformer.72.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.72.ffn.wdown@0,
transformer.72.ffn.dxgate@0,N,transformer.72.ffn.dxdown2@0,transformer.72._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.72.ffn.xgate@0,
transformer.72.ffn.x01@0,N,transformer.72.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.72.ffn.dwgate@0,N,transformer.72.ffn.dxgate@0,transformer.72.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.72.ffn.wgate@0,
transformer.72.ffn.dx000@0,N,transformer.72.ffn.dxgate@0,transformer.72._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.72.ffn.dx0@0,N,transformer.72.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.72.ffn_res.x1@0,N,transformer.72.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.72.ffn_res.x2@0,N,transformer.72.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.72.ffn_res.y@0,N,transformer.72.ffn_res.x1@0,transformer.72.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.72.ffn_res.dy@0,N,transformer.73.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.72.ffn_res.y@0,
transformer.72.ffn_res.dx1@0,N,transformer.72.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.72.ffn_res.x1@0,
transformer.72.ffn_res.dx2@0,N,transformer.72.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.72.ffn_res.x2@0,
transformer.72._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.72._assembled_weight@0,N,transformer.72._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.72._sharded_grad@0,N,transformer.72._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.72._sharded_weight@0,
transformer.72._assembled_grad@0,N,transformer.72.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.72.mha.dwo@0"", ""transformer.72.ffn.dwgate@0"", ""transformer.72.ffn.dwdown@0""]}"
transformer.72._mha.wqkv_backward@0,N,transformer.72._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.72._mha.wo_backward@0,N,transformer.72._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.72._ffn.wgate_backward@0,N,transformer.72._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.72._ffn.wdown_backward@0,N,transformer.72._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.72._assembled_weight_backward@0,N,transformer.72._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.73.input_norm.x@0,N,transformer.72.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.73.input_norm.y@0,N,transformer.73.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.73.input_norm.dy@0,N,transformer.73.mha.dx@0,transformer.73.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.73.input_norm.y@0,
transformer.73.input_norm.dx@0,N,transformer.73.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.73.input_norm.x@0,
transformer.73.mha.x@0,N,transformer.73.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.73.mha.wqkv@0,N,transformer.73._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.73.mha.qkv@0,N,transformer.73.mha.x@0,transformer.73.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.73.mha.q@0,N,transformer.73.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.73.mha.k@0,N,transformer.73.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.73.mha.v@0,N,transformer.73.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.73.mha.attn@0,N,transformer.73.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.73.mha.wo@0,N,transformer.73._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.73.mha.o1@0,N,transformer.73.mha.attn@0,transformer.73.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.73.mha.o@0,N,transformer.73.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.73.mha.do@0,N,transformer.73.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.73.mha.o@0,
transformer.73.mha.do1@0,N,transformer.73.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.73.mha.o1@0,
transformer.73.mha.dattn@0,N,transformer.73.mha.do1@0,transformer.73._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.73.mha.dwo@0,N,transformer.73.mha.do1@0,transformer.73.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.73.mha.wo@0,
transformer.73.mha.dv@0,N,transformer.73.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.73.mha.v@0,
transformer.73.mha.dk@0,N,transformer.73.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.73.mha.k@0,
transformer.73.mha.dq@0,N,transformer.73.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.73.mha.q@0,
transformer.73.mha.dkv@0,N,transformer.73.mha.dv@0,transformer.73.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.73.mha.dqkv@0,N,transformer.73.mha.dkv@0,transformer.73.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.73.mha.qkv@0,
transformer.73.mha.dwqkv@0,N,transformer.73.mha.dqkv@0,transformer.73.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.73.mha.wqkv@0,
transformer.73.mha.dx1@0,N,transformer.73.mha.dqkv@0,transformer.73._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.73.mha.dx@0,N,transformer.73.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.73.mha.attn_kernel.q@0,N,transformer.73.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.73.mha.attn_kernel.k@0,N,transformer.73.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.73.mha.attn_kernel.v@0,N,transformer.73.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.73.mha.attn_kernel.k1@0,N,transformer.73.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.73.mha.attn_kernel.v1@0,N,transformer.73.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.73.mha.attn_kernel.qkv@0,N,transformer.73.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.73.mha.attn_kernel.k1@0"", ""transformer.73.mha.attn_kernel.v1@0""]}"
transformer.73.mha.attn_kernel.dqkv@0,N,transformer.73.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.73.mha.attn_kernel.qkv@0,
transformer.73.mha.attn_kernel.dq@0,N,transformer.73.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.73.mha.attn_kernel.q@0,
transformer.73.mha.attn_kernel.dk@0,N,transformer.73.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.73.mha.attn_kernel.dv@0,N,transformer.73.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.73.mha_res.x1@0,N,transformer.73.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.73.mha_res.x2@0,N,transformer.73.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.73.mha_res.y@0,N,transformer.73.mha_res.x1@0,transformer.73.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.73.mha_res.dy@0,N,transformer.73.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.73.mha_res.y@0,
transformer.73.mha_res.dx1@0,N,transformer.73.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.73.mha_res.x1@0,
transformer.73.mha_res.dx2@0,N,transformer.73.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.73.mha_res.x2@0,
transformer.73.post_attn_norm.x@0,N,transformer.73.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.73.post_attn_norm.y@0,N,transformer.73.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.73.post_attn_norm.dy@0,N,transformer.73.ffn.dx0@0,transformer.73.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.73.post_attn_norm.y@0,
transformer.73.post_attn_norm.dx@0,N,transformer.73.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.73.post_attn_norm.x@0,
transformer.73.ffn.x0@0,N,transformer.73.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.73.ffn.wgate@0,N,transformer.73._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.73.ffn.wdown@0,N,transformer.73._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.73.ffn.x00@0,N,transformer.73.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.73.ffn.xgate@0,N,transformer.73.ffn.x00@0,transformer.73.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.73.ffn.xdown1@0,N,transformer.73.ffn.xgate@0,transformer.73.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.73.ffn.xdown@0,N,transformer.73.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.73.ffn.dxdown@0,N,transformer.73.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.73.ffn.xdown@0,
transformer.73.ffn.dxdown2@0,N,transformer.73.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.73.ffn.dwdown@0,N,transformer.73.ffn.dxdown2@0,transformer.73.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.73.ffn.wdown@0,
transformer.73.ffn.dxgate@0,N,transformer.73.ffn.dxdown2@0,transformer.73._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.73.ffn.xgate@0,
transformer.73.ffn.x01@0,N,transformer.73.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.73.ffn.dwgate@0,N,transformer.73.ffn.dxgate@0,transformer.73.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.73.ffn.wgate@0,
transformer.73.ffn.dx000@0,N,transformer.73.ffn.dxgate@0,transformer.73._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.73.ffn.dx0@0,N,transformer.73.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.73.ffn_res.x1@0,N,transformer.73.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.73.ffn_res.x2@0,N,transformer.73.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.73.ffn_res.y@0,N,transformer.73.ffn_res.x1@0,transformer.73.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.73.ffn_res.dy@0,N,transformer.74.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.73.ffn_res.y@0,
transformer.73.ffn_res.dx1@0,N,transformer.73.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.73.ffn_res.x1@0,
transformer.73.ffn_res.dx2@0,N,transformer.73.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.73.ffn_res.x2@0,
transformer.73._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.73._assembled_weight@0,N,transformer.73._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.73._sharded_grad@0,N,transformer.73._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.73._sharded_weight@0,
transformer.73._assembled_grad@0,N,transformer.73.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.73.mha.dwo@0"", ""transformer.73.ffn.dwgate@0"", ""transformer.73.ffn.dwdown@0""]}"
transformer.73._mha.wqkv_backward@0,N,transformer.73._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.73._mha.wo_backward@0,N,transformer.73._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.73._ffn.wgate_backward@0,N,transformer.73._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.73._ffn.wdown_backward@0,N,transformer.73._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.73._assembled_weight_backward@0,N,transformer.73._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.74.input_norm.x@0,N,transformer.73.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.74.input_norm.y@0,N,transformer.74.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.74.input_norm.dy@0,N,transformer.74.mha.dx@0,transformer.74.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.74.input_norm.y@0,
transformer.74.input_norm.dx@0,N,transformer.74.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.74.input_norm.x@0,
transformer.74.mha.x@0,N,transformer.74.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.74.mha.wqkv@0,N,transformer.74._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.74.mha.qkv@0,N,transformer.74.mha.x@0,transformer.74.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.74.mha.q@0,N,transformer.74.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.74.mha.k@0,N,transformer.74.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.74.mha.v@0,N,transformer.74.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.74.mha.attn@0,N,transformer.74.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.74.mha.wo@0,N,transformer.74._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.74.mha.o1@0,N,transformer.74.mha.attn@0,transformer.74.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.74.mha.o@0,N,transformer.74.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.74.mha.do@0,N,transformer.74.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.74.mha.o@0,
transformer.74.mha.do1@0,N,transformer.74.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.74.mha.o1@0,
transformer.74.mha.dattn@0,N,transformer.74.mha.do1@0,transformer.74._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.74.mha.dwo@0,N,transformer.74.mha.do1@0,transformer.74.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.74.mha.wo@0,
transformer.74.mha.dv@0,N,transformer.74.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.74.mha.v@0,
transformer.74.mha.dk@0,N,transformer.74.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.74.mha.k@0,
transformer.74.mha.dq@0,N,transformer.74.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.74.mha.q@0,
transformer.74.mha.dkv@0,N,transformer.74.mha.dv@0,transformer.74.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.74.mha.dqkv@0,N,transformer.74.mha.dkv@0,transformer.74.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.74.mha.qkv@0,
transformer.74.mha.dwqkv@0,N,transformer.74.mha.dqkv@0,transformer.74.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.74.mha.wqkv@0,
transformer.74.mha.dx1@0,N,transformer.74.mha.dqkv@0,transformer.74._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.74.mha.dx@0,N,transformer.74.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.74.mha.attn_kernel.q@0,N,transformer.74.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.74.mha.attn_kernel.k@0,N,transformer.74.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.74.mha.attn_kernel.v@0,N,transformer.74.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.74.mha.attn_kernel.k1@0,N,transformer.74.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.74.mha.attn_kernel.v1@0,N,transformer.74.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.74.mha.attn_kernel.qkv@0,N,transformer.74.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.74.mha.attn_kernel.k1@0"", ""transformer.74.mha.attn_kernel.v1@0""]}"
transformer.74.mha.attn_kernel.dqkv@0,N,transformer.74.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.74.mha.attn_kernel.qkv@0,
transformer.74.mha.attn_kernel.dq@0,N,transformer.74.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.74.mha.attn_kernel.q@0,
transformer.74.mha.attn_kernel.dk@0,N,transformer.74.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.74.mha.attn_kernel.dv@0,N,transformer.74.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.74.mha_res.x1@0,N,transformer.74.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.74.mha_res.x2@0,N,transformer.74.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.74.mha_res.y@0,N,transformer.74.mha_res.x1@0,transformer.74.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.74.mha_res.dy@0,N,transformer.74.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.74.mha_res.y@0,
transformer.74.mha_res.dx1@0,N,transformer.74.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.74.mha_res.x1@0,
transformer.74.mha_res.dx2@0,N,transformer.74.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.74.mha_res.x2@0,
transformer.74.post_attn_norm.x@0,N,transformer.74.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.74.post_attn_norm.y@0,N,transformer.74.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.74.post_attn_norm.dy@0,N,transformer.74.ffn.dx0@0,transformer.74.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.74.post_attn_norm.y@0,
transformer.74.post_attn_norm.dx@0,N,transformer.74.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.74.post_attn_norm.x@0,
transformer.74.ffn.x0@0,N,transformer.74.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.74.ffn.wgate@0,N,transformer.74._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.74.ffn.wdown@0,N,transformer.74._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.74.ffn.x00@0,N,transformer.74.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.74.ffn.xgate@0,N,transformer.74.ffn.x00@0,transformer.74.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.74.ffn.xdown1@0,N,transformer.74.ffn.xgate@0,transformer.74.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.74.ffn.xdown@0,N,transformer.74.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.74.ffn.dxdown@0,N,transformer.74.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.74.ffn.xdown@0,
transformer.74.ffn.dxdown2@0,N,transformer.74.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.74.ffn.dwdown@0,N,transformer.74.ffn.dxdown2@0,transformer.74.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.74.ffn.wdown@0,
transformer.74.ffn.dxgate@0,N,transformer.74.ffn.dxdown2@0,transformer.74._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.74.ffn.xgate@0,
transformer.74.ffn.x01@0,N,transformer.74.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.74.ffn.dwgate@0,N,transformer.74.ffn.dxgate@0,transformer.74.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.74.ffn.wgate@0,
transformer.74.ffn.dx000@0,N,transformer.74.ffn.dxgate@0,transformer.74._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.74.ffn.dx0@0,N,transformer.74.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.74.ffn_res.x1@0,N,transformer.74.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.74.ffn_res.x2@0,N,transformer.74.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.74.ffn_res.y@0,N,transformer.74.ffn_res.x1@0,transformer.74.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.74.ffn_res.dy@0,N,transformer.75.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.74.ffn_res.y@0,
transformer.74.ffn_res.dx1@0,N,transformer.74.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.74.ffn_res.x1@0,
transformer.74.ffn_res.dx2@0,N,transformer.74.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.74.ffn_res.x2@0,
transformer.74._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.74._assembled_weight@0,N,transformer.74._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.74._sharded_grad@0,N,transformer.74._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.74._sharded_weight@0,
transformer.74._assembled_grad@0,N,transformer.74.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.74.mha.dwo@0"", ""transformer.74.ffn.dwgate@0"", ""transformer.74.ffn.dwdown@0""]}"
transformer.74._mha.wqkv_backward@0,N,transformer.74._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.74._mha.wo_backward@0,N,transformer.74._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.74._ffn.wgate_backward@0,N,transformer.74._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.74._ffn.wdown_backward@0,N,transformer.74._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.74._assembled_weight_backward@0,N,transformer.74._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.75.input_norm.x@0,N,transformer.74.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.75.input_norm.y@0,N,transformer.75.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.75.input_norm.dy@0,N,transformer.75.mha.dx@0,transformer.75.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.75.input_norm.y@0,
transformer.75.input_norm.dx@0,N,transformer.75.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.75.input_norm.x@0,
transformer.75.mha.x@0,N,transformer.75.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.75.mha.wqkv@0,N,transformer.75._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.75.mha.qkv@0,N,transformer.75.mha.x@0,transformer.75.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.75.mha.q@0,N,transformer.75.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.75.mha.k@0,N,transformer.75.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.75.mha.v@0,N,transformer.75.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.75.mha.attn@0,N,transformer.75.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.75.mha.wo@0,N,transformer.75._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.75.mha.o1@0,N,transformer.75.mha.attn@0,transformer.75.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.75.mha.o@0,N,transformer.75.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.75.mha.do@0,N,transformer.75.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.75.mha.o@0,
transformer.75.mha.do1@0,N,transformer.75.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.75.mha.o1@0,
transformer.75.mha.dattn@0,N,transformer.75.mha.do1@0,transformer.75._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.75.mha.dwo@0,N,transformer.75.mha.do1@0,transformer.75.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.75.mha.wo@0,
transformer.75.mha.dv@0,N,transformer.75.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.75.mha.v@0,
transformer.75.mha.dk@0,N,transformer.75.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.75.mha.k@0,
transformer.75.mha.dq@0,N,transformer.75.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.75.mha.q@0,
transformer.75.mha.dkv@0,N,transformer.75.mha.dv@0,transformer.75.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.75.mha.dqkv@0,N,transformer.75.mha.dkv@0,transformer.75.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.75.mha.qkv@0,
transformer.75.mha.dwqkv@0,N,transformer.75.mha.dqkv@0,transformer.75.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.75.mha.wqkv@0,
transformer.75.mha.dx1@0,N,transformer.75.mha.dqkv@0,transformer.75._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.75.mha.dx@0,N,transformer.75.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.75.mha.attn_kernel.q@0,N,transformer.75.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.75.mha.attn_kernel.k@0,N,transformer.75.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.75.mha.attn_kernel.v@0,N,transformer.75.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.75.mha.attn_kernel.k1@0,N,transformer.75.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.75.mha.attn_kernel.v1@0,N,transformer.75.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.75.mha.attn_kernel.qkv@0,N,transformer.75.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.75.mha.attn_kernel.k1@0"", ""transformer.75.mha.attn_kernel.v1@0""]}"
transformer.75.mha.attn_kernel.dqkv@0,N,transformer.75.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.75.mha.attn_kernel.qkv@0,
transformer.75.mha.attn_kernel.dq@0,N,transformer.75.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.75.mha.attn_kernel.q@0,
transformer.75.mha.attn_kernel.dk@0,N,transformer.75.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.75.mha.attn_kernel.dv@0,N,transformer.75.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.75.mha_res.x1@0,N,transformer.75.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.75.mha_res.x2@0,N,transformer.75.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.75.mha_res.y@0,N,transformer.75.mha_res.x1@0,transformer.75.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.75.mha_res.dy@0,N,transformer.75.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.75.mha_res.y@0,
transformer.75.mha_res.dx1@0,N,transformer.75.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.75.mha_res.x1@0,
transformer.75.mha_res.dx2@0,N,transformer.75.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.75.mha_res.x2@0,
transformer.75.post_attn_norm.x@0,N,transformer.75.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.75.post_attn_norm.y@0,N,transformer.75.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.75.post_attn_norm.dy@0,N,transformer.75.ffn.dx0@0,transformer.75.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.75.post_attn_norm.y@0,
transformer.75.post_attn_norm.dx@0,N,transformer.75.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.75.post_attn_norm.x@0,
transformer.75.ffn.x0@0,N,transformer.75.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.75.ffn.wgate@0,N,transformer.75._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.75.ffn.wdown@0,N,transformer.75._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.75.ffn.x00@0,N,transformer.75.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.75.ffn.xgate@0,N,transformer.75.ffn.x00@0,transformer.75.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.75.ffn.xdown1@0,N,transformer.75.ffn.xgate@0,transformer.75.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.75.ffn.xdown@0,N,transformer.75.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.75.ffn.dxdown@0,N,transformer.75.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.75.ffn.xdown@0,
transformer.75.ffn.dxdown2@0,N,transformer.75.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.75.ffn.dwdown@0,N,transformer.75.ffn.dxdown2@0,transformer.75.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.75.ffn.wdown@0,
transformer.75.ffn.dxgate@0,N,transformer.75.ffn.dxdown2@0,transformer.75._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.75.ffn.xgate@0,
transformer.75.ffn.x01@0,N,transformer.75.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.75.ffn.dwgate@0,N,transformer.75.ffn.dxgate@0,transformer.75.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.75.ffn.wgate@0,
transformer.75.ffn.dx000@0,N,transformer.75.ffn.dxgate@0,transformer.75._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.75.ffn.dx0@0,N,transformer.75.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.75.ffn_res.x1@0,N,transformer.75.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.75.ffn_res.x2@0,N,transformer.75.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.75.ffn_res.y@0,N,transformer.75.ffn_res.x1@0,transformer.75.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.75.ffn_res.dy@0,N,transformer.76.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.75.ffn_res.y@0,
transformer.75.ffn_res.dx1@0,N,transformer.75.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.75.ffn_res.x1@0,
transformer.75.ffn_res.dx2@0,N,transformer.75.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.75.ffn_res.x2@0,
transformer.75._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.75._assembled_weight@0,N,transformer.75._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.75._sharded_grad@0,N,transformer.75._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.75._sharded_weight@0,
transformer.75._assembled_grad@0,N,transformer.75.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.75.mha.dwo@0"", ""transformer.75.ffn.dwgate@0"", ""transformer.75.ffn.dwdown@0""]}"
transformer.75._mha.wqkv_backward@0,N,transformer.75._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.75._mha.wo_backward@0,N,transformer.75._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.75._ffn.wgate_backward@0,N,transformer.75._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.75._ffn.wdown_backward@0,N,transformer.75._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.75._assembled_weight_backward@0,N,transformer.75._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.76.input_norm.x@0,N,transformer.75.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.76.input_norm.y@0,N,transformer.76.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.76.input_norm.dy@0,N,transformer.76.mha.dx@0,transformer.76.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.76.input_norm.y@0,
transformer.76.input_norm.dx@0,N,transformer.76.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.76.input_norm.x@0,
transformer.76.mha.x@0,N,transformer.76.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.76.mha.wqkv@0,N,transformer.76._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.76.mha.qkv@0,N,transformer.76.mha.x@0,transformer.76.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.76.mha.q@0,N,transformer.76.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.76.mha.k@0,N,transformer.76.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.76.mha.v@0,N,transformer.76.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.76.mha.attn@0,N,transformer.76.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.76.mha.wo@0,N,transformer.76._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.76.mha.o1@0,N,transformer.76.mha.attn@0,transformer.76.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.76.mha.o@0,N,transformer.76.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.76.mha.do@0,N,transformer.76.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.76.mha.o@0,
transformer.76.mha.do1@0,N,transformer.76.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.76.mha.o1@0,
transformer.76.mha.dattn@0,N,transformer.76.mha.do1@0,transformer.76._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.76.mha.dwo@0,N,transformer.76.mha.do1@0,transformer.76.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.76.mha.wo@0,
transformer.76.mha.dv@0,N,transformer.76.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.76.mha.v@0,
transformer.76.mha.dk@0,N,transformer.76.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.76.mha.k@0,
transformer.76.mha.dq@0,N,transformer.76.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.76.mha.q@0,
transformer.76.mha.dkv@0,N,transformer.76.mha.dv@0,transformer.76.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.76.mha.dqkv@0,N,transformer.76.mha.dkv@0,transformer.76.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.76.mha.qkv@0,
transformer.76.mha.dwqkv@0,N,transformer.76.mha.dqkv@0,transformer.76.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.76.mha.wqkv@0,
transformer.76.mha.dx1@0,N,transformer.76.mha.dqkv@0,transformer.76._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.76.mha.dx@0,N,transformer.76.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.76.mha.attn_kernel.q@0,N,transformer.76.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.76.mha.attn_kernel.k@0,N,transformer.76.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.76.mha.attn_kernel.v@0,N,transformer.76.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.76.mha.attn_kernel.k1@0,N,transformer.76.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.76.mha.attn_kernel.v1@0,N,transformer.76.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.76.mha.attn_kernel.qkv@0,N,transformer.76.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.76.mha.attn_kernel.k1@0"", ""transformer.76.mha.attn_kernel.v1@0""]}"
transformer.76.mha.attn_kernel.dqkv@0,N,transformer.76.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.76.mha.attn_kernel.qkv@0,
transformer.76.mha.attn_kernel.dq@0,N,transformer.76.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.76.mha.attn_kernel.q@0,
transformer.76.mha.attn_kernel.dk@0,N,transformer.76.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.76.mha.attn_kernel.dv@0,N,transformer.76.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.76.mha_res.x1@0,N,transformer.76.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.76.mha_res.x2@0,N,transformer.76.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.76.mha_res.y@0,N,transformer.76.mha_res.x1@0,transformer.76.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.76.mha_res.dy@0,N,transformer.76.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.76.mha_res.y@0,
transformer.76.mha_res.dx1@0,N,transformer.76.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.76.mha_res.x1@0,
transformer.76.mha_res.dx2@0,N,transformer.76.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.76.mha_res.x2@0,
transformer.76.post_attn_norm.x@0,N,transformer.76.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.76.post_attn_norm.y@0,N,transformer.76.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.76.post_attn_norm.dy@0,N,transformer.76.ffn.dx0@0,transformer.76.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.76.post_attn_norm.y@0,
transformer.76.post_attn_norm.dx@0,N,transformer.76.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.76.post_attn_norm.x@0,
transformer.76.ffn.x0@0,N,transformer.76.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.76.ffn.wgate@0,N,transformer.76._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.76.ffn.wdown@0,N,transformer.76._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.76.ffn.x00@0,N,transformer.76.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.76.ffn.xgate@0,N,transformer.76.ffn.x00@0,transformer.76.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.76.ffn.xdown1@0,N,transformer.76.ffn.xgate@0,transformer.76.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.76.ffn.xdown@0,N,transformer.76.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.76.ffn.dxdown@0,N,transformer.76.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.76.ffn.xdown@0,
transformer.76.ffn.dxdown2@0,N,transformer.76.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.76.ffn.dwdown@0,N,transformer.76.ffn.dxdown2@0,transformer.76.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.76.ffn.wdown@0,
transformer.76.ffn.dxgate@0,N,transformer.76.ffn.dxdown2@0,transformer.76._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.76.ffn.xgate@0,
transformer.76.ffn.x01@0,N,transformer.76.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.76.ffn.dwgate@0,N,transformer.76.ffn.dxgate@0,transformer.76.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.76.ffn.wgate@0,
transformer.76.ffn.dx000@0,N,transformer.76.ffn.dxgate@0,transformer.76._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.76.ffn.dx0@0,N,transformer.76.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.76.ffn_res.x1@0,N,transformer.76.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.76.ffn_res.x2@0,N,transformer.76.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.76.ffn_res.y@0,N,transformer.76.ffn_res.x1@0,transformer.76.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.76.ffn_res.dy@0,N,transformer.77.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.76.ffn_res.y@0,
transformer.76.ffn_res.dx1@0,N,transformer.76.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.76.ffn_res.x1@0,
transformer.76.ffn_res.dx2@0,N,transformer.76.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.76.ffn_res.x2@0,
transformer.76._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.76._assembled_weight@0,N,transformer.76._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.76._sharded_grad@0,N,transformer.76._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.76._sharded_weight@0,
transformer.76._assembled_grad@0,N,transformer.76.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.76.mha.dwo@0"", ""transformer.76.ffn.dwgate@0"", ""transformer.76.ffn.dwdown@0""]}"
transformer.76._mha.wqkv_backward@0,N,transformer.76._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.76._mha.wo_backward@0,N,transformer.76._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.76._ffn.wgate_backward@0,N,transformer.76._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.76._ffn.wdown_backward@0,N,transformer.76._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.76._assembled_weight_backward@0,N,transformer.76._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.77.input_norm.x@0,N,transformer.76.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.77.input_norm.y@0,N,transformer.77.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.77.input_norm.dy@0,N,transformer.77.mha.dx@0,transformer.77.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.77.input_norm.y@0,
transformer.77.input_norm.dx@0,N,transformer.77.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.77.input_norm.x@0,
transformer.77.mha.x@0,N,transformer.77.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.77.mha.wqkv@0,N,transformer.77._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.77.mha.qkv@0,N,transformer.77.mha.x@0,transformer.77.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.77.mha.q@0,N,transformer.77.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.77.mha.k@0,N,transformer.77.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.77.mha.v@0,N,transformer.77.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.77.mha.attn@0,N,transformer.77.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.77.mha.wo@0,N,transformer.77._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.77.mha.o1@0,N,transformer.77.mha.attn@0,transformer.77.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.77.mha.o@0,N,transformer.77.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.77.mha.do@0,N,transformer.77.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.77.mha.o@0,
transformer.77.mha.do1@0,N,transformer.77.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.77.mha.o1@0,
transformer.77.mha.dattn@0,N,transformer.77.mha.do1@0,transformer.77._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.77.mha.dwo@0,N,transformer.77.mha.do1@0,transformer.77.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.77.mha.wo@0,
transformer.77.mha.dv@0,N,transformer.77.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.77.mha.v@0,
transformer.77.mha.dk@0,N,transformer.77.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.77.mha.k@0,
transformer.77.mha.dq@0,N,transformer.77.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.77.mha.q@0,
transformer.77.mha.dkv@0,N,transformer.77.mha.dv@0,transformer.77.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.77.mha.dqkv@0,N,transformer.77.mha.dkv@0,transformer.77.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.77.mha.qkv@0,
transformer.77.mha.dwqkv@0,N,transformer.77.mha.dqkv@0,transformer.77.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.77.mha.wqkv@0,
transformer.77.mha.dx1@0,N,transformer.77.mha.dqkv@0,transformer.77._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.77.mha.dx@0,N,transformer.77.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.77.mha.attn_kernel.q@0,N,transformer.77.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.77.mha.attn_kernel.k@0,N,transformer.77.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.77.mha.attn_kernel.v@0,N,transformer.77.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.77.mha.attn_kernel.k1@0,N,transformer.77.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.77.mha.attn_kernel.v1@0,N,transformer.77.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.77.mha.attn_kernel.qkv@0,N,transformer.77.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.77.mha.attn_kernel.k1@0"", ""transformer.77.mha.attn_kernel.v1@0""]}"
transformer.77.mha.attn_kernel.dqkv@0,N,transformer.77.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.77.mha.attn_kernel.qkv@0,
transformer.77.mha.attn_kernel.dq@0,N,transformer.77.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.77.mha.attn_kernel.q@0,
transformer.77.mha.attn_kernel.dk@0,N,transformer.77.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.77.mha.attn_kernel.dv@0,N,transformer.77.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.77.mha_res.x1@0,N,transformer.77.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.77.mha_res.x2@0,N,transformer.77.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.77.mha_res.y@0,N,transformer.77.mha_res.x1@0,transformer.77.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.77.mha_res.dy@0,N,transformer.77.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.77.mha_res.y@0,
transformer.77.mha_res.dx1@0,N,transformer.77.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.77.mha_res.x1@0,
transformer.77.mha_res.dx2@0,N,transformer.77.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.77.mha_res.x2@0,
transformer.77.post_attn_norm.x@0,N,transformer.77.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.77.post_attn_norm.y@0,N,transformer.77.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.77.post_attn_norm.dy@0,N,transformer.77.ffn.dx0@0,transformer.77.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.77.post_attn_norm.y@0,
transformer.77.post_attn_norm.dx@0,N,transformer.77.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.77.post_attn_norm.x@0,
transformer.77.ffn.x0@0,N,transformer.77.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.77.ffn.wgate@0,N,transformer.77._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.77.ffn.wdown@0,N,transformer.77._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.77.ffn.x00@0,N,transformer.77.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.77.ffn.xgate@0,N,transformer.77.ffn.x00@0,transformer.77.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.77.ffn.xdown1@0,N,transformer.77.ffn.xgate@0,transformer.77.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.77.ffn.xdown@0,N,transformer.77.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.77.ffn.dxdown@0,N,transformer.77.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.77.ffn.xdown@0,
transformer.77.ffn.dxdown2@0,N,transformer.77.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.77.ffn.dwdown@0,N,transformer.77.ffn.dxdown2@0,transformer.77.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.77.ffn.wdown@0,
transformer.77.ffn.dxgate@0,N,transformer.77.ffn.dxdown2@0,transformer.77._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.77.ffn.xgate@0,
transformer.77.ffn.x01@0,N,transformer.77.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.77.ffn.dwgate@0,N,transformer.77.ffn.dxgate@0,transformer.77.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.77.ffn.wgate@0,
transformer.77.ffn.dx000@0,N,transformer.77.ffn.dxgate@0,transformer.77._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.77.ffn.dx0@0,N,transformer.77.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.77.ffn_res.x1@0,N,transformer.77.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.77.ffn_res.x2@0,N,transformer.77.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.77.ffn_res.y@0,N,transformer.77.ffn_res.x1@0,transformer.77.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.77.ffn_res.dy@0,N,transformer.78.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.77.ffn_res.y@0,
transformer.77.ffn_res.dx1@0,N,transformer.77.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.77.ffn_res.x1@0,
transformer.77.ffn_res.dx2@0,N,transformer.77.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.77.ffn_res.x2@0,
transformer.77._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.77._assembled_weight@0,N,transformer.77._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.77._sharded_grad@0,N,transformer.77._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.77._sharded_weight@0,
transformer.77._assembled_grad@0,N,transformer.77.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.77.mha.dwo@0"", ""transformer.77.ffn.dwgate@0"", ""transformer.77.ffn.dwdown@0""]}"
transformer.77._mha.wqkv_backward@0,N,transformer.77._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.77._mha.wo_backward@0,N,transformer.77._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.77._ffn.wgate_backward@0,N,transformer.77._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.77._ffn.wdown_backward@0,N,transformer.77._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.77._assembled_weight_backward@0,N,transformer.77._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.78.input_norm.x@0,N,transformer.77.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.78.input_norm.y@0,N,transformer.78.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.78.input_norm.dy@0,N,transformer.78.mha.dx@0,transformer.78.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.78.input_norm.y@0,
transformer.78.input_norm.dx@0,N,transformer.78.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.78.input_norm.x@0,
transformer.78.mha.x@0,N,transformer.78.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.78.mha.wqkv@0,N,transformer.78._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.78.mha.qkv@0,N,transformer.78.mha.x@0,transformer.78.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.78.mha.q@0,N,transformer.78.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.78.mha.k@0,N,transformer.78.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.78.mha.v@0,N,transformer.78.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.78.mha.attn@0,N,transformer.78.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.78.mha.wo@0,N,transformer.78._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.78.mha.o1@0,N,transformer.78.mha.attn@0,transformer.78.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.78.mha.o@0,N,transformer.78.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.78.mha.do@0,N,transformer.78.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.78.mha.o@0,
transformer.78.mha.do1@0,N,transformer.78.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.78.mha.o1@0,
transformer.78.mha.dattn@0,N,transformer.78.mha.do1@0,transformer.78._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.78.mha.dwo@0,N,transformer.78.mha.do1@0,transformer.78.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.78.mha.wo@0,
transformer.78.mha.dv@0,N,transformer.78.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.78.mha.v@0,
transformer.78.mha.dk@0,N,transformer.78.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.78.mha.k@0,
transformer.78.mha.dq@0,N,transformer.78.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.78.mha.q@0,
transformer.78.mha.dkv@0,N,transformer.78.mha.dv@0,transformer.78.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.78.mha.dqkv@0,N,transformer.78.mha.dkv@0,transformer.78.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.78.mha.qkv@0,
transformer.78.mha.dwqkv@0,N,transformer.78.mha.dqkv@0,transformer.78.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.78.mha.wqkv@0,
transformer.78.mha.dx1@0,N,transformer.78.mha.dqkv@0,transformer.78._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.78.mha.dx@0,N,transformer.78.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.78.mha.attn_kernel.q@0,N,transformer.78.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.78.mha.attn_kernel.k@0,N,transformer.78.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.78.mha.attn_kernel.v@0,N,transformer.78.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.78.mha.attn_kernel.k1@0,N,transformer.78.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.78.mha.attn_kernel.v1@0,N,transformer.78.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.78.mha.attn_kernel.qkv@0,N,transformer.78.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.78.mha.attn_kernel.k1@0"", ""transformer.78.mha.attn_kernel.v1@0""]}"
transformer.78.mha.attn_kernel.dqkv@0,N,transformer.78.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.78.mha.attn_kernel.qkv@0,
transformer.78.mha.attn_kernel.dq@0,N,transformer.78.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.78.mha.attn_kernel.q@0,
transformer.78.mha.attn_kernel.dk@0,N,transformer.78.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.78.mha.attn_kernel.dv@0,N,transformer.78.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.78.mha_res.x1@0,N,transformer.78.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.78.mha_res.x2@0,N,transformer.78.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.78.mha_res.y@0,N,transformer.78.mha_res.x1@0,transformer.78.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.78.mha_res.dy@0,N,transformer.78.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.78.mha_res.y@0,
transformer.78.mha_res.dx1@0,N,transformer.78.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.78.mha_res.x1@0,
transformer.78.mha_res.dx2@0,N,transformer.78.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.78.mha_res.x2@0,
transformer.78.post_attn_norm.x@0,N,transformer.78.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.78.post_attn_norm.y@0,N,transformer.78.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.78.post_attn_norm.dy@0,N,transformer.78.ffn.dx0@0,transformer.78.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.78.post_attn_norm.y@0,
transformer.78.post_attn_norm.dx@0,N,transformer.78.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.78.post_attn_norm.x@0,
transformer.78.ffn.x0@0,N,transformer.78.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.78.ffn.wgate@0,N,transformer.78._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.78.ffn.wdown@0,N,transformer.78._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.78.ffn.x00@0,N,transformer.78.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.78.ffn.xgate@0,N,transformer.78.ffn.x00@0,transformer.78.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.78.ffn.xdown1@0,N,transformer.78.ffn.xgate@0,transformer.78.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.78.ffn.xdown@0,N,transformer.78.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.78.ffn.dxdown@0,N,transformer.78.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.78.ffn.xdown@0,
transformer.78.ffn.dxdown2@0,N,transformer.78.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.78.ffn.dwdown@0,N,transformer.78.ffn.dxdown2@0,transformer.78.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.78.ffn.wdown@0,
transformer.78.ffn.dxgate@0,N,transformer.78.ffn.dxdown2@0,transformer.78._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.78.ffn.xgate@0,
transformer.78.ffn.x01@0,N,transformer.78.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.78.ffn.dwgate@0,N,transformer.78.ffn.dxgate@0,transformer.78.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.78.ffn.wgate@0,
transformer.78.ffn.dx000@0,N,transformer.78.ffn.dxgate@0,transformer.78._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.78.ffn.dx0@0,N,transformer.78.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.78.ffn_res.x1@0,N,transformer.78.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.78.ffn_res.x2@0,N,transformer.78.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.78.ffn_res.y@0,N,transformer.78.ffn_res.x1@0,transformer.78.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.78.ffn_res.dy@0,N,transformer.79.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.78.ffn_res.y@0,
transformer.78.ffn_res.dx1@0,N,transformer.78.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.78.ffn_res.x1@0,
transformer.78.ffn_res.dx2@0,N,transformer.78.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.78.ffn_res.x2@0,
transformer.78._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.78._assembled_weight@0,N,transformer.78._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.78._sharded_grad@0,N,transformer.78._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.78._sharded_weight@0,
transformer.78._assembled_grad@0,N,transformer.78.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.78.mha.dwo@0"", ""transformer.78.ffn.dwgate@0"", ""transformer.78.ffn.dwdown@0""]}"
transformer.78._mha.wqkv_backward@0,N,transformer.78._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.78._mha.wo_backward@0,N,transformer.78._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.78._ffn.wgate_backward@0,N,transformer.78._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.78._ffn.wdown_backward@0,N,transformer.78._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.78._assembled_weight_backward@0,N,transformer.78._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.79.input_norm.x@0,N,transformer.78.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.79.input_norm.y@0,N,transformer.79.input_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.79.input_norm.dy@0,N,transformer.79.mha.dx@0,transformer.79.mha_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.79.input_norm.y@0,
transformer.79.input_norm.dx@0,N,transformer.79.input_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.79.input_norm.x@0,
transformer.79.mha.x@0,N,transformer.79.input_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.79.mha.wqkv@0,N,transformer.79._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.79.mha.qkv@0,N,transformer.79.mha.x@0,transformer.79.mha.wqkv@0,M,"bsm,mnh->bsnh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.79.mha.q@0,N,transformer.79.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.79.mha.k@0,N,transformer.79.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.79.mha.v@0,N,transformer.79.mha.qkv@0,,SLICE,3:Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,,,,
transformer.79.mha.attn@0,N,transformer.79.mha.attn_kernel.qkv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.79.mha.wo@0,N,transformer.79._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.79.mha.o1@0,N,transformer.79.mha.attn@0,transformer.79.mha.wo@0,M,"bsmh,mhn->bsn","Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.79.mha.o@0,N,transformer.79.mha.o1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.79.mha.do@0,N,transformer.79.mha_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.79.mha.o@0,
transformer.79.mha.do1@0,N,transformer.79.mha.do@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,transformer.79.mha.o1@0,
transformer.79.mha.dattn@0,N,transformer.79.mha.do1@0,transformer.79._mha.wo_backward@0,M,"bsn,mhn->bsmh","Batch/dp,Seq/cp,Dmodel",1,"Dmodel/Head,Head/tp,Dmodel",1.00000000000000,,
transformer.79.mha.dwo@0,N,transformer.79.mha.do1@0,transformer.79.mha.attn@0,M,"bsn,bsmh->mhn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.79.mha.wo@0,
transformer.79.mha.dv@0,N,transformer.79.mha.attn_kernel.dv@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.79.mha.v@0,
transformer.79.mha.dk@0,N,transformer.79.mha.attn_kernel.dk@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.79.mha.k@0,
transformer.79.mha.dq@0,N,transformer.79.mha.attn_kernel.dq@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.79.mha.q@0,
transformer.79.mha.dkv@0,N,transformer.79.mha.dv@0,transformer.79.mha.dk@0,SLICE,3:2*Head/tp,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,,
transformer.79.mha.dqkv@0,N,transformer.79.mha.dkv@0,transformer.79.mha.dq@0,SLICE,3:(2*Head+Head)/tp,"Batch/dp,Seq/cp,Dmodel/Head,2*Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1.00000000000000,transformer.79.mha.qkv@0,
transformer.79.mha.dwqkv@0,N,transformer.79.mha.dqkv@0,transformer.79.mha.x@0,M,"bsnh,bsm->mnh","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.79.mha.wqkv@0,
transformer.79.mha.dx1@0,N,transformer.79.mha.dqkv@0,transformer.79._mha.wqkv_backward@0,M,"bsnh,mnh->bsm","Batch/dp,Seq/cp,Dmodel/Head,3*Head/tp",1,"Dmodel,Dmodel/Head,3*Head/tp",1.00000000000000,,
transformer.79.mha.dx@0,N,transformer.79.mha.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.79.mha.attn_kernel.q@0,N,transformer.79.mha.q@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.79.mha.attn_kernel.k@0,N,transformer.79.mha.k@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.79.mha.attn_kernel.v@0,N,transformer.79.mha.v@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,,
transformer.79.mha.attn_kernel.k1@0,N,transformer.79.mha.attn_kernel.k@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.79.mha.attn_kernel.v1@0,N,transformer.79.mha.attn_kernel.v@0,,I,,"Batch/dp,Seq,Dmodel/Head,Head/tp",1,,,,
transformer.79.mha.attn_kernel.qkv@0,N,transformer.79.mha.attn_kernel.q@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*3,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,"{""data_deps"": [""transformer.79.mha.attn_kernel.k1@0"", ""transformer.79.mha.attn_kernel.v1@0""]}"
transformer.79.mha.attn_kernel.dqkv@0,N,transformer.79.mha.dattn@0,,I,,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,,,transformer.79.mha.attn_kernel.qkv@0,
transformer.79.mha.attn_kernel.dq@0,N,transformer.79.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,transformer.79.mha.attn_kernel.q@0,
transformer.79.mha.attn_kernel.dk@0,N,transformer.79.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.79.mha.attn_kernel.dv@0,N,transformer.79.mha.attn_kernel.dqkv@0,,CUSTOM,Batch/dp*Seq/cp*Dmodel/Head*Head/tp*6,"Batch/dp,Seq/cp,Dmodel/Head,Head/tp",1,"Batch/dp,Seq,Dmodel/Head,Head/tp",1/cp,,
transformer.79.mha_res.x1@0,N,transformer.79.mha.o@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.79.mha_res.x2@0,N,transformer.79.input_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.79.mha_res.y@0,N,transformer.79.mha_res.x1@0,transformer.79.mha_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.79.mha_res.dy@0,N,transformer.79.post_attn_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.79.mha_res.y@0,
transformer.79.mha_res.dx1@0,N,transformer.79.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.79.mha_res.x1@0,
transformer.79.mha_res.dx2@0,N,transformer.79.mha_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.79.mha_res.x2@0,
transformer.79.post_attn_norm.x@0,N,transformer.79.mha_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.79.post_attn_norm.y@0,N,transformer.79.post_attn_norm.x@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.79.post_attn_norm.dy@0,N,transformer.79.ffn.dx0@0,transformer.79.ffn_res.dx2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1,transformer.79.post_attn_norm.y@0,
transformer.79.post_attn_norm.dx@0,N,transformer.79.post_attn_norm.dy@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.79.post_attn_norm.x@0,
transformer.79.ffn.x0@0,N,transformer.79.post_attn_norm.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.79.ffn.wgate@0,N,transformer.79._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.79.ffn.wdown@0,N,transformer.79._assembled_weight@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.79.ffn.x00@0,N,transformer.79.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.79.ffn.xgate@0,N,transformer.79.ffn.x00@0,transformer.79.ffn.wgate@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dmodel",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.79.ffn.xdown1@0,N,transformer.79.ffn.xgate@0,transformer.79.ffn.wdown@0,M,"bsm,mn->bsn","Batch/dp,Seq/cp,Dff/tp",1,"Dff/tp,Dmodel",1.00000000000000,,
transformer.79.ffn.xdown@0,N,transformer.79.ffn.xdown1@0,,I,,"Batch/dp,Seq/(cp*tp),Dff",1,,,,
transformer.79.ffn.dxdown@0,N,transformer.79.ffn_res.dx1@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.79.ffn.xdown@0,
transformer.79.ffn.dxdown2@0,N,transformer.79.ffn.dxdown@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.79.ffn.dwdown@0,N,transformer.79.ffn.dxdown2@0,transformer.79.ffn.xgate@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dmodel",1,"Batch/dp,Seq/cp,Dff/tp",1.00000000000000,transformer.79.ffn.wdown@0,
transformer.79.ffn.dxgate@0,N,transformer.79.ffn.dxdown2@0,transformer.79._ffn.wdown_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dmodel",1,"Dff/tp,Dmodel",1.00000000000000,transformer.79.ffn.xgate@0,
transformer.79.ffn.x01@0,N,transformer.79.ffn.x0@0,,I,,"Batch/dp,Seq/cp,Dmodel",1,,,,
transformer.79.ffn.dwgate@0,N,transformer.79.ffn.dxgate@0,transformer.79.ffn.x01@0,M,"bsn,bsm->mn","Batch/dp,Seq/cp,Dff/tp",1,"Batch/dp,Seq/cp,Dmodel",1.00000000000000,transformer.79.ffn.wgate@0,
transformer.79.ffn.dx000@0,N,transformer.79.ffn.dxgate@0,transformer.79._ffn.wgate_backward@0,M,"bsn,mn->bsm","Batch/dp,Seq/cp,Dff/tp",1,"Dmodel,Dff/tp",1.00000000000000,,
transformer.79.ffn.dx0@0,N,transformer.79.ffn.dx000@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.79.ffn_res.x1@0,N,transformer.79.ffn.xdown@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.79.ffn_res.x2@0,N,transformer.79.post_attn_norm.x@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
transformer.79.ffn_res.y@0,N,transformer.79.ffn_res.x1@0,transformer.79.ffn_res.x2@0,A,,"Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,,
transformer.79.ffn_res.dy@0,N,out_emb.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.79.ffn_res.y@0,
transformer.79.ffn_res.dx1@0,N,transformer.79.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.79.ffn_res.x1@0,
transformer.79.ffn_res.dx2@0,N,transformer.79.ffn_res.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,transformer.79.ffn_res.x2@0,
transformer.79._sharded_weight@0,Y,,,T,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,,
transformer.79._assembled_weight@0,N,transformer.79._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
transformer.79._sharded_grad@0,N,transformer.79._assembled_grad@0,,I,,(2*Dff*Dmodel/tp + 4*Dmodel**2/tp)/fsdp,1,,,transformer.79._sharded_weight@0,
transformer.79._assembled_grad@0,N,transformer.79.mha.dwqkv@0,,CUSTOM,0,"Dmodel,Dmodel/Head,3*Head/tp","Batch/dp,Seq/cp",2*Dff*Dmodel/tp + 4*Dmodel**2/tp,"Batch/dp,Seq/cp",,"{""data_deps"": [""transformer.79.mha.dwo@0"", ""transformer.79.ffn.dwgate@0"", ""transformer.79.ffn.dwdown@0""]}"
transformer.79._mha.wqkv_backward@0,N,transformer.79._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dmodel/Head,3*Head/tp",1,,
transformer.79._mha.wo_backward@0,N,transformer.79._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel/Head,Head/tp,Dmodel",1,,
transformer.79._ffn.wgate_backward@0,N,transformer.79._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dmodel,Dff/tp",1,,
transformer.79._ffn.wdown_backward@0,N,transformer.79._assembled_weight_backward@0,,CUSTOM,0,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,"Dff/tp,Dmodel",1,,
transformer.79._assembled_weight_backward@0,N,transformer.79._sharded_weight@0,,I,,2*Dff*Dmodel/tp + 4*Dmodel**2/tp,1,,,,
in_emb.x@0,N,,,T,,"Batch/dp,Seq/(cp*tp),Dvocal",1,,,,
in_emb.w@0,Y,,,T,,"Dvocal,Dmodel",1,,,,
in_emb.y@0,N,in_emb.x@0,in_emb.w@0,M,"bsm,mn->bsn","Batch/dp,Seq/(cp*tp),Dvocal",1,"Dvocal,Dmodel",1.00000000000000,,
in_emb.dy@0,N,transformer.0.input_norm.dx@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,in_emb.y@0,
in_emb.dw@0,N,in_emb.dy@0,in_emb.x@0,M,"bsn,bsm->mn","Batch/dp,Seq/(cp*tp),Dmodel",1,"Batch/dp,Seq/(cp*tp),Dvocal",1.00000000000000,in_emb.w@0,
in_emb.dx@0,N,in_emb.dy@0,in_emb.w@0,M,"bsn,mn->bsm","Batch/dp,Seq/(cp*tp),Dmodel",1,"Dvocal,Dmodel",1.00000000000000,in_emb.x@0,
out_emb.x@0,N,transformer.79.ffn_res.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
out_emb.w@0,Y,,,T,,"Dmodel,Dvocal",1,,,,
out_emb.y@0,N,out_emb.x@0,out_emb.w@0,M,"bsm,mn->bsn","Batch/dp,Seq/(cp*tp),Dmodel",1,"Dmodel,Dvocal",1.00000000000000,,
out_emb.dy@0,N,loss.dy@0,,I,,"Batch/dp,Seq/(cp*tp),Dvocal",1,,,out_emb.y@0,
out_emb.dw@0,N,out_emb.dy@0,out_emb.x@0,M,"bsn,bsm->mn","Batch/dp,Seq/(cp*tp),Dvocal",1,"Batch/dp,Seq/(cp*tp),Dmodel",1.00000000000000,out_emb.w@0,
out_emb.dx@0,N,out_emb.dy@0,out_emb.w@0,M,"bsn,mn->bsm","Batch/dp,Seq/(cp*tp),Dvocal",1,"Dmodel,Dvocal",1.00000000000000,out_emb.x@0,
loss.y@0,N,out_emb.y@0,,I,,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
loss.loss@0,N,loss.y@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
loss.dy@0,N,loss.loss@0,,E,5.0,"Batch/dp,Seq/(cp*tp),Dmodel",1,,,,
